
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/SoftwareAutomation/Chapter-20-ML-and-automation-basics/20-03-Common-ML-applications/">
      
      
        <link rel="prev" href="../20-02-ML-training-models/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>20.3 Common ML applications - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#203-common-ml-applications" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> – content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              20.3 Common ML applications
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SecureSoftwareArchitecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Software Automation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 20 — ML and automation basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Chapter 20 — ML and automation basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../20-01-What-is-AI-vs-ML/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    20.1 What is AI vs ML (and where RPA/BPA fit)
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../20-02-ML-training-models/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    20.2 ML training models: supervised, unsupervised, semi, reinforcement
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3_2_3" id="__nav_3_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    20.3 Common ML applications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            20.3 Common ML applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-understanding-ml-applications-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Understanding ML Applications Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-data-analysis-applications" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Analysis Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Data Analysis Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-powered-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Powered Data Analysis?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Data Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-customer-behavior-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Customer Behavior Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-forecasting-applications" class="md-nav__link">
    <span class="md-ellipsis">
      2. Forecasting Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Forecasting Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-based-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Based Forecasting?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Forecasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-sales-forecasting-system" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Sales Forecasting System
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-image-recognition-applications" class="md-nav__link">
    <span class="md-ellipsis">
      4. Image Recognition Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Image Recognition Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-powered-image-recognition" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Powered Image Recognition?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-image-recognition" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Image Recognition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-document-scanner-with-ocr" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Document Scanner with OCR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pythons-competitive-advantages-in-ml-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Python&rsquo;s Competitive Advantages in ML Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python’s Competitive Advantages in ML Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-python-dominates-ml-development" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Dominates ML Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-python-excels-vs-other-languages" class="md-nav__link">
    <span class="md-ellipsis">
      When Python Excels vs. Other Languages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practice Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-1-customer-analysis-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Customer Analysis Enhancement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-2-forecasting-model-improvement" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Forecasting Model Improvement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-3-assistant-conversation-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Assistant Conversation Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-4-ocr-system-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: OCR System Extension
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../20-04-Design-models-decision-trees-and-neural-networks/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    20.4 Design models: decision trees and neural networks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../20-05-RPA-and-BPA-practical-considerations/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    20.5 RPA and BPA: practical considerations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-21-Programming-for-automation/21-01-Regression-models-and-core-algorithm-types-in-Python/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 21 — Programming for automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-22-Significance-and-impact/22-01-Assessing-the-impact-of-automation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 22 — Significance and impact
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-understanding-ml-applications-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Understanding ML Applications Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-data-analysis-applications" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Analysis Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Data Analysis Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-powered-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Powered Data Analysis?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Data Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-customer-behavior-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Customer Behavior Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-forecasting-applications" class="md-nav__link">
    <span class="md-ellipsis">
      2. Forecasting Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Forecasting Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-based-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Based Forecasting?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Forecasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-sales-forecasting-system" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Sales Forecasting System
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-image-recognition-applications" class="md-nav__link">
    <span class="md-ellipsis">
      4. Image Recognition Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Image Recognition Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-ml-powered-image-recognition" class="md-nav__link">
    <span class="md-ellipsis">
      What is ML-Powered Image Recognition?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-python-excels-at-image-recognition" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Excels at Image Recognition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-example-document-scanner-with-ocr" class="md-nav__link">
    <span class="md-ellipsis">
      Python Example: Document Scanner with OCR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pythons-competitive-advantages-in-ml-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Python&rsquo;s Competitive Advantages in ML Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python’s Competitive Advantages in ML Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-python-dominates-ml-development" class="md-nav__link">
    <span class="md-ellipsis">
      Why Python Dominates ML Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-python-excels-vs-other-languages" class="md-nav__link">
    <span class="md-ellipsis">
      When Python Excels vs. Other Languages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practice Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-1-customer-analysis-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Customer Analysis Enhancement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-2-forecasting-model-improvement" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Forecasting Model Improvement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-3-assistant-conversation-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Assistant Conversation Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-4-ocr-system-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: OCR System Extension
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/SoftwareAutomation/Chapter-20-ML-and-automation-basics/20-03-Common-ML-applications/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/SoftwareAutomation/Chapter-20-ML-and-automation-basics/20-03-Common-ML-applications/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="203-common-ml-applications">20.3 Common ML applications<a class="headerlink" href="#203-common-ml-applications" title="Permanent link">&para;</a></h1>
<h2 id="why-understanding-ml-applications-matters">Why Understanding ML Applications Matters<a class="headerlink" href="#why-understanding-ml-applications-matters" title="Permanent link">&para;</a></h2>
<p>Machine Learning has transformed numerous industries and continues to create new possibilities for automation and intelligent systems. Understanding common ML applications helps you:</p>
<ul>
<li>
<p><strong>Recognize Opportunities</strong>: Identify where ML can solve real-world problems</p>
</li>
<li>
<p><strong>Choose Appropriate Tools</strong>: Match applications to suitable ML approaches</p>
</li>
<li>
<p><strong>Leverage Python&rsquo;s Strengths</strong>: Understand why Python dominates ML development</p>
</li>
<li>
<p><strong>Design Better Systems</strong>: Apply proven patterns from successful ML applications</p>
</li>
</ul>
<p>This section explores four key application areas where ML excels: data analysis, forecasting, intelligent assistants, and image recognition. Each area demonstrates Python&rsquo;s particular strengths and provides practical implementation examples.</p>
<hr />
<h2 id="1-data-analysis-applications">1. Data Analysis Applications<a class="headerlink" href="#1-data-analysis-applications" title="Permanent link">&para;</a></h2>
<h3 id="what-is-ml-powered-data-analysis">What is ML-Powered Data Analysis?<a class="headerlink" href="#what-is-ml-powered-data-analysis" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong>: Using machine learning algorithms to automatically discover patterns, relationships, and insights in large datasets that would be difficult or impossible for humans to identify manually.</p>
<p><strong>Key Capabilities</strong>:</p>
<ul>
<li>
<p><strong>Pattern Recognition</strong>: Finding hidden relationships in complex data</p>
</li>
<li>
<p><strong>Anomaly Detection</strong>: Identifying unusual or suspicious data points</p>
</li>
<li>
<p><strong>Classification</strong>: Automatically categorizing data into meaningful groups</p>
</li>
<li>
<p><strong>Feature Discovery</strong>: Determining which data attributes are most important</p>
</li>
</ul>
<h3 id="why-python-excels-at-data-analysis">Why Python Excels at Data Analysis<a class="headerlink" href="#why-python-excels-at-data-analysis" title="Permanent link">&para;</a></h3>
<p>Python&rsquo;s ecosystem makes it ideal for data analysis ML applications:</p>
<ul>
<li>
<p><strong>Pandas</strong>: Powerful data manipulation and analysis library</p>
</li>
<li>
<p><strong>NumPy</strong>: Fast numerical computing with arrays</p>
</li>
<li>
<p><strong>Matplotlib/Seaborn</strong>: Rich visualization capabilities</p>
</li>
<li>
<p><strong>Scikit-learn</strong>: Comprehensive ML algorithms library</p>
</li>
<li>
<p><strong>Jupyter Notebooks</strong>: Interactive development and visualization</p>
</li>
</ul>
<h3 id="python-example-customer-behavior-analysis">Python Example: Customer Behavior Analysis<a class="headerlink" href="#python-example-customer-behavior-analysis" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statistics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomerTransaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a single customer transaction.&quot;&quot;&quot;</span>
    <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">transaction_date</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">channel</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &#39;online&#39;, &#39;store&#39;, &#39;mobile&#39;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomerInsight</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insights discovered about a customer.&quot;&quot;&quot;</span>
    <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_spending</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">avg_transaction</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">favorite_category</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">preferred_channel</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">risk_score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">customer_segment</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomerAnalysisML</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ML-powered customer behavior analysis system.</span>
<span class="sd">    Demonstrates how Python excels at data analysis applications.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spending_patterns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_threshold</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Standard deviations for anomaly detection</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_sample_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_customers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">transactions_per_customer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate realistic customer transaction data for analysis.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating </span><span class="si">{</span><span class="n">num_customers</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">transactions_per_customer</span><span class="si">}</span><span class="s2"> sample transactions...&quot;</span><span class="p">)</span>

        <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;groceries&#39;</span><span class="p">,</span> <span class="s1">&#39;electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;clothing&#39;</span><span class="p">,</span> <span class="s1">&#39;restaurants&#39;</span><span class="p">,</span> <span class="s1">&#39;entertainment&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">,</span> <span class="s1">&#39;healthcare&#39;</span><span class="p">]</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;online&#39;</span><span class="p">,</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;mobile&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">customer_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_customers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Create customer profile (affects spending patterns)</span>
            <span class="n">customer_type</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;budget_conscious&#39;</span><span class="p">,</span> <span class="s1">&#39;average_spender&#39;</span><span class="p">,</span> <span class="s1">&#39;high_value&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">customer_type</span> <span class="o">==</span> <span class="s1">&#39;budget_conscious&#39;</span><span class="p">:</span>
                <span class="n">base_amount_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
                <span class="n">preferred_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;groceries&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">customer_type</span> <span class="o">==</span> <span class="s1">&#39;average_spender&#39;</span><span class="p">:</span>
                <span class="n">base_amount_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">preferred_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;groceries&#39;</span><span class="p">,</span> <span class="s1">&#39;restaurants&#39;</span><span class="p">,</span> <span class="s1">&#39;clothing&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># high_value</span>
                <span class="n">base_amount_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
                <span class="n">preferred_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;restaurants&#39;</span><span class="p">,</span> <span class="s1">&#39;entertainment&#39;</span><span class="p">]</span>

            <span class="c1"># Generate transactions for this customer</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">transactions_per_customer</span><span class="p">):</span>
                <span class="c1"># Random date within last year</span>
                <span class="n">days_ago</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">365</span><span class="p">)</span>
                <span class="n">transaction_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days_ago</span><span class="p">)</span>

                <span class="c1"># Amount based on customer type with some randomness</span>
                <span class="n">base_min</span><span class="p">,</span> <span class="n">base_max</span> <span class="o">=</span> <span class="n">base_amount_range</span>
                <span class="n">amount</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">base_min</span><span class="p">,</span> <span class="n">base_max</span><span class="p">)</span>

                <span class="c1"># Occasionally add anomalous transactions</span>
                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>  <span class="c1"># 5% chance of anomaly</span>
                    <span class="n">amount</span> <span class="o">*=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># Unusually large transaction</span>

                <span class="c1"># Category preference but with variety</span>
                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">:</span>  <span class="c1"># 70% chance of preferred category</span>
                    <span class="n">category</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">preferred_categories</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">category</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>

                <span class="c1"># Channel preferences</span>
                <span class="n">channel_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;online&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;store&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;mobile&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">channel_weights</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> 
                                       <span class="n">weights</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">channel_weights</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">transaction</span> <span class="o">=</span> <span class="n">CustomerTransaction</span><span class="p">(</span>
                    <span class="n">customer_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CUST_</span><span class="si">{</span><span class="n">customer_id</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">transaction_date</span><span class="o">=</span><span class="n">transaction_date</span><span class="p">,</span>
                    <span class="n">amount</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
                    <span class="n">channel</span><span class="o">=</span><span class="n">channel</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transaction_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transaction_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> transactions for analysis&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_customer_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze customer behavior patterns using ML techniques.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analyzing customer behavior patterns...&quot;</span><span class="p">)</span>

        <span class="c1"># Group transactions by customer</span>
        <span class="n">customer_transactions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transaction_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">customer_transactions</span><span class="p">:</span>
                <span class="n">customer_transactions</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">customer_transactions</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>

        <span class="c1"># Analyze each customer</span>
        <span class="k">for</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">transactions</span> <span class="ow">in</span> <span class="n">customer_transactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">insight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_single_customer</span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="p">[</span><span class="n">customer_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">insight</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="p">)</span><span class="si">}</span><span class="s2"> customers&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_single_customer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CustomerTransaction</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CustomerInsight</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze behavior patterns for a single customer.&quot;&quot;&quot;</span>
        <span class="c1"># Basic statistics</span>
        <span class="n">amounts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">amount</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">]</span>
        <span class="n">total_spending</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span>
        <span class="n">avg_transaction</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span>

        <span class="c1"># Find favorite category</span>
        <span class="n">category_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
            <span class="n">category_counts</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">favorite_category</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">category_counts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">category_counts</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

        <span class="c1"># Find preferred channel</span>
        <span class="n">channel_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
            <span class="n">channel_counts</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">channel</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">preferred_channel</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">channel_counts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">channel_counts</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

        <span class="c1"># Calculate risk score (based on spending volatility)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_dev</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span>
            <span class="n">risk_score</span> <span class="o">=</span> <span class="n">std_dev</span> <span class="o">/</span> <span class="n">avg_transaction</span>  <span class="c1"># Coefficient of variation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">risk_score</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Determine customer segment</span>
        <span class="k">if</span> <span class="n">avg_transaction</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="s1">&#39;budget_conscious&#39;</span>
        <span class="k">elif</span> <span class="n">avg_transaction</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="s1">&#39;high_value&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="s1">&#39;average_spender&#39;</span>

        <span class="k">return</span> <span class="n">CustomerInsight</span><span class="p">(</span>
            <span class="n">customer_id</span><span class="o">=</span><span class="n">customer_id</span><span class="p">,</span>
            <span class="n">total_spending</span><span class="o">=</span><span class="n">total_spending</span><span class="p">,</span>
            <span class="n">avg_transaction</span><span class="o">=</span><span class="n">avg_transaction</span><span class="p">,</span>
            <span class="n">favorite_category</span><span class="o">=</span><span class="n">favorite_category</span><span class="p">,</span>
            <span class="n">preferred_channel</span><span class="o">=</span><span class="n">preferred_channel</span><span class="p">,</span>
            <span class="n">risk_score</span><span class="o">=</span><span class="n">risk_score</span><span class="p">,</span>
            <span class="n">customer_segment</span><span class="o">=</span><span class="n">segment</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_anomalous_transactions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">CustomerTransaction</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect anomalous transactions using statistical methods.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detecting anomalous transactions...&quot;</span><span class="p">)</span>

        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Group by customer for anomaly detection</span>
        <span class="n">customer_transactions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transaction_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">customer_transactions</span><span class="p">:</span>
                <span class="n">customer_transactions</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">customer_transactions</span><span class="p">[</span><span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">transactions</span> <span class="ow">in</span> <span class="n">customer_transactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># Need enough data for statistics</span>
                <span class="k">continue</span>

            <span class="n">amounts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">amount</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">]</span>
            <span class="n">mean_amount</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span>
            <span class="n">std_amount</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">amounts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">std_amount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># All transactions same amount</span>
                <span class="k">continue</span>

            <span class="c1"># Check each transaction for anomalies</span>
            <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
                <span class="n">z_score</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">amount</span> <span class="o">-</span> <span class="n">mean_amount</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_amount</span>

                <span class="k">if</span> <span class="n">z_score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_threshold</span><span class="p">:</span>
                    <span class="n">reason</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Amount $</span><span class="si">{</span><span class="n">transaction</span><span class="o">.</span><span class="n">amount</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">z_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> std devs from customer average $</span><span class="si">{</span><span class="n">mean_amount</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">anomalies</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">transaction</span><span class="p">,</span> <span class="n">reason</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span><span class="si">}</span><span class="s2"> anomalous transactions&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">anomalies</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_insights_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate comprehensive insights report from analysis.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must run analyze_customer_patterns() first&quot;</span><span class="p">)</span>

        <span class="c1"># Overall statistics</span>
        <span class="n">all_insights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">total_customers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_insights</span><span class="p">)</span>
        <span class="n">total_revenue</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">insight</span><span class="o">.</span><span class="n">total_spending</span> <span class="k">for</span> <span class="n">insight</span> <span class="ow">in</span> <span class="n">all_insights</span><span class="p">)</span>
        <span class="n">avg_customer_value</span> <span class="o">=</span> <span class="n">total_revenue</span> <span class="o">/</span> <span class="n">total_customers</span>

        <span class="c1"># Segment analysis</span>
        <span class="n">segment_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">segment_revenue</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">insight</span> <span class="ow">in</span> <span class="n">all_insights</span><span class="p">:</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="n">insight</span><span class="o">.</span><span class="n">customer_segment</span>
            <span class="n">segment_counts</span><span class="p">[</span><span class="n">segment</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">segment_revenue</span><span class="p">[</span><span class="n">segment</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment_revenue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">insight</span><span class="o">.</span><span class="n">total_spending</span>

        <span class="c1"># Channel analysis</span>
        <span class="n">channel_preferences</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">insight</span> <span class="ow">in</span> <span class="n">all_insights</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">insight</span><span class="o">.</span><span class="n">preferred_channel</span>
            <span class="n">channel_preferences</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># Category analysis</span>
        <span class="n">category_preferences</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">insight</span> <span class="ow">in</span> <span class="n">all_insights</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="n">insight</span><span class="o">.</span><span class="n">favorite_category</span>
            <span class="n">category_preferences</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># Risk analysis</span>
        <span class="n">risk_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">insight</span><span class="o">.</span><span class="n">risk_score</span> <span class="k">for</span> <span class="n">insight</span> <span class="ow">in</span> <span class="n">all_insights</span><span class="p">]</span>
        <span class="n">avg_risk</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">risk_scores</span><span class="p">)</span>
        <span class="n">high_risk_customers</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">risk_scores</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;total_customers&#39;</span><span class="p">:</span> <span class="n">total_customers</span><span class="p">,</span>
            <span class="s1">&#39;total_revenue&#39;</span><span class="p">:</span> <span class="n">total_revenue</span><span class="p">,</span>
            <span class="s1">&#39;avg_customer_value&#39;</span><span class="p">:</span> <span class="n">avg_customer_value</span><span class="p">,</span>
            <span class="s1">&#39;segment_distribution&#39;</span><span class="p">:</span> <span class="n">segment_counts</span><span class="p">,</span>
            <span class="s1">&#39;segment_revenue&#39;</span><span class="p">:</span> <span class="n">segment_revenue</span><span class="p">,</span>
            <span class="s1">&#39;channel_preferences&#39;</span><span class="p">:</span> <span class="n">channel_preferences</span><span class="p">,</span>
            <span class="s1">&#39;category_preferences&#39;</span><span class="p">:</span> <span class="n">category_preferences</span><span class="p">,</span>
            <span class="s1">&#39;avg_risk_score&#39;</span><span class="p">:</span> <span class="n">avg_risk</span><span class="p">,</span>
            <span class="s1">&#39;high_risk_customers&#39;</span><span class="p">:</span> <span class="n">high_risk_customers</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_valuable_customers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">CustomerInsight</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the most valuable customers based on total spending.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must run analyze_customer_patterns() first&quot;</span><span class="p">)</span>

        <span class="n">sorted_customers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customer_insights</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">total_spending</span><span class="p">,</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">sorted_customers</span><span class="p">[:</span><span class="n">top_n</span><span class="p">]</span>

<span class="c1"># Demonstration</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_data_analysis_ml</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate ML-powered data analysis with customer behavior.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ML Data Analysis Application Demonstration&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

    <span class="c1"># Create analysis system</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">CustomerAnalysisML</span><span class="p">()</span>

    <span class="c1"># Generate and analyze data</span>
    <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_sample_data</span><span class="p">(</span><span class="n">num_customers</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">transactions_per_customer</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_customer_patterns</span><span class="p">()</span>

    <span class="c1"># Generate insights report</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_insights_report</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Customer Analysis Results:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Customers: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_customers&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Revenue: $</span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_revenue&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Customer Value: $</span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;avg_customer_value&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Customer Segments:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">segment</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;segment_distribution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_customers&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">revenue</span> <span class="o">=</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;segment_revenue&#39;</span><span class="p">][</span><span class="n">segment</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">segment</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> customers (</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%) - $</span><span class="si">{</span><span class="n">revenue</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2"> revenue&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Channel Preferences:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">channel</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;channel_preferences&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_customers&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> customers (</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top Categories:&quot;</span><span class="p">)</span>
    <span class="n">sorted_categories</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;category_preferences&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_categories</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_customers&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> customers (</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="c1"># Find anomalies</span>
    <span class="n">anomalies</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">detect_anomalous_transactions</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anomalous Transactions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span><span class="si">}</span><span class="s2"> detected&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">anomalies</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>  <span class="c1"># Show first 3</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">transaction</span><span class="o">.</span><span class="n">customer_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Top customers</span>
    <span class="n">valuable_customers</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">find_valuable_customers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top 5 Valuable Customers:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">customer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valuable_customers</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">customer</span><span class="o">.</span><span class="n">customer_id</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">customer</span><span class="o">.</span><span class="n">total_spending</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">customer</span><span class="o">.</span><span class="n">customer_segment</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">analyzer</span><span class="p">,</span> <span class="n">report</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_analyzer</span><span class="p">,</span> <span class="n">analysis_report</span> <span class="o">=</span> <span class="n">demonstrate_data_analysis_ml</span><span class="p">()</span>
</code></pre>
</div>
<hr />
<h2 id="2-forecasting-applications">2. Forecasting Applications<a class="headerlink" href="#2-forecasting-applications" title="Permanent link">&para;</a></h2>
<h3 id="what-is-ml-based-forecasting">What is ML-Based Forecasting?<a class="headerlink" href="#what-is-ml-based-forecasting" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong>: Using machine learning algorithms to predict future values based on historical patterns, trends, and external factors.</p>
<p><strong>Key Capabilities</strong>:</p>
<ul>
<li>
<p><strong>Time Series Prediction</strong>: Forecasting sequential data points over time</p>
</li>
<li>
<p><strong>Trend Analysis</strong>: Identifying long-term patterns and seasonal variations</p>
</li>
<li>
<p><strong>Multi-variate Forecasting</strong>: Considering multiple factors simultaneously</p>
</li>
<li>
<p><strong>Uncertainty Quantification</strong>: Providing confidence intervals for predictions</p>
</li>
</ul>
<h3 id="why-python-excels-at-forecasting">Why Python Excels at Forecasting<a class="headerlink" href="#why-python-excels-at-forecasting" title="Permanent link">&para;</a></h3>
<p>Python&rsquo;s forecasting advantages:</p>
<ul>
<li>
<p><strong>Scientific Computing</strong>: NumPy and SciPy for mathematical operations</p>
</li>
<li>
<p><strong>Time Series Libraries</strong>: Specialized tools like Prophet, statsmodels</p>
</li>
<li>
<p><strong>Visualization</strong>: Clear plotting of trends and predictions</p>
</li>
<li>
<p><strong>Data Preprocessing</strong>: Easy handling of date/time data and missing values</p>
</li>
<li>
<p><strong>Model Validation</strong>: Robust backtesting and cross-validation capabilities</p>
</li>
</ul>
<h3 id="python-example-sales-forecasting-system">Python Example: Sales Forecasting System<a class="headerlink" href="#python-example-sales-forecasting-system" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statistics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SalesData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents sales data for a specific date.&quot;&quot;&quot;</span>
    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">sales</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">day_of_week</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 0=Monday, 6=Sunday</span>
    <span class="n">month</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">is_holiday</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># External factor</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ForecastResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result of a sales forecast.&quot;&quot;&quot;</span>
    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">predicted_sales</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">confidence_lower</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">confidence_upper</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">actual_sales</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SalesForecastingML</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ML-powered sales forecasting system.</span>
<span class="sd">    Demonstrates Python&#39;s strengths in time series prediction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_historical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">365</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate realistic historical sales data with patterns.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating </span><span class="si">{</span><span class="n">days</span><span class="si">}</span><span class="s2"> days of historical sales data...&quot;</span><span class="p">)</span>

        <span class="n">base_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days</span><span class="p">):</span>
            <span class="n">current_date</span> <span class="o">=</span> <span class="n">base_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">day</span><span class="p">)</span>

            <span class="c1"># Base sales with seasonal patterns</span>
            <span class="n">base_sales</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Base daily sales</span>

            <span class="c1"># Seasonal variations</span>
            <span class="n">month_factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">current_date</span><span class="o">.</span><span class="n">month</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>

            <span class="c1"># Day of week patterns (weekends higher)</span>
            <span class="n">day_of_week</span> <span class="o">=</span> <span class="n">current_date</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">day_of_week</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># Weekend</span>
                <span class="n">day_factor</span> <span class="o">=</span> <span class="mf">1.4</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Weekday</span>
                <span class="n">day_factor</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="c1"># Holiday effect</span>
            <span class="n">is_holiday</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_holiday</span><span class="p">(</span><span class="n">current_date</span><span class="p">)</span>
            <span class="n">holiday_factor</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="k">if</span> <span class="n">is_holiday</span> <span class="k">else</span> <span class="mf">1.0</span>

            <span class="c1"># Weather effect (temperature)</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">current_date</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span><span class="o">.</span><span class="n">tm_yday</span> <span class="o">/</span> <span class="mi">365</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">temp_factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">temperature</span> <span class="o">-</span> <span class="mi">25</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>  <span class="c1"># Sales increase with warmer weather</span>

            <span class="c1"># Random noise</span>
            <span class="n">noise_factor</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

            <span class="c1"># Calculate final sales</span>
            <span class="n">sales</span> <span class="o">=</span> <span class="n">base_sales</span> <span class="o">*</span> <span class="n">month_factor</span> <span class="o">*</span> <span class="n">day_factor</span> <span class="o">*</span> <span class="n">holiday_factor</span> <span class="o">*</span> <span class="n">temp_factor</span> <span class="o">*</span> <span class="n">noise_factor</span>

            <span class="n">sales_data</span> <span class="o">=</span> <span class="n">SalesData</span><span class="p">(</span>
                <span class="n">date</span><span class="o">=</span><span class="n">current_date</span><span class="p">,</span>
                <span class="n">sales</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">sales</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">day_of_week</span><span class="o">=</span><span class="n">day_of_week</span><span class="p">,</span>
                <span class="n">month</span><span class="o">=</span><span class="n">current_date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                <span class="n">is_holiday</span><span class="o">=</span><span class="n">is_holiday</span><span class="p">,</span>
                <span class="n">temperature</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated sales data from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_holiday</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simple holiday detection (placeholder for real holiday calendar).&quot;&quot;&quot;</span>
        <span class="c1"># Simplified: assume some random days are holidays</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.05</span>  <span class="c1"># 5% chance of being a holiday</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze historical data to identify patterns.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analyzing sales patterns...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No historical data available&quot;</span><span class="p">)</span>

        <span class="c1"># Analyze day of week patterns</span>
        <span class="n">dow_sales</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">:</span>
            <span class="n">dow_sales</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">day_of_week</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">dow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dow_sales</span><span class="p">[</span><span class="n">dow</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">][</span><span class="n">dow</span><span class="p">]</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dow_sales</span><span class="p">[</span><span class="n">dow</span><span class="p">])</span>

        <span class="c1"># Analyze monthly patterns</span>
        <span class="n">monthly_sales</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>  <span class="c1"># Index 0 unused, 1-12 for months</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">:</span>
            <span class="n">monthly_sales</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">monthly_sales</span><span class="p">[</span><span class="n">month</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">][</span><span class="n">month</span><span class="p">]</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">monthly_sales</span><span class="p">[</span><span class="n">month</span><span class="p">])</span>

        <span class="c1"># Calculate overall baseline</span>
        <span class="n">all_sales</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_sales</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identified patterns for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">)</span><span class="si">}</span><span class="s2"> factors&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_forecasting_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train a simple forecasting model using historical patterns.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training forecasting model...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyze_patterns</span><span class="p">()</span>

        <span class="c1"># Simple linear trend analysis</span>
        <span class="n">sales_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sales_values</span><span class="p">)</span>

        <span class="c1"># Calculate trend (simple linear regression on time)</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">x_mean</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
        <span class="n">y_mean</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sales_values</span><span class="p">)</span>

        <span class="c1"># Calculate slope (trend)</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_mean</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_mean</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">sales_values</span><span class="p">))</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_values</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">denominator</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">trend_slope</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">trend_slope</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;trend_slope&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trend_slope</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span>

        <span class="c1"># Calculate model accuracy on historical data</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">actuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">):</span>
            <span class="n">predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_prediction</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">use_actual_factors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">historical_index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
            <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
            <span class="n">actuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span><span class="p">)</span>

        <span class="c1"># Calculate error metrics</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">)]</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>  <span class="c1"># Mean Absolute Error</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;historical_mae&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mae</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model trained with MAE: $</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_date</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">use_actual_factors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">historical_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make a sales prediction for a specific date.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be trained first&quot;</span><span class="p">)</span>

        <span class="c1"># Start with baseline</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span>

        <span class="c1"># Add trend component</span>
        <span class="k">if</span> <span class="n">historical_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">trend_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;trend_slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">historical_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For future predictions, use days since start of training data</span>
            <span class="n">days_since_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">target_date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
            <span class="n">trend_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;trend_slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">days_since_start</span>

        <span class="n">prediction</span> <span class="o">+=</span> <span class="n">trend_component</span>

        <span class="c1"># Apply seasonal adjustments</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span>

        <span class="c1"># Day of week adjustment</span>
        <span class="n">dow</span> <span class="o">=</span> <span class="n">target_date</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]:</span>
            <span class="n">dow_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">][</span><span class="n">dow</span><span class="p">]</span>
            <span class="n">dow_factor</span> <span class="o">=</span> <span class="n">dow_avg</span> <span class="o">/</span> <span class="n">baseline</span>
            <span class="n">prediction</span> <span class="o">*=</span> <span class="n">dow_factor</span>

        <span class="c1"># Monthly adjustment</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">target_date</span><span class="o">.</span><span class="n">month</span>
        <span class="k">if</span> <span class="n">month</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]:</span>
            <span class="n">month_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">][</span><span class="n">month</span><span class="p">]</span>
            <span class="n">month_factor</span> <span class="o">=</span> <span class="n">month_avg</span> <span class="o">/</span> <span class="n">baseline</span>
            <span class="n">prediction</span> <span class="o">*=</span> <span class="n">month_factor</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ensure non-negative sales</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forecast_future_sales</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days_ahead</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ForecastResult</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate sales forecasts for future dates.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be trained first&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating forecasts for next </span><span class="si">{</span><span class="n">days_ahead</span><span class="si">}</span><span class="s2"> days...&quot;</span><span class="p">)</span>

        <span class="n">forecasts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days_ahead</span><span class="p">):</span>
            <span class="n">forecast_date</span> <span class="o">=</span> <span class="n">start_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">day</span><span class="p">)</span>

            <span class="c1"># Make prediction</span>
            <span class="n">predicted_sales</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_prediction</span><span class="p">(</span><span class="n">forecast_date</span><span class="p">)</span>

            <span class="c1"># Estimate confidence interval based on historical error</span>
            <span class="n">mae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_weights</span><span class="p">[</span><span class="s1">&#39;historical_mae&#39;</span><span class="p">]</span>
            <span class="n">confidence_lower</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">predicted_sales</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">mae</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">confidence_upper</span> <span class="o">=</span> <span class="n">predicted_sales</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">mae</span>

            <span class="n">forecast</span> <span class="o">=</span> <span class="n">ForecastResult</span><span class="p">(</span>
                <span class="n">date</span><span class="o">=</span><span class="n">forecast_date</span><span class="p">,</span>
                <span class="n">predicted_sales</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">predicted_sales</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">confidence_lower</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">confidence_lower</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">confidence_upper</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">confidence_upper</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">forecasts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">forecasts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_forecast_accuracy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SalesData</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate forecast accuracy against actual data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be trained first&quot;</span><span class="p">)</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">actuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">:</span>
            <span class="n">predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_prediction</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
            <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
            <span class="n">actuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sales</span><span class="p">)</span>

        <span class="c1"># Calculate error metrics</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">)]</span>
        <span class="n">relative_errors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">mae</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">relative_errors</span><span class="p">)</span> <span class="k">if</span> <span class="n">relative_errors</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>  <span class="c1"># Mean Absolute Error</span>
            <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>  <span class="c1"># Mean Absolute Percentage Error</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
            <span class="s1">&#39;actuals&#39;</span><span class="p">:</span> <span class="n">actuals</span>
        <span class="p">}</span>

<span class="c1"># Demonstration</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_forecasting_ml</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate ML-powered sales forecasting.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ML Forecasting Application Demonstration&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>

    <span class="c1"># Create forecasting system</span>
    <span class="n">forecaster</span> <span class="o">=</span> <span class="n">SalesForecastingML</span><span class="p">()</span>

    <span class="c1"># Generate training data (1 year)</span>
    <span class="n">forecaster</span><span class="o">.</span><span class="n">generate_historical_data</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

    <span class="c1"># Train the model</span>
    <span class="n">forecaster</span><span class="o">.</span><span class="n">train_forecasting_model</span><span class="p">()</span>

    <span class="c1"># Generate future forecasts</span>
    <span class="n">future_forecasts</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">forecast_future_sales</span><span class="p">(</span><span class="n">days_ahead</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Next 14 Days Sales Forecast:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">forecast</span> <span class="ow">in</span> <span class="n">future_forecasts</span><span class="p">[:</span><span class="mi">7</span><span class="p">]:</span>  <span class="c1"># Show first week</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">forecast</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> (%A)&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">forecast</span><span class="o">.</span><span class="n">predicted_sales</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2"> &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;($</span><span class="si">{</span><span class="n">forecast</span><span class="o">.</span><span class="n">confidence_lower</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2"> - $</span><span class="si">{</span><span class="n">forecast</span><span class="o">.</span><span class="n">confidence_upper</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Show weekly summary</span>
    <span class="n">weekly_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">predicted_sales</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">future_forecasts</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Week 1 Total Forecast: $</span><span class="si">{</span><span class="n">weekly_total</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Generate test data to evaluate accuracy</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating test data for accuracy evaluation...&quot;</span><span class="p">)</span>
    <span class="n">test_forecaster</span> <span class="o">=</span> <span class="n">SalesForecastingML</span><span class="p">()</span>
    <span class="n">test_forecaster</span><span class="o">.</span><span class="n">generate_historical_data</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># 30 days of &quot;future&quot; data</span>

    <span class="c1"># Evaluate accuracy</span>
    <span class="n">evaluation</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">evaluate_forecast_accuracy</span><span class="p">(</span><span class="n">test_forecaster</span><span class="o">.</span><span class="n">historical_data</span><span class="p">[:</span><span class="mi">14</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Forecast Accuracy Metrics:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Absolute Error: $</span><span class="si">{</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Absolute Percentage Error: </span><span class="si">{</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="c1"># Show pattern insights</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Identified Patterns:&quot;</span><span class="p">)</span>
    <span class="n">dow_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="s1">&#39;Tue&#39;</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">,</span> <span class="s1">&#39;Thu&#39;</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">]</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Day of Week Effects:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dow</span><span class="p">,</span> <span class="n">avg_sales</span> <span class="ow">in</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">seasonal_patterns</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">avg_sales</span> <span class="o">/</span> <span class="n">baseline</span>
        <span class="n">effect</span> <span class="o">=</span> <span class="s2">&quot;higher&quot;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">&gt;</span> <span class="mf">1.05</span> <span class="k">else</span> <span class="s2">&quot;lower&quot;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">&lt;</span> <span class="mf">0.95</span> <span class="k">else</span> <span class="s2">&quot;average&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">dow_names</span><span class="p">[</span><span class="n">dow</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">factor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x baseline (</span><span class="si">{</span><span class="n">effect</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">forecaster</span><span class="p">,</span> <span class="n">future_forecasts</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_forecaster</span><span class="p">,</span> <span class="n">forecasts</span> <span class="o">=</span> <span class="n">demonstrate_forecasting_ml</span><span class="p">()</span>
</code></pre>
</div>
<p>if <strong>name</strong> == &ldquo;<strong>main</strong>&rdquo;:
    demo_forecaster, forecasts = demonstrate_forecasting_ml()</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>---
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>## 3. Intelligent Assistant Applications
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>### What are ML-Powered Intelligent Assistants?
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>**Definition**: AI systems that use machine learning to understand user queries, maintain context, and provide helpful responses or actions based on natural language interaction.
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>**Key Capabilities**:
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>- **Natural Language Understanding**: Parsing and interpreting human language
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>- **Context Management**: Maintaining conversation state and memory
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>- **Intent Recognition**: Determining what the user wants to accomplish
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>- **Response Generation**: Creating appropriate and helpful replies
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>- **Task Automation**: Executing actions based on user requests
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>### Why Python Excels at Building Assistants
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>Python&#39;s assistant development advantages:
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>- **Natural Language Processing**: Libraries like NLTK, spaCy, transformers
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>- **API Integration**: Easy connection to external services and data sources
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>- **Rapid Prototyping**: Quick iteration on conversation logic
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>- **Machine Learning Integration**: Seamless use of ML models for intent recognition
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>- **Web Frameworks**: Flask/FastAPI for building assistant APIs
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>### Python Example: Smart Study Assistant
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>```python-template
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>import random
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>import re
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>from typing import List, Dict, Tuple, Optional
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>from dataclasses import dataclass
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>from datetime import datetime, timedelta
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>import json
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>@dataclass
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>class StudySession:
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    &quot;&quot;&quot;Represents a study session.&quot;&quot;&quot;
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    subject: str
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    duration_minutes: int
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    date: datetime
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    difficulty: str  # &#39;easy&#39;, &#39;medium&#39;, &#39;hard&#39;
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>    notes: str
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>@dataclass
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>class AssistantResponse:
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    &quot;&quot;&quot;Response from the intelligent assistant.&quot;&quot;&quot;
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    text: str
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    action: Optional[str] = None
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>    data: Optional[Dict] = None
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>class SmartStudyAssistant:
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>    &quot;&quot;&quot;
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    ML-powered intelligent study assistant.
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    Demonstrates Python&#39;s strengths in building conversational AI.
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>    &quot;&quot;&quot;
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    def __init__(self):
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        self.study_history = []
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>        self.user_preferences = {}
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        self.conversation_context = {}
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        self.intent_patterns = self._initialize_intent_patterns()
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        self.subject_keywords = self._initialize_subject_keywords()
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>    def _initialize_intent_patterns(self) -&gt; Dict[str, List[str]]:
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>        &quot;&quot;&quot;Initialize patterns for intent recognition.&quot;&quot;&quot;
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>        return {
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>            &#39;study_plan&#39;: [
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>                r&#39;create.*study.*plan&#39;,
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>                r&#39;plan.*study&#39;,
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>                r&#39;schedule.*study&#39;,
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>                r&#39;organize.*study&#39;
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>            ],
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>            &#39;track_progress&#39;: [
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>                r&#39;how.*doing&#39;,
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>                r&#39;track.*progress&#39;,
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>                r&#39;show.*progress&#39;,
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>                r&#39;my.*stats&#39;
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>            ],
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>            &#39;study_tips&#39;: [
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>                r&#39;study.*tips&#39;,
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>                r&#39;how.*study.*better&#39;,
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>                r&#39;improve.*study&#39;,
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                r&#39;study.*advice&#39;
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>            ],
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>            &#39;break_reminder&#39;: [
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>                r&#39;break.*time&#39;,
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>                r&#39;should.*break&#39;,
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>                r&#39;tired&#39;,
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>                r&#39;rest&#39;
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>            ],
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>            &#39;record_session&#39;: [
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>                r&#39;just.*studied&#39;,
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>                r&#39;finished.*studying&#39;,
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>                r&#39;studied.*for&#39;,
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>                r&#39;completed.*session&#39;
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>            ],
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>            &#39;motivation&#39;: [
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>                r&#39;motivated&#39;,
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>                r&#39;encourage&#39;,
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>                r&#39;feeling.*down&#39;,
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>                r&#39;give.*up&#39;
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>            ]
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>        }
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>    def _initialize_subject_keywords(self) -&gt; Dict[str, List[str]]:
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>        &quot;&quot;&quot;Initialize subject recognition keywords.&quot;&quot;&quot;
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>        return {
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>            &#39;mathematics&#39;: [&#39;math&#39;, &#39;mathematics&#39;, &#39;algebra&#39;, &#39;calculus&#39;, &#39;geometry&#39;, &#39;statistics&#39;],
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>            &#39;science&#39;: [&#39;science&#39;, &#39;physics&#39;, &#39;chemistry&#39;, &#39;biology&#39;, &#39;laboratory&#39;],
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>            &#39;programming&#39;: [&#39;programming&#39;, &#39;coding&#39;, &#39;python&#39;, &#39;javascript&#39;, &#39;algorithms&#39;, &#39;software&#39;],
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>            &#39;history&#39;: [&#39;history&#39;, &#39;historical&#39;, &#39;ancient&#39;, &#39;modern&#39;, &#39;world war&#39;],
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>            &#39;english&#39;: [&#39;english&#39;, &#39;literature&#39;, &#39;writing&#39;, &#39;essay&#39;, &#39;grammar&#39;, &#39;reading&#39;],
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>            &#39;languages&#39;: [&#39;french&#39;, &#39;spanish&#39;, &#39;german&#39;, &#39;language&#39;, &#39;vocabulary&#39;]
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>        }
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>    def process_message(self, user_message: str) -&gt; AssistantResponse:
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>        &quot;&quot;&quot;Process user message and generate appropriate response.&quot;&quot;&quot;
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>        ## Normalize message
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>        message_lower = user_message.lower()
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>        ## Recognize intent
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>        intent = self._recognize_intent(message_lower)
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>        ## Extract entities (subjects, numbers, etc.)
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>        entities = self._extract_entities(message_lower)
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>        ## Generate response based on intent
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>        if intent == &#39;study_plan&#39;:
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>            return self._create_study_plan(entities)
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>        elif intent == &#39;track_progress&#39;:
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>            return self._show_progress()
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>        elif intent == &#39;study_tips&#39;:
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>            return self._provide_study_tips(entities.get(&#39;subject&#39;))
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>        elif intent == &#39;break_reminder&#39;:
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>            return self._suggest_break()
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>        elif intent == &#39;record_session&#39;:
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>            return self._record_study_session(entities)
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>        elif intent == &#39;motivation&#39;:
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>            return self._provide_motivation()
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>        else:
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>            return self._general_response(message_lower)
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>    def _recognize_intent(self, message: str) -&gt; str:
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>        &quot;&quot;&quot;Recognize user intent using pattern matching.&quot;&quot;&quot;
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>        for intent, patterns in self.intent_patterns.items():
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>            for pattern in patterns:
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>                if re.search(pattern, message):
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>                    return intent
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>        return &#39;general&#39;
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>    def _extract_entities(self, message: str) -&gt; Dict[str, any]:
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>        &quot;&quot;&quot;Extract entities like subjects, numbers, time from message.&quot;&quot;&quot;
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>        entities = {}
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>        ## Extract subject
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>        for subject, keywords in self.subject_keywords.items():
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>            for keyword in keywords:
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>                if keyword in message:
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>                    entities[&#39;subject&#39;] = subject
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>                    break
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>            if &#39;subject&#39; in entities:
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>                break
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>        ## Extract duration (simple pattern matching)
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>        duration_match = re.search(r&#39;(\d+)\s*(hour|minute|min)&#39;, message)
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>        if duration_match:
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>            number = int(duration_match.group(1))
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>            unit = duration_match.group(2)
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>            if unit.startswith(&#39;hour&#39;):
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>                entities[&#39;duration&#39;] = number * 60
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>            else:
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a>                entities[&#39;duration&#39;] = number
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>        ## Extract difficulty
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a>        if any(word in message for word in [&#39;easy&#39;, &#39;simple&#39;, &#39;basic&#39;]):
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>            entities[&#39;difficulty&#39;] = &#39;easy&#39;
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a>        elif any(word in message for word in [&#39;hard&#39;, &#39;difficult&#39;, &#39;challenging&#39;]):
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>            entities[&#39;difficulty&#39;] = &#39;hard&#39;
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>        else:
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>            entities[&#39;difficulty&#39;] = &#39;medium&#39;
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>        return entities
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>    def _create_study_plan(self, entities: Dict) -&gt; AssistantResponse:
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>        &quot;&quot;&quot;Create a personalized study plan.&quot;&quot;&quot;
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a>        subject = entities.get(&#39;subject&#39;, &#39;general studies&#39;)
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>        ## Analyze study history for this subject
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>        subject_sessions = [s for s in self.study_history if s.subject == subject]
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>        if subject_sessions:
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>            avg_duration = sum(s.duration_minutes for s in subject_sessions) / len(subject_sessions)
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>            recent_difficulty = subject_sessions[-1].difficulty if subject_sessions else &#39;medium&#39;
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>        else:
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>            avg_duration = 45  # Default
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>            recent_difficulty = &#39;medium&#39;
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>        ## Generate plan
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>        plan = {
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>            &#39;subject&#39;: subject,
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>            &#39;recommended_duration&#39;: int(avg_duration),
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>            &#39;difficulty_progression&#39;: recent_difficulty,
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>            &#39;break_intervals&#39;: &#39;Every 25 minutes (Pomodoro technique)&#39;,
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>            &#39;weekly_sessions&#39;: 3 if len(subject_sessions) &lt; 5 else 4
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>        }
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>        response_text = f&quot;&quot;&quot;📚 **Study Plan for {subject.title()}**
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>Based on your study history, here&#39;s a personalized plan:
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>• **Session Duration**: {plan[&#39;recommended_duration&#39;]} minutes
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>• **Difficulty Level**: Start with {plan[&#39;difficulty_progression&#39;]} topics
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>• **Break Schedule**: {plan[&#39;break_intervals&#39;]}
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>• **Weekly Goal**: {plan[&#39;weekly_sessions&#39;]} sessions
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>Would you like me to schedule specific times or adjust any of these recommendations?&quot;&quot;&quot;
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>        return AssistantResponse(
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>            text=response_text,
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>            action=&#39;study_plan_created&#39;,
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>            data=plan
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        )
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>    def _show_progress(self) -&gt; AssistantResponse:
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>        &quot;&quot;&quot;Show study progress and statistics.&quot;&quot;&quot;
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>        if not self.study_history:
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>            return AssistantResponse(
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>                text=&quot;I don&#39;t have any study sessions recorded yet. Start studying and I&#39;ll track your progress!&quot;
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>            )
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>        ## Calculate statistics
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>        total_sessions = len(self.study_history)
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>        total_time = sum(s.duration_minutes for s in self.study_history)
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>        ## Subject breakdown
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>        subject_stats = {}
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        for session in self.study_history:
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>            if session.subject not in subject_stats:
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>                subject_stats[session.subject] = {&#39;count&#39;: 0, &#39;time&#39;: 0}
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>            subject_stats[session.subject][&#39;count&#39;] += 1
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>            subject_stats[session.subject][&#39;time&#39;] += session.duration_minutes
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>        ## Recent streak
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>        recent_sessions = [s for s in self.study_history if 
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>                         (datetime.now() - s.date).days &lt;= 7]
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>        response_text = f&quot;&quot;&quot;📊 **Your Study Progress**
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>**Overall Stats:**
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>• Total Sessions: {total_sessions}
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>• Total Study Time: {total_time // 60}h {total_time % 60}m
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>• This Week: {len(recent_sessions)} sessions
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>**Subject Breakdown:**&quot;&quot;&quot;
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>        for subject, stats in sorted(subject_stats.items(), key=lambda x: x[1][&#39;time&#39;], reverse=True):
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>            hours = stats[&#39;time&#39;] // 60
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>            minutes = stats[&#39;time&#39;] % 60
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>            response_text += f&quot;\n• {subject.title()}: {stats[&#39;count&#39;]} sessions ({hours}h {minutes}m)&quot;
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a>        ## Add encouragement
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>        if len(recent_sessions) &gt;= 3:
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>            response_text += &quot;\n\n🎉 Great consistency this week! Keep it up!&quot;
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>        elif len(recent_sessions) &gt;= 1:
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>            response_text += &quot;\n\n👍 Good start this week. Try to add 1-2 more sessions!&quot;
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>        else:
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>            response_text += &quot;\n\n💪 Ready to start a new study streak this week?&quot;
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>        return AssistantResponse(
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>            text=response_text,
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>            action=&#39;progress_shown&#39;,
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>            data={&#39;total_time&#39;: total_time, &#39;subject_stats&#39;: subject_stats}
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>        )
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>    def _provide_study_tips(self, subject: Optional[str]) -&gt; AssistantResponse:
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>        &quot;&quot;&quot;Provide study tips, optionally subject-specific.&quot;&quot;&quot;
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>        general_tips = [
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>            &quot;Use the Pomodoro Technique: 25 minutes focused study, 5 minute break&quot;,
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>            &quot;Teach someone else - it&#39;s the best way to test your understanding&quot;,
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>            &quot;Create mind maps to visualize connections between concepts&quot;,
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>            &quot;Practice active recall instead of just re-reading notes&quot;,
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>            &quot;Study in a quiet, well-lit environment free from distractions&quot;
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>        ]
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>        subject_specific_tips = {
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>            &#39;mathematics&#39;: [
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>                &quot;Practice problems daily - math is learned by doing, not just reading&quot;,
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>                &quot;Work through examples step-by-step and understand each operation&quot;,
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>                &quot;Keep a formula sheet and review it regularly&quot;
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>            ],
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>            &#39;programming&#39;: [
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>                &quot;Code every day, even if it&#39;s just for 15 minutes&quot;,
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>                &quot;Debug by explaining your code line-by-line to yourself&quot;,
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>                &quot;Build small projects to apply what you learn&quot;
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>            ],
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>            &#39;science&#39;: [
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>                &quot;Connect theoretical concepts to real-world applications&quot;,
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>                &quot;Draw diagrams and use visual aids to understand processes&quot;,
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>                &quot;Perform hands-on experiments when possible&quot;
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>            ],
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>            &#39;languages&#39;: [
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>                &quot;Practice speaking daily, even if just to yourself&quot;,
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>                &quot;Immerse yourself with media in that language&quot;,
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>                &quot;Focus on common phrases before complex grammar&quot;
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>            ]
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>        }
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>        ## Select tips
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>        tips = general_tips.copy()
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>        if subject and subject in subject_specific_tips:
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>            tips.extend(subject_specific_tips[subject])
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>        selected_tips = random.sample(tips, min(3, len(tips)))
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>        response_text = f&quot;💡 **Study Tips{f&#39; for {subject.title()}&#39; if subject else &#39;&#39;}**\n\n&quot;
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>        for i, tip in enumerate(selected_tips, 1):
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>            response_text += f&quot;{i}. {tip}\n\n&quot;
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>        response_text += &quot;Which of these resonates with you? I can provide more specific advice!&quot;
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a>        return AssistantResponse(
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a>            text=response_text,
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>            action=&#39;tips_provided&#39;,
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a>            data={&#39;tips&#39;: selected_tips, &#39;subject&#39;: subject}
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>        )
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a>    def _suggest_break(self) -&gt; AssistantResponse:
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>        &quot;&quot;&quot;Suggest taking a break and provide break activities.&quot;&quot;&quot;
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a>        break_activities = [
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>            &quot;Take a 5-minute walk to get your blood flowing&quot;,
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a>            &quot;Do some light stretching or neck rolls&quot;,
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a>            &quot;Drink a glass of water and hydrate&quot;,
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a>            &quot;Look away from your screen and focus on something distant&quot;,
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a>            &quot;Take 5 deep breaths to reset your mind&quot;,
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>            &quot;Listen to one of your favorite songs&quot;
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>        ]
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>        activity = random.choice(break_activities)
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a>        response_text = f&quot;&quot;&quot;🧘 **Break Time Suggestion**
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>It sounds like you could use a break! Here&#39;s what I recommend:
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a>**Quick Break Activity**: {activity}
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a>**Why breaks matter:**
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a>• Improve focus and concentration
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a>• Prevent mental fatigue
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a>• Help consolidate what you&#39;ve learned
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>• Reduce stress and maintain motivation
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a>Take 5-10 minutes, then come back refreshed! I&#39;ll be here when you&#39;re ready to continue.&quot;&quot;&quot;
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a>        return AssistantResponse(
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>            text=response_text,
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a>            action=&#39;break_suggested&#39;,
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a>            data={&#39;activity&#39;: activity}
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a>        )
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a>    def _record_study_session(self, entities: Dict) -&gt; AssistantResponse:
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a>        &quot;&quot;&quot;Record a completed study session.&quot;&quot;&quot;
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a>        subject = entities.get(&#39;subject&#39;, &#39;general studies&#39;)
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a>        duration = entities.get(&#39;duration&#39;, 30)
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a>        difficulty = entities.get(&#39;difficulty&#39;, &#39;medium&#39;)
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a>        session = StudySession(
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a>            subject=subject,
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a>            duration_minutes=duration,
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a>            date=datetime.now(),
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a>            difficulty=difficulty,
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a>            notes=f&quot;Session recorded by assistant&quot;
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a>        )
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a>        self.study_history.append(session)
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a>        ## Calculate weekly progress
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a>        week_sessions = [s for s in self.study_history if 
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a>                        (datetime.now() - s.date).days &lt;= 7]
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a>        week_time = sum(s.duration_minutes for s in week_sessions)
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a>        response_text = f&quot;&quot;&quot;✅ **Session Recorded!**
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a>Great work! I&#39;ve logged your study session:
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a>• **Subject**: {subject.title()}
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a>• **Duration**: {duration} minutes
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a>• **Difficulty**: {difficulty.title()}
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a>**This Week&#39;s Progress**: {len(week_sessions)} sessions, {week_time} minutes total
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a>{self._get_encouraging_message(len(week_sessions))}&quot;&quot;&quot;
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a>        return AssistantResponse(
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a>            text=response_text,
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a>            action=&#39;session_recorded&#39;,
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a>            data={&#39;session&#39;: session, &#39;weekly_total&#39;: week_time}
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a>        )
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a>    def _provide_motivation(self) -&gt; AssistantResponse:
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a>        &quot;&quot;&quot;Provide motivational message.&quot;&quot;&quot;
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a>        motivational_messages = [
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a>            &quot;Remember: every expert was once a beginner. You&#39;re making progress!&quot;,
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a>            &quot;The fact that you&#39;re studying shows you&#39;re already ahead of the game!&quot;,
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a>            &quot;Small, consistent efforts lead to big results. Keep going!&quot;,
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a>            &quot;Learning is a journey, not a destination. Enjoy the process!&quot;,
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a>            &quot;You&#39;re building knowledge that will serve you for life!&quot;,
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a>            &quot;Every minute you study is an investment in your future self!&quot;
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a>        ]
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>        message = random.choice(motivational_messages)
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a>        ## Add personalized element if we have history
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a>        if self.study_history:
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a>            total_time = sum(s.duration_minutes for s in self.study_history)
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a>            hours = total_time // 60
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a>            if hours &gt; 0:
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a>                personal_note = f&quot;You&#39;ve already invested {hours}+ hours in learning - that&#39;s commitment!&quot;
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a>            else:
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a>                personal_note = &quot;Every session you complete builds your knowledge and confidence!&quot;
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a>        else:
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a>            personal_note = &quot;Starting your learning journey is the hardest part - you&#39;ve got this!&quot;
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a>        response_text = f&quot;&quot;&quot;🌟 **Motivation Boost**
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a>{message}
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a>{personal_note}
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a>**Remember:**
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a>• Progress isn&#39;t always visible day-to-day, but it&#39;s always happening
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a>• Struggling with difficult concepts means your brain is growing
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a>• Each study session makes the next one a little easier
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a>What&#39;s one small thing you can study for just 10 minutes right now?&quot;&quot;&quot;
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a>        return AssistantResponse(
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a>            text=response_text,
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a>            action=&#39;motivation_provided&#39;
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a>        )
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a>    def _general_response(self, message: str) -&gt; AssistantResponse:
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>        &quot;&quot;&quot;Handle general conversation.&quot;&quot;&quot;
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a>        greetings = [&#39;hello&#39;, &#39;hi&#39;, &#39;hey&#39;, &#39;good morning&#39;, &#39;good afternoon&#39;]
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a>        questions = [&#39;how are you&#39;, &#39;what can you do&#39;, &#39;help me&#39;]
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a>        if any(greeting in message for greeting in greetings):
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a>            return AssistantResponse(
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>                text=&quot;Hello! I&#39;m your study assistant. I can help you create study plans, track your progress, provide study tips, and keep you motivated. What would you like to work on today?&quot;
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a>            )
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>        elif any(question in message for question in questions):
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a>            return AssistantResponse(
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a>                text=&quot;&quot;&quot;I&#39;m here to help with your studies! Here&#39;s what I can do:
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a>📚 **Create personalized study plans**
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a>📊 **Track your study progress and stats**
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a>💡 **Provide subject-specific study tips**
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>🧘 **Remind you to take breaks**
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a>✅ **Record your study sessions**
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a>🌟 **Keep you motivated**
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>Just tell me what you need help with! For example:
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a>• &quot;Create a study plan for mathematics&quot;
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>• &quot;Show my progress&quot;
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a>• &quot;I need study tips for programming&quot;
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486" href="#__codelineno-0-486"></a>• &quot;I just studied Python for 45 minutes&quot;
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487" href="#__codelineno-0-487"></a>&quot;&quot;&quot;
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488" href="#__codelineno-0-488"></a>            )
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489" href="#__codelineno-0-489"></a>        else:
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490" href="#__codelineno-0-490"></a>            return AssistantResponse(
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491" href="#__codelineno-0-491"></a>                text=&quot;I&#39;m not sure I understand. Could you try asking about creating a study plan, tracking progress, getting study tips, or recording a study session?&quot;
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492" href="#__codelineno-0-492"></a>            )
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493" href="#__codelineno-0-493"></a>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494" href="#__codelineno-0-494"></a>    def _get_encouraging_message(self, weekly_sessions: int) -&gt; str:
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495" href="#__codelineno-0-495"></a>        &quot;&quot;&quot;Get encouraging message based on weekly activity.&quot;&quot;&quot;
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496" href="#__codelineno-0-496"></a>        if weekly_sessions &gt;= 5:
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497" href="#__codelineno-0-497"></a>            return &quot;🔥 Amazing consistency! You&#39;re on fire this week!&quot;
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498" href="#__codelineno-0-498"></a>        elif weekly_sessions &gt;= 3:
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499" href="#__codelineno-0-499"></a>            return &quot;👏 Great job staying consistent! Keep up the momentum!&quot;
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500" href="#__codelineno-0-500"></a>        elif weekly_sessions &gt;= 1:
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501" href="#__codelineno-0-501"></a>            return &quot;👍 Good start! Try to add another session or two this week.&quot;
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502" href="#__codelineno-0-502"></a>        else:
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503" href="#__codelineno-0-503"></a>            return &quot;💪 Ready to start building a study streak?&quot;
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504" href="#__codelineno-0-504"></a>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505" href="#__codelineno-0-505"></a>## Demonstration
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506" href="#__codelineno-0-506"></a>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507" href="#__codelineno-0-507"></a>def demonstrate_intelligent_assistant():
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508" href="#__codelineno-0-508"></a>    &quot;&quot;&quot;Demonstrate the intelligent study assistant.&quot;&quot;&quot;
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509" href="#__codelineno-0-509"></a>    print(&quot;Intelligent Assistant Application Demonstration&quot;)
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510" href="#__codelineno-0-510"></a>    print(&quot;=&quot; * 50)
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511" href="#__codelineno-0-511"></a>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512" href="#__codelineno-0-512"></a>    assistant = SmartStudyAssistant()
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513" href="#__codelineno-0-513"></a>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514" href="#__codelineno-0-514"></a>    ## Simulate conversation
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515" href="#__codelineno-0-515"></a>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516" href="#__codelineno-0-516"></a>    test_messages = [
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517" href="#__codelineno-0-517"></a>        &quot;Hi there!&quot;,
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518" href="#__codelineno-0-518"></a>        &quot;I need help creating a study plan for mathematics&quot;,
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519" href="#__codelineno-0-519"></a>        &quot;I just studied Python programming for 60 minutes&quot;,
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520" href="#__codelineno-0-520"></a>        &quot;Can you give me some study tips for programming?&quot;,
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521" href="#__codelineno-0-521"></a>        &quot;Show me my progress&quot;,
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522" href="#__codelineno-0-522"></a>        &quot;I&#39;m feeling discouraged about my studies&quot;,
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523" href="#__codelineno-0-523"></a>        &quot;Should I take a break? I&#39;ve been studying for 2 hours&quot;
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524" href="#__codelineno-0-524"></a>    ]
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525" href="#__codelineno-0-525"></a>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526" href="#__codelineno-0-526"></a>    print(&quot;Simulating conversation with study assistant:\n&quot;)
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527" href="#__codelineno-0-527"></a>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528" href="#__codelineno-0-528"></a>    for i, message in enumerate(test_messages, 1):
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529" href="#__codelineno-0-529"></a>        print(f&quot;User: {message}&quot;)
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530" href="#__codelineno-0-530"></a>        response = assistant.process_message(message)
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531" href="#__codelineno-0-531"></a>        print(f&quot;Assistant: {response.text}\n&quot;)
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532" href="#__codelineno-0-532"></a>        print(&quot;-&quot; * 40 + &quot;\n&quot;)
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533" href="#__codelineno-0-533"></a>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534" href="#__codelineno-0-534"></a>        ## Simulate some study history
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535" href="#__codelineno-0-535"></a>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536" href="#__codelineno-0-536"></a>        if i == 3:  # After recording first session
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537" href="#__codelineno-0-537"></a>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538" href="#__codelineno-0-538"></a>            ## Add some more history
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539" href="#__codelineno-0-539"></a>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540" href="#__codelineno-0-540"></a>            assistant.study_history.extend([
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541" href="#__codelineno-0-541"></a>                StudySession(&quot;mathematics&quot;, 45, datetime.now() - timedelta(days=1), &quot;medium&quot;, &quot;Algebra review&quot;),
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542" href="#__codelineno-0-542"></a>                StudySession(&quot;science&quot;, 30, datetime.now() - timedelta(days=2), &quot;easy&quot;, &quot;Chemistry basics&quot;),
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543" href="#__codelineno-0-543"></a>                StudySession(&quot;programming&quot;, 90, datetime.now() - timedelta(days=3), &quot;hard&quot;, &quot;Data structures&quot;)
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544" href="#__codelineno-0-544"></a>            ])
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545" href="#__codelineno-0-545"></a>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546" href="#__codelineno-0-546"></a>    return assistant
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547" href="#__codelineno-0-547"></a>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548" href="#__codelineno-0-548"></a>if __name__ == &quot;__main__&quot;:
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549" href="#__codelineno-0-549"></a>    demo_assistant = demonstrate_intelligent_assistant()
</span></code></pre></div>
<hr />
<h2 id="4-image-recognition-applications">4. Image Recognition Applications<a class="headerlink" href="#4-image-recognition-applications" title="Permanent link">&para;</a></h2>
<h3 id="what-is-ml-powered-image-recognition">What is ML-Powered Image Recognition?<a class="headerlink" href="#what-is-ml-powered-image-recognition" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong>: Using machine learning algorithms to automatically identify, classify, and analyze visual content in images and videos.</p>
<p><strong>Key Capabilities</strong>:</p>
<ul>
<li><strong>Object Detection</strong>: Identifying and locating objects within images</li>
<li><strong>Image Classification</strong>: Categorizing images into predefined classes</li>
<li><strong>Feature Extraction</strong>: Identifying important visual patterns and characteristics</li>
<li><strong>Optical Character Recognition (OCR)</strong>: Converting text in images to machine-readable text</li>
<li><strong>Facial Recognition</strong>: Identifying and verifying individuals from facial features</li>
</ul>
<h3 id="why-python-excels-at-image-recognition">Why Python Excels at Image Recognition<a class="headerlink" href="#why-python-excels-at-image-recognition" title="Permanent link">&para;</a></h3>
<p>Python&rsquo;s image recognition advantages:</p>
<ul>
<li><strong>Computer Vision Libraries</strong>: OpenCV, PIL/Pillow for image processing</li>
<li><strong>Deep Learning Frameworks</strong>: TensorFlow, PyTorch for neural networks</li>
<li><strong>Scientific Computing</strong>: NumPy for efficient array operations</li>
<li><strong>Pre-trained Models</strong>: Easy access to state-of-the-art models</li>
<li><strong>Visualization Tools</strong>: Matplotlib for displaying results and analysis</li>
</ul>
<h3 id="python-example-document-scanner-with-ocr">Python Example: Document Scanner with OCR<a class="headerlink" href="#python-example-document-scanner-with-ocr" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DocumentRegion</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a region detected in a document.&quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">region_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &#39;title&#39;, &#39;paragraph&#39;, &#39;table&#39;, &#39;image&#39;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OCRResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result of OCR processing.&quot;&quot;&quot;</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">regions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DocumentRegion</span><span class="p">]</span>
    <span class="n">processing_time</span><span class="p">:</span> <span class="nb">float</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DocumentScannerOCR</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ML-powered document scanner with OCR capabilities.</span>
<span class="sd">    Demonstrates Python&#39;s strengths in image recognition applications.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span> <span class="o">=</span> <span class="mf">0.7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_text_patterns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">document_templates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_document_templates</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_text_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize patterns for different types of text recognition.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b&#39;</span><span class="p">],</span>
            <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\b\d</span><span class="si">{3}</span><span class="s1">-\d</span><span class="si">{3}</span><span class="s1">-\d</span><span class="si">{4}</span><span class="s1">\b&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\(\d</span><span class="si">{3}</span><span class="s1">\)\s*\d</span><span class="si">{3}</span><span class="s1">-\d</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\d{1,2}/\d{1,2}/\d</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\d</span><span class="si">{4}</span><span class="s1">-\d</span><span class="si">{2}</span><span class="s1">-\d</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;currency&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\$\d+\.\d</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\$\d+&#39;</span><span class="p">],</span>
            <span class="s1">&#39;id_number&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\b\d</span><span class="si">{3}</span><span class="s1">-\d</span><span class="si">{2}</span><span class="s1">-\d</span><span class="si">{4}</span><span class="s1">\b&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\b[A-Z]</span><span class="si">{2}</span><span class="s1">\d</span><span class="si">{6}</span><span class="s1">\b&#39;</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_document_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize templates for different document types.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;invoice&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;required_fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;invoice_number&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;vendor&#39;</span><span class="p">],</span>
                <span class="s1">&#39;typical_structure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="s1">&#39;items_table&#39;</span><span class="p">,</span> <span class="s1">&#39;totals&#39;</span><span class="p">,</span> <span class="s1">&#39;footer&#39;</span><span class="p">],</span>
                <span class="s1">&#39;key_phrases&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;invoice&#39;</span><span class="p">,</span> <span class="s1">&#39;bill&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">,</span> <span class="s1">&#39;amount&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;receipt&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;required_fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">],</span>
                <span class="s1">&#39;typical_structure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">],</span>
                <span class="s1">&#39;key_phrases&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;receipt&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;tax&#39;</span><span class="p">,</span> <span class="s1">&#39;subtotal&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;contract&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;required_fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;parties&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;terms&#39;</span><span class="p">],</span>
                <span class="s1">&#39;typical_structure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;parties&#39;</span><span class="p">,</span> <span class="s1">&#39;terms&#39;</span><span class="p">,</span> <span class="s1">&#39;signatures&#39;</span><span class="p">],</span>
                <span class="s1">&#39;key_phrases&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;agreement&#39;</span><span class="p">,</span> <span class="s1">&#39;contract&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">,</span> <span class="s1">&#39;terms&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;required_fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">],</span>
                <span class="s1">&#39;typical_structure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">],</span>
                <span class="s1">&#39;key_phrases&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_image_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate image preprocessing steps (normally would use OpenCV).&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preprocessing image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1">## Simulate image analysis</span>

        <span class="n">preprocessing_steps</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;noise_reduction&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
            <span class="s1">&#39;contrast_enhancement&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">),</span>
            <span class="s1">&#39;skew_correction&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>  <span class="c1"># degrees</span>
            <span class="s1">&#39;resolution_enhancement&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
            <span class="s1">&#39;edge_detection_quality&#39;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">## Simulate image quality assessment</span>

        <span class="n">quality_score</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image quality score: </span><span class="si">{</span><span class="n">quality_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preprocessing completed:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">preprocessing_steps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39;Applied&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Skipped&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">step</span> <span class="o">==</span> <span class="s1">&#39;skew_correction&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">step</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;quality_score&#39;</span><span class="p">:</span> <span class="n">quality_score</span><span class="p">,</span>
            <span class="s1">&#39;preprocessing_steps&#39;</span><span class="p">:</span> <span class="n">preprocessing_steps</span><span class="p">,</span>
            <span class="s1">&#39;ready_for_ocr&#39;</span><span class="p">:</span> <span class="n">quality_score</span> <span class="o">&gt;</span> <span class="mf">0.6</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">perform_text_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processed_image_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DocumentRegion</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate text region detection (normally would use deep learning models).&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detecting text regions...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">processed_image_data</span><span class="p">[</span><span class="s1">&#39;ready_for_ocr&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image quality too low for reliable OCR&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1">## Simulate detected regions</span>

        <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">quality_score</span> <span class="o">=</span> <span class="n">processed_image_data</span><span class="p">[</span><span class="s1">&#39;quality_score&#39;</span><span class="p">]</span>

        <span class="c1">## Generate realistic document regions</span>

        <span class="n">document_regions</span> <span class="o">=</span> <span class="p">[</span>

            <span class="c1">## Header/Title region</span>

            <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;base_confidence&#39;</span><span class="p">:</span> <span class="mf">0.9</span>
            <span class="p">},</span>

            <span class="c1">## Main content paragraphs</span>

            <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;paragraph&#39;</span><span class="p">,</span> <span class="s1">&#39;base_confidence&#39;</span><span class="p">:</span> <span class="mf">0.85</span>
            <span class="p">},</span>

            <span class="c1">## Table or structured data</span>

            <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;base_confidence&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
            <span class="p">},</span>

            <span class="c1">## Footer information</span>

            <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">520</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;paragraph&#39;</span><span class="p">,</span> <span class="s1">&#39;base_confidence&#39;</span><span class="p">:</span> <span class="mf">0.75</span>
            <span class="p">}</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">region_data</span> <span class="ow">in</span> <span class="n">document_regions</span><span class="p">:</span>

            <span class="c1">## Confidence affected by image quality</span>

            <span class="n">confidence</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;base_confidence&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">quality_score</span>

            <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span><span class="p">:</span>

                <span class="c1">## Generate sample text for this region</span>

                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_sample_text</span><span class="p">(</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>

                <span class="n">region</span> <span class="o">=</span> <span class="n">DocumentRegion</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span>
                    <span class="n">height</span><span class="o">=</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span>
                    <span class="n">confidence</span><span class="o">=</span><span class="n">confidence</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                    <span class="n">region_type</span><span class="o">=</span><span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span><span class="si">}</span><span class="s2"> text regions&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_sample_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate realistic sample text for different region types.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">region_type</span> <span class="o">==</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span>
            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;INVOICE #INV-2024-001&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Receipt - ABC Store&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Service Agreement Contract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Application Form&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Medical Report&quot;</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">region_type</span> <span class="o">==</span> <span class="s1">&#39;paragraph&#39;</span><span class="p">:</span>
            <span class="n">paragraphs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;This document contains important information regarding your recent transaction. Please review all details carefully and contact us if you have any questions or concerns.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Payment is due within 30 days of the invoice date. Late payments may be subject to additional fees as outlined in our terms and conditions.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The services described herein are provided subject to the terms and conditions set forth in this agreement. Both parties agree to comply with all applicable laws and regulations.&quot;</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">paragraphs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">region_type</span> <span class="o">==</span> <span class="s1">&#39;table&#39;</span><span class="p">:</span>
            <span class="n">table_data</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;Item                Qty    Unit Price    Total</span><span class="se">\n</span><span class="s2">Consultation         1      $150.00    $150.00</span><span class="se">\n</span><span class="s2">Travel Time         2      $75.00     $150.00</span><span class="se">\n</span><span class="s2">Materials           1      $25.00     $25.00</span><span class="se">\n</span><span class="s2">                              TOTAL: $325.00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Date        Description          Amount</span><span class="se">\n</span><span class="s2">03/15/24    Coffee               $4.50</span><span class="se">\n</span><span class="s2">03/15/24    Sandwich             $8.95</span><span class="se">\n</span><span class="s2">03/15/24    Tax                  $1.35</span><span class="se">\n</span><span class="s2">                        Total: $14.80&quot;</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">table_data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Additional text content detected in document region.&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DocumentRegion</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract structured data from detected text regions.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting structured data...&quot;</span><span class="p">)</span>

        <span class="n">extracted_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;emails&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;phone_numbers&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;dates&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;currency_amounts&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;id_numbers&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;document_type&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;key_fields&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="c1">## Combine all text for pattern matching</span>

        <span class="n">all_text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">region</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">])</span>

        <span class="c1">## Extract patterns</span>

        <span class="k">for</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">patterns</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
                <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                    <span class="n">extracted_data</span><span class="p">[</span><span class="n">data_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;emails&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;phone_numbers&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;dates&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;currency&#39;</span><span class="p">,</span> <span class="s1">&#39;currency_amounts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;id_number&#39;</span><span class="p">,</span> <span class="s1">&#39;id_numbers&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

        <span class="c1">## Identify document type</span>

        <span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;document_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classify_document_type</span><span class="p">(</span><span class="n">all_text</span><span class="p">)</span>

        <span class="c1">## Extract key fields based on document type</span>

        <span class="k">if</span> <span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;document_type&#39;</span><span class="p">]:</span>
            <span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;key_fields&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_key_fields</span><span class="p">(</span>
                <span class="n">all_text</span><span class="p">,</span> <span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;document_type&#39;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identified document type: </span><span class="si">{</span><span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;document_type&#39;</span><span class="p">]</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracted </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="nb">list</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">extracted_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">}</span><span class="s2"> data elements&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">extracted_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_classify_document_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify document type based on content.&quot;&quot;&quot;</span>
        <span class="n">text_lower</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">type_scores</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">doc_type</span><span class="p">,</span> <span class="n">template</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_templates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">template</span><span class="p">[</span><span class="s1">&#39;key_phrases&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">text_lower</span><span class="p">:</span>
                    <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">type_scores</span><span class="p">[</span><span class="n">doc_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;key_phrases&#39;</span><span class="p">])</span>

        <span class="c1">## Return type with highest score if above threshold</span>

        <span class="n">best_type</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">type_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">type_scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">type_scores</span><span class="p">[</span><span class="n">best_type</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>  <span class="c1"># At least 30% of key phrases found</span>
            <span class="k">return</span> <span class="n">best_type</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_key_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">document_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract key fields specific to document type.&quot;&quot;&quot;</span>
        <span class="n">key_fields</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">document_type</span> <span class="o">==</span> <span class="s1">&#39;invoice&#39;</span><span class="p">:</span>

            <span class="c1">## Extract invoice number</span>

            <span class="n">invoice_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;invoice\s*#?\s*([A-Z0-9-]+)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">invoice_match</span><span class="p">:</span>
                <span class="n">key_fields</span><span class="p">[</span><span class="s1">&#39;invoice_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">invoice_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1">## Extract total amount</span>

            <span class="n">total_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;total:?\s*\$?(\d+\.\d</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">total_match</span><span class="p">:</span>
                <span class="n">key_fields</span><span class="p">[</span><span class="s1">&#39;total_amount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">document_type</span> <span class="o">==</span> <span class="s1">&#39;receipt&#39;</span><span class="p">:</span>

            <span class="c1">## Extract store/vendor name (assume it&#39;s in the title region)</span>

            <span class="n">vendor_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^([A-Z\s]+)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vendor_match</span><span class="p">:</span>
                <span class="n">key_fields</span><span class="p">[</span><span class="s1">&#39;vendor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vendor_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">key_fields</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OCRResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete document processing pipeline.&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing document: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

        <span class="c1">## Step 1: Image preprocessing</span>

        <span class="n">processed_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulate_image_preprocessing</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">processed_image</span><span class="p">[</span><span class="s1">&#39;ready_for_ocr&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">OCRResult</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">confidence</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">regions</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">processing_time</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="p">)</span>

        <span class="c1">## Step 2: Text detection</span>

        <span class="n">detected_regions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_text_detection</span><span class="p">(</span><span class="n">processed_image</span><span class="p">)</span>

        <span class="c1">## Step 3: Extract structured data</span>

        <span class="n">structured_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_structured_data</span><span class="p">(</span><span class="n">detected_regions</span><span class="p">)</span>

        <span class="c1">## Combine all text</span>

        <span class="n">full_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">region</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">detected_regions</span><span class="p">])</span>

        <span class="c1">## Calculate overall confidence</span>

        <span class="k">if</span> <span class="n">detected_regions</span><span class="p">:</span>
            <span class="n">overall_confidence</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">confidence</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">detected_regions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">detected_regions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">overall_confidence</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">processing_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">OCRResult</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="n">full_text</span><span class="p">,</span>
            <span class="n">confidence</span><span class="o">=</span><span class="n">overall_confidence</span><span class="p">,</span>
            <span class="n">regions</span><span class="o">=</span><span class="n">detected_regions</span><span class="p">,</span>
            <span class="n">processing_time</span><span class="o">=</span><span class="n">processing_time</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing completed in </span><span class="si">{</span><span class="n">processing_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall confidence: </span><span class="si">{</span><span class="n">overall_confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">structured_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_extraction_accuracy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extracted_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">expected_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the accuracy of data extraction.&quot;&quot;&quot;</span>
        <span class="n">accuracy_scores</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">field_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">,</span> <span class="s1">&#39;phone_numbers&#39;</span><span class="p">,</span> <span class="s1">&#39;dates&#39;</span><span class="p">,</span> <span class="s1">&#39;currency_amounts&#39;</span><span class="p">]:</span>
            <span class="n">extracted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">extracted_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_type</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="n">expected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_type</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">expected</span><span class="p">:</span>
                <span class="n">accuracy_scores</span><span class="p">[</span><span class="n">field_type</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">extracted</span> <span class="k">else</span> <span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="c1">## Calculate F1 score</span>

                <span class="n">true_positives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">extracted</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
                <span class="n">false_positives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">extracted</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span>
                <span class="n">false_negatives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected</span> <span class="o">-</span> <span class="n">extracted</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_positives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">precision</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">precision</span> <span class="o">=</span> <span class="n">true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_positives</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_negatives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">recall</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">recall</span> <span class="o">=</span> <span class="n">true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_negatives</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">f1_score</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>

                <span class="n">accuracy_scores</span><span class="p">[</span><span class="n">field_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">f1_score</span>

        <span class="k">return</span> <span class="n">accuracy_scores</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ImageClassificationDemo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstrates image classification capabilities.</span>
<span class="sd">    Shows how Python excels at organizing and categorizing images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;documents&#39;</span><span class="p">,</span> <span class="s1">&#39;receipts&#39;</span><span class="p">,</span> <span class="s1">&#39;business_cards&#39;</span><span class="p">,</span> <span class="s1">&#39;forms&#39;</span><span class="p">,</span>
            <span class="s1">&#39;photos&#39;</span><span class="p">,</span> <span class="s1">&#39;screenshots&#39;</span><span class="p">,</span> <span class="s1">&#39;diagrams&#39;</span><span class="p">,</span> <span class="s1">&#39;handwritten&#39;</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_category_features</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_category_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize features that help identify different image categories.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;documents&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;formal&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;limited&#39;</span><span class="p">,</span>
                <span class="s1">&#39;font_variety&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;receipts&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;tabular&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;limited&#39;</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;tall&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;business_cards&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;compact&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span>
                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;small&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;forms&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;fields&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;limited&#39;</span><span class="p">,</span>
                <span class="s1">&#39;whitespace&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;photos&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;natural&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;many&#39;</span><span class="p">,</span>
                <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="s1">&#39;soft&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;screenshots&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;ui_elements&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;digital&#39;</span><span class="p">,</span>
                <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="s1">&#39;sharp&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">classify_image_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_features</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify image type based on extracted features.&quot;&quot;&quot;</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">expected_features</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">total_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected_features</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">expected_value</span> <span class="ow">in</span> <span class="n">expected_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">image_features</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">image_features</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_value</span><span class="p">:</span>
                        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_compatible</span><span class="p">(</span><span class="n">image_features</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">expected_value</span><span class="p">):</span>
                        <span class="n">score</span> <span class="o">+=</span> <span class="mf">0.5</span>

            <span class="n">scores</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span> <span class="o">/</span> <span class="n">total_features</span>

        <span class="n">best_category</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">best_category</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">best_category</span><span class="p">,</span> <span class="n">confidence</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_features_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if features are compatible (for partial matches).&quot;&quot;&quot;</span>
        <span class="n">compatibility_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">):</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">):</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">(</span><span class="s1">&#39;limited&#39;</span><span class="p">,</span> <span class="s1">&#39;variable&#39;</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">(</span><span class="s1">&#39;formal&#39;</span><span class="p">,</span> <span class="s1">&#39;compact&#39;</span><span class="p">):</span> <span class="kc">True</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">compatibility_map</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">## Demonstration</span>

<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_image_recognition</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate image recognition capabilities.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image Recognition Application Demonstration&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

    <span class="c1">## Create OCR system</span>

    <span class="n">ocr_system</span> <span class="o">=</span> <span class="n">DocumentScannerOCR</span><span class="p">()</span>

    <span class="c1">## Test documents</span>

    <span class="n">test_documents</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;invoice_sample.pdf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;expected_type&#39;</span><span class="p">:</span> <span class="s1">&#39;invoice&#39;</span><span class="p">,</span>
            <span class="s1">&#39;expected_data&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;emails&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;billing@company.com&#39;</span><span class="p">],</span>
                <span class="s1">&#39;currency_amounts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;$325.00&#39;</span><span class="p">],</span>
                <span class="s1">&#39;dates&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;03/15/2024&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;receipt_photo.jpg&#39;</span><span class="p">,</span>
            <span class="s1">&#39;expected_type&#39;</span><span class="p">:</span> <span class="s1">&#39;receipt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;expected_data&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;currency_amounts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;$14.80&#39;</span><span class="p">],</span>
                <span class="s1">&#39;dates&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;03/15/24&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing document OCR processing:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">test_documents</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="n">doc</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

        <span class="c1">## Process document</span>

        <span class="n">ocr_result</span><span class="p">,</span> <span class="n">extracted_data</span> <span class="o">=</span> <span class="n">ocr_system</span><span class="o">.</span><span class="n">process_document</span><span class="p">(</span><span class="n">doc</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Extracted Text Preview:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ocr_result</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ocr_result</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">200</span> <span class="k">else</span> <span class="n">ocr_result</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Structured Data:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">extracted_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">values</span> <span class="ow">and</span> <span class="n">data_type</span> <span class="o">!=</span> <span class="s1">&#39;key_fields&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;key_fields&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Key Fields: </span><span class="si">{</span><span class="n">extracted_data</span><span class="p">[</span><span class="s1">&#39;key_fields&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1">## Validate accuracy</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">ocr_system</span><span class="o">.</span><span class="n">validate_extraction_accuracy</span><span class="p">(</span>
            <span class="n">extracted_data</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="s1">&#39;expected_data&#39;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Accuracy Metrics:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field_type</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">accuracy</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">field_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">## Demonstrate image classification</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing image classification:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">classifier</span> <span class="o">=</span> <span class="n">ImageClassificationDemo</span><span class="p">()</span>

    <span class="n">test_images</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;scanned_invoice.pdf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;formal&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;limited&#39;</span><span class="p">,</span>
                <span class="s1">&#39;font_variety&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;vacation_photo.jpg&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;text_density&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="s1">&#39;natural&#39;</span><span class="p">,</span>
                <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="s1">&#39;many&#39;</span><span class="p">,</span>
                <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="s1">&#39;soft&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">image_info</span> <span class="ow">in</span> <span class="n">test_images</span><span class="p">:</span>
        <span class="n">category</span><span class="p">,</span> <span class="n">confidence</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">classify_image_type</span><span class="p">(</span><span class="n">image_info</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image: </span><span class="si">{</span><span class="n">image_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Classified as: </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2"> (confidence: </span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features: </span><span class="si">{</span><span class="n">image_info</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ocr_system</span><span class="p">,</span> <span class="n">classifier</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_ocr</span><span class="p">,</span> <span class="n">demo_classifier</span> <span class="o">=</span> <span class="n">demonstrate_image_recognition</span><span class="p">()</span>
</code></pre>
</div>
<hr />
<h2 id="pythons-competitive-advantages-in-ml-applications">Python&rsquo;s Competitive Advantages in ML Applications<a class="headerlink" href="#pythons-competitive-advantages-in-ml-applications" title="Permanent link">&para;</a></h2>
<h3 id="why-python-dominates-ml-development">Why Python Dominates ML Development<a class="headerlink" href="#why-python-dominates-ml-development" title="Permanent link">&para;</a></h3>
<p><strong>1. Rich Ecosystem</strong></p>
<ul>
<li><strong>Data Science Stack</strong>: NumPy, Pandas, Matplotlib, SciPy</li>
<li><strong>ML Libraries</strong>: Scikit-learn, TensorFlow, PyTorch, Keras</li>
<li><strong>Specialized Tools</strong>: NLTK/spaCy (NLP), OpenCV (computer vision)</li>
</ul>
<p><strong>2. Developer Productivity</strong></p>
<ul>
<li><strong>Simple Syntax</strong>: Focus on algorithms, not language complexity</li>
<li><strong>Interactive Development</strong>: Jupyter notebooks for experimentation</li>
<li><strong>Rapid Prototyping</strong>: Quick iteration from idea to working prototype</li>
</ul>
<p><strong>3. Community and Resources</strong></p>
<ul>
<li><strong>Extensive Documentation</strong>: Well-documented libraries and tutorials</li>
<li><strong>Active Community</strong>: Large community contributing models and solutions</li>
<li><strong>Pre-trained Models</strong>: Easy access to state-of-the-art models</li>
</ul>
<p><strong>4. Integration Capabilities</strong></p>
<ul>
<li><strong>API Development</strong>: Flask/FastAPI for ML service deployment</li>
<li><strong>Database Connectivity</strong>: Easy integration with various data sources</li>
<li><strong>Cloud Platforms</strong>: Native support on AWS, Google Cloud, Azure</li>
</ul>
<h3 id="when-python-excels-vs-other-languages">When Python Excels vs. Other Languages<a class="headerlink" href="#when-python-excels-vs-other-languages" title="Permanent link">&para;</a></h3>
<p><strong>Python is Best For:</strong></p>
<ul>
<li>Research and experimentation</li>
<li>Data analysis and visualization</li>
<li>Rapid prototyping of ML solutions</li>
<li>Educational and learning purposes</li>
<li>Integration with existing Python systems</li>
</ul>
<p><strong>Consider Alternatives For:</strong></p>
<ul>
<li>High-performance production systems (C++, Rust)</li>
<li>Mobile applications (Swift, Kotlin, Flutter)</li>
<li>Real-time systems with strict latency requirements</li>
<li>Large-scale distributed systems (Java, Go)</li>
</ul>
<hr />
<h2 id="practice-tasks">Practice Tasks<a class="headerlink" href="#practice-tasks" title="Permanent link">&para;</a></h2>
<h3 id="task-1-customer-analysis-enhancement">Task 1: Customer Analysis Enhancement<a class="headerlink" href="#task-1-customer-analysis-enhancement" title="Permanent link">&para;</a></h3>
<p>Extend the <code>CustomerAnalysisML</code> system to include:
1. Seasonal spending pattern detection
2. Customer lifetime value prediction
3. Churn risk assessment based on behavior changes</p>
<h3 id="task-2-forecasting-model-improvement">Task 2: Forecasting Model Improvement<a class="headerlink" href="#task-2-forecasting-model-improvement" title="Permanent link">&para;</a></h3>
<p>Enhance the <code>SalesForecastingML</code> system with:
1. Multiple external factors (weather, events, economic indicators)
2. Accuracy improvement through ensemble methods
3. Confidence interval calculations for predictions</p>
<h3 id="task-3-assistant-conversation-flow">Task 3: Assistant Conversation Flow<a class="headerlink" href="#task-3-assistant-conversation-flow" title="Permanent link">&para;</a></h3>
<p>Expand the <code>SmartStudyAssistant</code> to handle:
1. Multi-turn conversations with context retention
2. Learning style adaptation based on user responses
3. Integration with external calendar and task systems</p>
<h3 id="task-4-ocr-system-extension">Task 4: OCR System Extension<a class="headerlink" href="#task-4-ocr-system-extension" title="Permanent link">&para;</a></h3>
<p>Improve the <code>DocumentScannerOCR</code> system by adding:
1. Support for different document orientations
2. Confidence-based error correction
3. Template matching for specific document types</p>
<hr />
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>ML Applications are Everywhere</strong>: From data analysis to intelligent assistants, ML solutions address real-world problems across industries</p>
</li>
<li>
<p><strong>Python&rsquo;s Ecosystem Advantage</strong>: The combination of libraries, tools, and community makes Python the dominant choice for ML development</p>
</li>
<li>
<p><strong>Pattern Recognition is Key</strong>: Whether analyzing customer behavior, forecasting trends, understanding language, or processing images, ML excels at finding patterns</p>
</li>
<li>
<p><strong>Integration Matters</strong>: Successful ML applications integrate seamlessly with existing systems and workflows</p>
</li>
<li>
<p><strong>Continuous Learning</strong>: ML systems improve over time as they process more data and receive feedback</p>
</li>
</ol>
<p>Python&rsquo;s strengths in ML applications stem from its ability to handle the entire pipeline: data processing, model development, deployment, and integration. This makes it an ideal choice for students learning ML concepts and professionals building production systems.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 16, 2025 05:58:30 UTC">October 16, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 – <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/ide-utils.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>