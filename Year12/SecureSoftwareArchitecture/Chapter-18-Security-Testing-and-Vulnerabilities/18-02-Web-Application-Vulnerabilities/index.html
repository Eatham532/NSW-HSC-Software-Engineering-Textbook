
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/SecureSoftwareArchitecture/Chapter-18-Security-Testing-and-Vulnerabilities/18-02-Web-Application-Vulnerabilities/">
      
      
        <link rel="prev" href="../18-01-Security-Testing-Fundamentals/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Content - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#182-web-application-vulnerabilities" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> â€“ content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Secure Software Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-14-Security-Foundations/14-01-The-Business-Case-for-Security/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 14 â€” Security Foundations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-15-Core-Security-Principles/15-01-Security-Fundamentals-CIA-Triad-and-AAA/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 15 â€” Core Security Principles
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-16-Input-Security-and-Data-Protection/16-01-Input-Validation-and-Sanitization/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 16 â€” Input Security and Data Protection
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-17-System-Security-and-APIs/17-01-Secure-API-Design/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 17 â€” System Security and APIs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 18 â€” Security Testing & Vulnerabilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            Chapter 18 â€” Security Testing & Vulnerabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../18-01-Security-Testing-Fundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    18.1 Security Testing Fundamentals
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_6_2" id="__nav_3_2_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    18.2 Web Application Vulnerabilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            18.2 Web Application Vulnerabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-site-request-forgery-csrf-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Site Request Forgery (CSRF) Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Site Request Forgery (CSRF) Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-csrf-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding CSRF Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-csrf-works" class="md-nav__link">
    <span class="md-ellipsis">
      How CSRF Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csrf-prevention-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      CSRF Prevention Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samesite-cookie-protection" class="md-nav__link">
    <span class="md-ellipsis">
      SameSite Cookie Protection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broken-authentication-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Broken Authentication Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Broken Authentication Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-authentication-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common Authentication Vulnerabilities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-misconfigurations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Misconfigurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Misconfigurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-configuration-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common Configuration Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-specific-security" class="md-nav__link">
    <span class="md-ellipsis">
      Environment-Specific Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#race-conditions-and-concurrency-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Race Conditions and Concurrency Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Race Conditions and Concurrency Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-race-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Race Conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-level-race-condition-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Database-Level Race Condition Prevention
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Side-Channel Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Side-Channel Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Side-Channel Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprehensive-web-security-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive Web Security Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Takeaways">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-application-security-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Web Application Security Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-19-Security-in-Context/19-01-Security-in-Development-Teams/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 19 â€” Security in Context
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareAutomation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-site-request-forgery-csrf-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Site Request Forgery (CSRF) Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Site Request Forgery (CSRF) Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-csrf-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding CSRF Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-csrf-works" class="md-nav__link">
    <span class="md-ellipsis">
      How CSRF Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csrf-prevention-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      CSRF Prevention Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samesite-cookie-protection" class="md-nav__link">
    <span class="md-ellipsis">
      SameSite Cookie Protection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#broken-authentication-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Broken Authentication Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Broken Authentication Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-authentication-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common Authentication Vulnerabilities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-misconfigurations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Misconfigurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Misconfigurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-configuration-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common Configuration Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-specific-security" class="md-nav__link">
    <span class="md-ellipsis">
      Environment-Specific Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#race-conditions-and-concurrency-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Race Conditions and Concurrency Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Race Conditions and Concurrency Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-race-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Race Conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-level-race-condition-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Database-Level Race Condition Prevention
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Side-Channel Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Side-Channel Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Side-Channel Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprehensive-web-security-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive Web Security Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Takeaways">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-application-security-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Web Application Security Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/SecureSoftwareArchitecture/Chapter-18-Security-Testing-and-Vulnerabilities/18-02-Web-Application-Vulnerabilities/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/SecureSoftwareArchitecture/Chapter-18-Security-Testing-and-Vulnerabilities/18-02-Web-Application-Vulnerabilities/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="182-web-application-vulnerabilities">18.2 Web Application Vulnerabilities<a class="headerlink" href="#182-web-application-vulnerabilities" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Learning Objectives</p>
<p>By the end of this section, you will be able to:</p>
<ul>
<li>Understand and prevent Cross-Site Request Forgery (CSRF) attacks</li>
<li>Identify and fix broken authentication patterns</li>
<li>Recognize and remediate security misconfigurations</li>
<li>Detect and prevent race conditions and concurrency issues</li>
<li>Understand and mitigate side-channel attacks</li>
</ul>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><strong>Web application vulnerabilities</strong> are security weaknesses that can be exploited by attackers to compromise web applications and their users. These vulnerabilities often arise from common coding mistakes, misconfigurations, or design flaws that create opportunities for unauthorized access, data theft, or system compromise.</p>
<p>Understanding these vulnerabilities is crucial because:</p>
<ul>
<li>
<p>Web applications are increasingly the primary attack vector</p>
</li>
<li>
<p>Many vulnerabilities are preventable with proper coding practices</p>
</li>
<li>
<p>The impact of successful attacks can be devastating for businesses and users</p>
</li>
<li>
<p>Security must be considered throughout the development lifecycle</p>
</li>
</ul>
<p>This section focuses on advanced web vulnerabilities that go beyond basic injection attacks, covering sophisticated attack vectors and their prevention.</p>
<h2 id="cross-site-request-forgery-csrf-prevention">Cross-Site Request Forgery (CSRF) Prevention<a class="headerlink" href="#cross-site-request-forgery-csrf-prevention" title="Permanent link">&para;</a></h2>
<h3 id="understanding-csrf-attacks">Understanding CSRF Attacks<a class="headerlink" href="#understanding-csrf-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Cross-Site Request Forgery (CSRF)</strong> tricks users into performing unintended actions on web applications where they&rsquo;re authenticated. The attacker crafts a malicious request that appears to come from a trusted user.</p>
<p>Think of CSRF like someone forging your signature on a check while you&rsquo;re not looking, using your identity to perform actions you never intended.</p>
<h3 id="how-csrf-works">How CSRF Works<a class="headerlink" href="#how-csrf-works" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Example vulnerable web application (using Flask)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">render_template_string</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s1">&#39;vulnerable_secret&#39;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Vulnerable endpoint - no CSRF protection</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/transfer&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">transfer_money</span><span class="p">():</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">if</span> <span class="s1">&#39;user_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="c1"># Vulnerable: directly processes POST data without CSRF token</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">to_account</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;to_account&#39;</span><span class="p">]</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">amount</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="c1"># Process transfer (simplified)</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transferring $</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2"> to account </span><span class="si">{</span><span class="n">to_account</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Transferred $</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_account</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1"># Malicious page that exploits CSRF vulnerability</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">malicious_html</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="s1">&lt;html&gt;</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="s1">&lt;body&gt;</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="s1">    &lt;h1&gt;You&#39;ve won a prize! Click here to claim:&lt;/h1&gt;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="s1">    &lt;!-- Hidden form that submits automatically --&gt;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="s1">    &lt;form id=&quot;malicious&quot; action=&quot;http://vulnerable-bank.com/transfer&quot; method=&quot;POST&quot;&gt;</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="s1">        &lt;input type=&quot;hidden&quot; name=&quot;to_account&quot; value=&quot;attacker_account&quot;&gt;</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="s1">        &lt;input type=&quot;hidden&quot; name=&quot;amount&quot; value=&quot;1000&quot;&gt;</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="s1">    &lt;/form&gt;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="s1">    &lt;script&gt;</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="s1">        // Automatically submit the form when page loads</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="s1">        document.getElementById(&#39;malicious&#39;).submit();</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="s1">    &lt;/script&gt;</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="s1">&lt;/body&gt;</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="s1">&lt;/html&gt;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="s1">&#39;&#39;&#39;</span>
</span></code></pre></div>
<h3 id="csrf-prevention-implementation">CSRF Prevention Implementation<a class="headerlink" href="#csrf-prevention-implementation" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import secrets
import hmac
import hashlib
from flask import Flask, request, session, abort
from functools import wraps

class CSRFProtection:
    def __init__(self, app=None):
        self.app = app
        if app:
            self.init_app(app)

    def init_app(self, app):
        app.config.setdefault(&#x27;CSRF_SECRET_KEY&#x27;, secrets.token_hex(32))
        app.before_request(self.check_csrf)

    def generate_csrf_token(self, session_data):
        &quot;&quot;&quot;Generate a CSRF token for the current session&quot;&quot;&quot;
        secret_key = self.app.config[&#x27;CSRF_SECRET_KEY&#x27;]
        user_id = session_data.get(&#x27;user_id&#x27;, &#x27;anonymous&#x27;)
        timestamp = str(int(time.time()))

        # Create token with user_id and timestamp
        token_data = f&quot;{user_id}:{timestamp}&quot;
        signature = hmac.new(
            secret_key.encode(),
            token_data.encode(),
            hashlib.sha256
        ).hexdigest()

        return f&quot;{token_data}:{signature}&quot;

    def validate_csrf_token(self, token, session_data):
        &quot;&quot;&quot;Validate a CSRF token&quot;&quot;&quot;
        try:
            parts = token.split(&#x27;:&#x27;)
            if len(parts) != 3:
                return False

            user_id, timestamp, signature = parts
            expected_token_data = f&quot;{user_id}:{timestamp}&quot;

            # Verify signature
            secret_key = self.app.config[&#x27;CSRF_SECRET_KEY&#x27;]
            expected_signature = hmac.new(
                secret_key.encode(),
                expected_token_data.encode(),
                hashlib.sha256
            ).hexdigest()

            if not hmac.compare_digest(signature, expected_signature):
                return False

            # Check if token is for current user
            if user_id != session_data.get(&#x27;user_id&#x27;, &#x27;anonymous&#x27;):
                return False

            # Check token age (24 hour expiry)
            import time
            token_time = int(timestamp)
            if time.time() - token_time &gt; 86400:  # 24 hours
                return False

            return True

        except (ValueError, TypeError):
            return False

    def check_csrf(self):
        &quot;&quot;&quot;Check CSRF token on state-changing requests&quot;&quot;&quot;
        if request.method in [&#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;, &#x27;PATCH&#x27;]:
            # Skip CSRF check for API endpoints with proper authentication
            if request.path.startswith(&#x27;/api/&#x27;) and self.is_api_authenticated():
                return

            token = request.form.get(&#x27;csrf_token&#x27;) or request.headers.get(&#x27;X-CSRF-Token&#x27;)

            if not token or not self.validate_csrf_token(token, session):
                abort(403, &quot;CSRF token validation failed&quot;)

    def is_api_authenticated(self):
        &quot;&quot;&quot;Check if request has proper API authentication&quot;&quot;&quot;
        # Implement API key or JWT validation
        api_key = request.headers.get(&#x27;X-API-Key&#x27;)
        return api_key and self.validate_api_key(api_key)

    def validate_api_key(self, api_key):
        &quot;&quot;&quot;Validate API key (simplified)&quot;&quot;&quot;
        # In real implementation, check against database
        valid_keys = [&#x27;api_key_1&#x27;, &#x27;api_key_2&#x27;]
        return api_key in valid_keys

# Secure web application with CSRF protection
app = Flask(__name__)
app.secret_key = &#x27;secure_secret_key&#x27;
csrf = CSRFProtection(app)

@app.route(&#x27;/transfer&#x27;, methods=[&#x27;POST&#x27;])
def secure_transfer():
    if &#x27;user_id&#x27; not in session:
        return redirect(&#x27;/login&#x27;)

    # CSRF protection is automatically applied by middleware
    to_account = request.form[&#x27;to_account&#x27;]
    amount = request.form[&#x27;amount&#x27;]

    # Additional validation
    if not validate_account_number(to_account):
        abort(400, &quot;Invalid account number&quot;)

    if not validate_amount(amount):
        abort(400, &quot;Invalid amount&quot;)

    # Process transfer
    print(f&quot;Secure transfer: ${amount} to account {to_account}&quot;)
    return f&quot;Transferred ${amount} to {to_account}&quot;

def validate_account_number(account):
    &quot;&quot;&quot;Validate account number format&quot;&quot;&quot;
    return account.isdigit() and len(account) &gt;= 8

def validate_amount(amount):
    &quot;&quot;&quot;Validate transfer amount&quot;&quot;&quot;
    try:
        amt = float(amount)
        return 0 &lt; amt &lt;= 10000  # Reasonable limits
    except ValueError:
        return False

# Template helper for CSRF tokens
@app.context_processor
def inject_csrf_token():
    if &#x27;user_id&#x27; in session:
        token = csrf.generate_csrf_token(session)
        return {&#x27;csrf_token&#x27;: token}
    return {}

# Secure form template
secure_form_template = &#x27;&#x27;&#x27;
&lt;form method=&quot;POST&quot; action=&quot;/transfer&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;{{ csrf_token }}&quot;&gt;
    &lt;label&gt;To Account: &lt;input type=&quot;text&quot; name=&quot;to_account&quot; required&gt;&lt;/label&gt;
    &lt;label&gt;Amount: &lt;input type=&quot;number&quot; name=&quot;amount&quot; step=&quot;0.01&quot; required&gt;&lt;/label&gt;
    &lt;button type=&quot;submit&quot;&gt;Transfer&lt;/button&gt;
&lt;/form&gt;
&#x27;&#x27;&#x27;
</code></pre>
</div>
<h3 id="samesite-cookie-protection">SameSite Cookie Protection<a class="headerlink" href="#samesite-cookie-protection" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Enhanced session configuration for CSRF protection</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nd">@app</span><span class="o">.</span><span class="n">after_request</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_secure_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="c1"># Set secure session cookie attributes</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="k">if</span> <span class="s1">&#39;Set-Cookie&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        <span class="n">cookies</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;Set-Cookie&#39;</span><span class="p">)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;Set-Cookie&#39;</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>        <span class="k">for</span> <span class="n">cookie</span> <span class="ow">in</span> <span class="n">cookies</span><span class="p">:</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>            <span class="k">if</span> <span class="s1">&#39;session=&#39;</span> <span class="ow">in</span> <span class="n">cookie</span><span class="p">:</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>                <span class="c1"># Add SameSite protection</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>                <span class="k">if</span> <span class="s1">&#39;SameSite=&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cookie</span><span class="p">:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>                    <span class="n">cookie</span> <span class="o">+=</span> <span class="s1">&#39;; SameSite=Strict&#39;</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>                <span class="c1"># Ensure Secure flag for HTTPS</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>                <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_secure</span> <span class="ow">and</span> <span class="s1">&#39;Secure&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cookie</span><span class="p">:</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>                    <span class="n">cookie</span> <span class="o">+=</span> <span class="s1">&#39;; Secure&#39;</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>                <span class="c1"># Add HttpOnly flag</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>                <span class="k">if</span> <span class="s1">&#39;HttpOnly&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cookie</span><span class="p">:</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>                    <span class="n">cookie</span> <span class="o">+=</span> <span class="s1">&#39;; HttpOnly&#39;</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>            <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Set-Cookie&#39;</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div>
<h2 id="broken-authentication-patterns">Broken Authentication Patterns<a class="headerlink" href="#broken-authentication-patterns" title="Permanent link">&para;</a></h2>
<h3 id="common-authentication-vulnerabilities">Common Authentication Vulnerabilities<a class="headerlink" href="#common-authentication-vulnerabilities" title="Permanent link">&para;</a></h3>
<p>Broken authentication encompasses various vulnerabilities that compromise user identity verification and session management.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import bcrypt
import jwt
import time
import secrets
from datetime import datetime, timedelta
from collections import defaultdict, deque

class VulnerableAuthenticator:
    &quot;&quot;&quot;Example of common authentication vulnerabilities&quot;&quot;&quot;

    def __init__(self):
        self.users = {
            &#x27;admin&#x27;: &#x27;admin123&#x27;,  # Vulnerable: weak password
            &#x27;user1&#x27;: &#x27;password&#x27;   # Vulnerable: common password
        }
        self.sessions = {}

    def login_vulnerable(self, username, password):
        &quot;&quot;&quot;Vulnerable login implementation&quot;&quot;&quot;
        # Vulnerable: no rate limiting
        # Vulnerable: timing attack possible
        if username in self.users and self.users[username] == password:
            # Vulnerable: predictable session ID
            session_id = f&quot;{username}_{int(time.time())}&quot;
            self.sessions[session_id] = username
            return session_id
        return None

    def check_session_vulnerable(self, session_id):
        &quot;&quot;&quot;Vulnerable session validation&quot;&quot;&quot;
        # Vulnerable: no session timeout
        # Vulnerable: no session invalidation
        return self.sessions.get(session_id)

class SecureAuthenticator:
    &quot;&quot;&quot;Secure authentication implementation&quot;&quot;&quot;

    def __init__(self):
        self.users = {}
        self.sessions = {}
        self.failed_attempts = defaultdict(deque)
        self.locked_accounts = {}
        self.session_timeout = 3600  # 1 hour
        self.max_failed_attempts = 5
        self.lockout_duration = 900  # 15 minutes

    def register_user(self, username, password):
        &quot;&quot;&quot;Secure user registration&quot;&quot;&quot;
        # Validate password strength
        if not self.is_strong_password(password):
            raise ValueError(&quot;Password does not meet security requirements&quot;)

        # Hash password with salt
        password_hash = bcrypt.hashpw(password.encode(&#x27;utf-8&#x27;), bcrypt.gensalt())

        self.users[username] = {
            &#x27;password_hash&#x27;: password_hash,
            &#x27;created_at&#x27;: datetime.now(),
            &#x27;last_login&#x27;: None,
            &#x27;failed_login_count&#x27;: 0
        }

    def is_strong_password(self, password):
        &quot;&quot;&quot;Validate password strength&quot;&quot;&quot;
        if len(password) &lt; 12:
            return False

        has_upper = any(c.isupper() for c in password)
        has_lower = any(c.islower() for c in password)
        has_digit = any(c.isdigit() for c in password)
        has_special = any(c in &#x27;!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?&#x27; for c in password)

        # Common password check (simplified)
        common_passwords = [&#x27;password&#x27;, &#x27;123456&#x27;, &#x27;admin123&#x27;, &#x27;qwerty&#x27;]
        if password.lower() in common_passwords:
            return False

        return has_upper and has_lower and has_digit and has_special

    def login(self, username, password, client_ip):
        &quot;&quot;&quot;Secure login with rate limiting and proper validation&quot;&quot;&quot;
        current_time = time.time()

        # Check if account is locked
        if self.is_account_locked(username):
            raise Exception(&quot;Account temporarily locked due to failed login attempts&quot;)

        # Check rate limiting per IP
        if self.is_ip_rate_limited(client_ip):
            raise Exception(&quot;Too many login attempts from this IP&quot;)

        # Validate user exists
        if username not in self.users:
            self.record_failed_attempt(username, client_ip)
            # Use constant time to prevent username enumeration
            bcrypt.hashpw(b&#x27;dummy&#x27;, bcrypt.gensalt())
            raise Exception(&quot;Invalid credentials&quot;)

        user_data = self.users[username]

        # Verify password (constant time comparison)
        if not bcrypt.checkpw(password.encode(&#x27;utf-8&#x27;), user_data[&#x27;password_hash&#x27;]):
            self.record_failed_attempt(username, client_ip)
            raise Exception(&quot;Invalid credentials&quot;)

        # Reset failed attempts on successful login
        self.reset_failed_attempts(username, client_ip)

        # Create secure session
        session_id = self.create_session(username)

        # Update last login
        user_data[&#x27;last_login&#x27;] = datetime.now()

        return session_id

    def create_session(self, username):
        &quot;&quot;&quot;Create cryptographically secure session&quot;&quot;&quot;
        session_id = secrets.token_urlsafe(32)

        self.sessions[session_id] = {
            &#x27;username&#x27;: username,
            &#x27;created_at&#x27;: time.time(),
            &#x27;last_activity&#x27;: time.time(),
            &#x27;ip_address&#x27;: None,  # Set by calling code
            &#x27;user_agent&#x27;: None   # Set by calling code
        }

        return session_id

    def validate_session(self, session_id, client_ip=None, user_agent=None):
        &quot;&quot;&quot;Validate session with security checks&quot;&quot;&quot;
        if session_id not in self.sessions:
            return None

        session = self.sessions[session_id]
        current_time = time.time()

        # Check session timeout
        if current_time - session[&#x27;last_activity&#x27;] &gt; self.session_timeout:
            self.invalidate_session(session_id)
            return None

        # Check for session hijacking (simplified)
        if client_ip and session.get(&#x27;ip_address&#x27;) and session[&#x27;ip_address&#x27;] != client_ip:
            self.invalidate_session(session_id)
            raise Exception(&quot;Session security violation detected&quot;)

        # Update last activity
        session[&#x27;last_activity&#x27;] = current_time

        return session[&#x27;username&#x27;]

    def invalidate_session(self, session_id):
        &quot;&quot;&quot;Securely invalidate session&quot;&quot;&quot;
        if session_id in self.sessions:
            del self.sessions[session_id]

    def is_account_locked(self, username):
        &quot;&quot;&quot;Check if account is temporarily locked&quot;&quot;&quot;
        if username in self.locked_accounts:
            lock_time = self.locked_accounts[username]
            if time.time() - lock_time &lt; self.lockout_duration:
                return True
            else:
                del self.locked_accounts[username]
        return False

    def is_ip_rate_limited(self, client_ip):
        &quot;&quot;&quot;Check if IP is rate limited&quot;&quot;&quot;
        current_time = time.time()

        # Clean old attempts (older than 15 minutes)
        while (self.failed_attempts[client_ip] and 
               current_time - self.failed_attempts[client_ip][0] &gt; 900):
            self.failed_attempts[client_ip].popleft()

        # Check if too many attempts
        return len(self.failed_attempts[client_ip]) &gt;= self.max_failed_attempts

    def record_failed_attempt(self, username, client_ip):
        &quot;&quot;&quot;Record failed login attempt&quot;&quot;&quot;
        current_time = time.time()

        # Record IP-based attempt
        self.failed_attempts[client_ip].append(current_time)

        # Update user failed count
        if username in self.users:
            self.users[username][&#x27;failed_login_count&#x27;] += 1

            # Lock account if too many failures
            if self.users[username][&#x27;failed_login_count&#x27;] &gt;= self.max_failed_attempts:
                self.locked_accounts[username] = current_time

    def reset_failed_attempts(self, username, client_ip):
        &quot;&quot;&quot;Reset failed attempts on successful login&quot;&quot;&quot;
        if username in self.users:
            self.users[username][&#x27;failed_login_count&#x27;] = 0

        if client_ip in self.failed_attempts:
            self.failed_attempts[client_ip].clear()

# Example usage with Flask
from flask import Flask, request, session, jsonify

app = Flask(__name__)
app.secret_key = secrets.token_hex(32)
auth = SecureAuthenticator()

@app.route(&#x27;/register&#x27;, methods=[&#x27;POST&#x27;])
def register():
    try:
        data = request.get_json()
        auth.register_user(data[&#x27;username&#x27;], data[&#x27;password&#x27;])
        return jsonify({&#x27;status&#x27;: &#x27;success&#x27;, &#x27;message&#x27;: &#x27;User registered&#x27;})
    except Exception as e:
        return jsonify({&#x27;status&#x27;: &#x27;error&#x27;, &#x27;message&#x27;: str(e)}), 400

@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])
def login():
    try:
        data = request.get_json()
        session_id = auth.login(
            data[&#x27;username&#x27;], 
            data[&#x27;password&#x27;], 
            request.remote_addr
        )

        session[&#x27;session_id&#x27;] = session_id
        return jsonify({&#x27;status&#x27;: &#x27;success&#x27;, &#x27;session_id&#x27;: session_id})

    except Exception as e:
        return jsonify({&#x27;status&#x27;: &#x27;error&#x27;, &#x27;message&#x27;: str(e)}), 401

@app.route(&#x27;/protected&#x27;)
def protected_resource():
    session_id = session.get(&#x27;session_id&#x27;)
    if not session_id:
        return jsonify({&#x27;error&#x27;: &#x27;Not authenticated&#x27;}), 401

    try:
        username = auth.validate_session(
            session_id, 
            request.remote_addr, 
            request.user_agent.string
        )
        return jsonify({&#x27;message&#x27;: f&#x27;Hello {username}&#x27;, &#x27;data&#x27;: &#x27;protected content&#x27;})

    except Exception as e:
        return jsonify({&#x27;error&#x27;: str(e)}), 401
</code></pre>
</div>
<h2 id="security-misconfigurations">Security Misconfigurations<a class="headerlink" href="#security-misconfigurations" title="Permanent link">&para;</a></h2>
<h3 id="common-configuration-vulnerabilities">Common Configuration Vulnerabilities<a class="headerlink" href="#common-configuration-vulnerabilities" title="Permanent link">&para;</a></h3>
<p>Security misconfigurations are among the most common vulnerabilities, often resulting from default settings, incomplete configurations, or overly permissive setups.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import os
from flask import Flask
from flask_talisman import Talisman

class SecurityConfigurationManager:
    &quot;&quot;&quot;Manages secure application configuration&quot;&quot;&quot;

    def __init__(self):
        self.security_headers = {
            &#x27;Content-Security-Policy&#x27;: &quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;&quot;,
            &#x27;X-Content-Type-Options&#x27;: &#x27;nosniff&#x27;,
            &#x27;X-Frame-Options&#x27;: &#x27;DENY&#x27;,
            &#x27;X-XSS-Protection&#x27;: &#x27;1; mode=block&#x27;,
            &#x27;Strict-Transport-Security&#x27;: &#x27;max-age=31536000; includeSubDomains&#x27;,
            &#x27;Referrer-Policy&#x27;: &#x27;strict-origin-when-cross-origin&#x27;
        }

    def configure_secure_flask_app(self, app):
        &quot;&quot;&quot;Configure Flask app with security best practices&quot;&quot;&quot;

        # Secure configuration
        app.config.update({
            # Session security
            &#x27;SESSION_COOKIE_SECURE&#x27;: True,  # HTTPS only
            &#x27;SESSION_COOKIE_HTTPONLY&#x27;: True,  # No JavaScript access
            &#x27;SESSION_COOKIE_SAMESITE&#x27;: &#x27;Strict&#x27;,  # CSRF protection
            &#x27;PERMANENT_SESSION_LIFETIME&#x27;: 3600,  # 1 hour timeout

            # General security
            &#x27;SECRET_KEY&#x27;: os.environ.get(&#x27;SECRET_KEY&#x27;, os.urandom(32)),
            &#x27;WTF_CSRF_ENABLED&#x27;: True,
            &#x27;DEBUG&#x27;: False,  # Never enable in production
            &#x27;TESTING&#x27;: False,

            # File upload security
            &#x27;MAX_CONTENT_LENGTH&#x27;: 16 * 1024 * 1024,  # 16MB max file size
            &#x27;UPLOAD_FOLDER&#x27;: &#x27;/secure/uploads&#x27;,

            # Database security
            &#x27;SQLALCHEMY_DATABASE_URI&#x27;: os.environ.get(&#x27;DATABASE_URL&#x27;, &#x27;sqlite:///secure_app.db&#x27;),
            &#x27;SQLALCHEMY_TRACK_MODIFICATIONS&#x27;: False,
            &#x27;SQLALCHEMY_ENGINE_OPTIONS&#x27;: {
                &#x27;pool_pre_ping&#x27;: True,
                &#x27;pool_recycle&#x27;: 300,
            }
        })

        # Apply security headers
        Talisman(app, 
                force_https=True,
                strict_transport_security=True,
                content_security_policy=self.security_headers[&#x27;Content-Security-Policy&#x27;])

        return app

    def check_configuration_security(self, app):
        &quot;&quot;&quot;Audit application configuration for security issues&quot;&quot;&quot;
        issues = []

        # Check debug mode
        if app.config.get(&#x27;DEBUG&#x27;, False):
            issues.append({
                &#x27;severity&#x27;: &#x27;critical&#x27;,
                &#x27;issue&#x27;: &#x27;Debug mode enabled in production&#x27;,
                &#x27;recommendation&#x27;: &#x27;Set DEBUG=False&#x27;
            })

        # Check secret key
        secret_key = app.config.get(&#x27;SECRET_KEY&#x27;)
        if not secret_key or len(str(secret_key)) &lt; 32:
            issues.append({
                &#x27;severity&#x27;: &#x27;critical&#x27;,
                &#x27;issue&#x27;: &#x27;Weak or missing secret key&#x27;,
                &#x27;recommendation&#x27;: &#x27;Use a strong, randomly generated secret key&#x27;
            })

        # Check session security
        if not app.config.get(&#x27;SESSION_COOKIE_SECURE&#x27;, False):
            issues.append({
                &#x27;severity&#x27;: &#x27;high&#x27;,
                &#x27;issue&#x27;: &#x27;Session cookies not marked as secure&#x27;,
                &#x27;recommendation&#x27;: &#x27;Set SESSION_COOKIE_SECURE=True&#x27;
            })

        if not app.config.get(&#x27;SESSION_COOKIE_HTTPONLY&#x27;, False):
            issues.append({
                &#x27;severity&#x27;: &#x27;high&#x27;,
                &#x27;issue&#x27;: &#x27;Session cookies accessible to JavaScript&#x27;,
                &#x27;recommendation&#x27;: &#x27;Set SESSION_COOKIE_HTTPONLY=True&#x27;
            })

        # Check HTTPS enforcement
        if not app.config.get(&#x27;PREFERRED_URL_SCHEME&#x27;) == &#x27;https&#x27;:
            issues.append({
                &#x27;severity&#x27;: &#x27;medium&#x27;,
                &#x27;issue&#x27;: &#x27;HTTPS not enforced&#x27;,
                &#x27;recommendation&#x27;: &#x27;Set PREFERRED_URL_SCHEME=https&#x27;
            })

        return issues

# Example of secure vs insecure configuration
def create_vulnerable_app():
    &quot;&quot;&quot;Example of insecure Flask configuration&quot;&quot;&quot;
    app = Flask(__name__)

    # Vulnerable configurations
    app.config.update({
        &#x27;DEBUG&#x27;: True,  # Exposes sensitive information
        &#x27;SECRET_KEY&#x27;: &#x27;easy_to_guess&#x27;,  # Weak secret
        &#x27;SESSION_COOKIE_SECURE&#x27;: False,  # Allows HTTP transmission
        &#x27;SESSION_COOKIE_HTTPONLY&#x27;: False,  # XSS vulnerable
        &#x27;WTF_CSRF_ENABLED&#x27;: False,  # CSRF vulnerable
    })

    return app

def create_secure_app():
    &quot;&quot;&quot;Example of secure Flask configuration&quot;&quot;&quot;
    app = Flask(__name__)
    config_manager = SecurityConfigurationManager()

    # Apply secure configuration
    secure_app = config_manager.configure_secure_flask_app(app)

    # Additional security middleware
    @secure_app.before_request
    def security_headers():
        # Custom security headers if needed
        pass

    @secure_app.after_request
    def apply_caching(response):
        # Prevent caching of sensitive pages
        if request.endpoint in [&#x27;login&#x27;, &#x27;admin&#x27;, &#x27;profile&#x27;]:
            response.headers[&#x27;Cache-Control&#x27;] = &#x27;no-cache, no-store, must-revalidate&#x27;
            response.headers[&#x27;Pragma&#x27;] = &#x27;no-cache&#x27;
            response.headers[&#x27;Expires&#x27;] = &#x27;0&#x27;

        return response

    return secure_app
</code></pre>
</div>
<h3 id="environment-specific-security">Environment-Specific Security<a class="headerlink" href="#environment-specific-security" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import os
import json
from pathlib import Path

class EnvironmentSecurityValidator:
    &quot;&quot;&quot;Validates security configurations across environments&quot;&quot;&quot;

    def __init__(self):
        self.required_env_vars = [
            &#x27;SECRET_KEY&#x27;,
            &#x27;DATABASE_URL&#x27;,
            &#x27;API_KEY_ENCRYPTION_KEY&#x27;
        ]

        self.sensitive_patterns = [
            &#x27;password&#x27;,
            &#x27;secret&#x27;,
            &#x27;key&#x27;,
            &#x27;token&#x27;,
            &#x27;credential&#x27;
        ]

    def validate_environment(self):
        &quot;&quot;&quot;Validate current environment security&quot;&quot;&quot;
        issues = []

        # Check required environment variables
        for var in self.required_env_vars:
            if not os.environ.get(var):
                issues.append({
                    &#x27;type&#x27;: &#x27;missing_env_var&#x27;,
                    &#x27;severity&#x27;: &#x27;critical&#x27;,
                    &#x27;details&#x27;: f&#x27;Required environment variable {var} not set&#x27;
                })

        # Check for hardcoded secrets in environment
        for key, value in os.environ.items():
            if any(pattern in key.lower() for pattern in self.sensitive_patterns):
                if len(value) &lt; 16:  # Suspiciously short for a secret
                    issues.append({
                        &#x27;type&#x27;: &#x27;weak_secret&#x27;,
                        &#x27;severity&#x27;: &#x27;high&#x27;,
                        &#x27;details&#x27;: f&#x27;Environment variable {key} appears to contain a weak secret&#x27;
                    })

        # Check file permissions on sensitive files
        sensitive_files = [&#x27;.env&#x27;, &#x27;config.py&#x27;, &#x27;secrets.json&#x27;]
        for filename in sensitive_files:
            filepath = Path(filename)
            if filepath.exists():
                stat = filepath.stat()
                # Check if file is readable by others (Unix-like systems)
                if hasattr(stat, &#x27;st_mode&#x27;) and (stat.st_mode &amp; 0o044):
                    issues.append({
                        &#x27;type&#x27;: &#x27;file_permissions&#x27;,
                        &#x27;severity&#x27;: &#x27;medium&#x27;,
                        &#x27;details&#x27;: f&#x27;Sensitive file {filename} is readable by others&#x27;
                    })

        return issues

    def secure_config_loader(self, config_file):
        &quot;&quot;&quot;Securely load configuration from file&quot;&quot;&quot;
        try:
            config_path = Path(config_file)

            # Verify file permissions
            if config_path.exists():
                stat = config_path.stat()
                if hasattr(stat, &#x27;st_mode&#x27;) and (stat.st_mode &amp; 0o044):
                    raise PermissionError(f&quot;Config file {config_file} has insecure permissions&quot;)

            # Load and validate configuration
            with open(config_path, &#x27;r&#x27;) as f:
                config = json.load(f)

            # Validate configuration structure
            self.validate_config_structure(config)

            return config

        except Exception as e:
            raise Exception(f&quot;Failed to load secure configuration: {e}&quot;)

    def validate_config_structure(self, config):
        &quot;&quot;&quot;Validate configuration structure and values&quot;&quot;&quot;
        # Check for required security settings
        security_settings = config.get(&#x27;security&#x27;, {})

        required_security_keys = [
            &#x27;session_timeout&#x27;,
            &#x27;max_login_attempts&#x27;,
            &#x27;password_policy&#x27;
        ]

        for key in required_security_keys:
            if key not in security_settings:
                raise ValueError(f&quot;Missing required security setting: {key}&quot;)

        # Validate password policy
        password_policy = security_settings.get(&#x27;password_policy&#x27;, {})
        if password_policy.get(&#x27;min_length&#x27;, 0) &lt; 12:
            raise ValueError(&quot;Password minimum length should be at least 12 characters&quot;)
</code></pre>
</div>
<h2 id="race-conditions-and-concurrency-issues">Race Conditions and Concurrency Issues<a class="headerlink" href="#race-conditions-and-concurrency-issues" title="Permanent link">&para;</a></h2>
<h3 id="understanding-race-conditions">Understanding Race Conditions<a class="headerlink" href="#understanding-race-conditions" title="Permanent link">&para;</a></h3>
<p><strong>Race conditions</strong> occur when the behavior of software depends on the relative timing of events, such as the order in which threads execute. In web applications, this can lead to data corruption, privilege escalation, or business logic bypasses.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import threading
import time
import uuid
from collections import defaultdict

class VulnerableWallet:
    &quot;&quot;&quot;Example of race condition vulnerability&quot;&quot;&quot;

    def __init__(self):
        self.balances = defaultdict(float)
        self.transactions = []

    def deposit(self, user_id, amount):
        &quot;&quot;&quot;Vulnerable deposit method&quot;&quot;&quot;
        # Race condition: non-atomic read-modify-write
        current_balance = self.balances[user_id]
        time.sleep(0.001)  # Simulate processing delay
        self.balances[user_id] = current_balance + amount

        self.transactions.append({
            &#x27;type&#x27;: &#x27;deposit&#x27;,
            &#x27;user_id&#x27;: user_id,
            &#x27;amount&#x27;: amount,
            &#x27;timestamp&#x27;: time.time()
        })

    def withdraw(self, user_id, amount):
        &quot;&quot;&quot;Vulnerable withdrawal method&quot;&quot;&quot;
        # Race condition: check-then-use vulnerability
        if self.balances[user_id] &gt;= amount:
            time.sleep(0.001)  # Simulate processing delay
            current_balance = self.balances[user_id]
            self.balances[user_id] = current_balance - amount

            self.transactions.append({
                &#x27;type&#x27;: &#x27;withdraw&#x27;,
                &#x27;user_id&#x27;: user_id,
                &#x27;amount&#x27;: amount,
                &#x27;timestamp&#x27;: time.time()
            })
            return True
        return False

class SecureWallet:
    &quot;&quot;&quot;Secure implementation with proper concurrency control&quot;&quot;&quot;

    def __init__(self):
        self.balances = defaultdict(float)
        self.transactions = []
        self.locks = defaultdict(threading.RLock)  # Per-user locks
        self.global_lock = threading.RLock()

    def deposit(self, user_id, amount):
        &quot;&quot;&quot;Thread-safe deposit method&quot;&quot;&quot;
        if amount &lt;= 0:
            raise ValueError(&quot;Deposit amount must be positive&quot;)

        with self.locks[user_id]:
            # Atomic operation within lock
            self.balances[user_id] += amount

            with self.global_lock:
                self.transactions.append({
                    &#x27;id&#x27;: str(uuid.uuid4()),
                    &#x27;type&#x27;: &#x27;deposit&#x27;,
                    &#x27;user_id&#x27;: user_id,
                    &#x27;amount&#x27;: amount,
                    &#x27;timestamp&#x27;: time.time(),
                    &#x27;status&#x27;: &#x27;completed&#x27;
                })

    def withdraw(self, user_id, amount):
        &quot;&quot;&quot;Thread-safe withdrawal method&quot;&quot;&quot;
        if amount &lt;= 0:
            raise ValueError(&quot;Withdrawal amount must be positive&quot;)

        with self.locks[user_id]:
            # Atomic check and update
            if self.balances[user_id] &gt;= amount:
                self.balances[user_id] -= amount

                with self.global_lock:
                    self.transactions.append({
                        &#x27;id&#x27;: str(uuid.uuid4()),
                        &#x27;type&#x27;: &#x27;withdraw&#x27;,
                        &#x27;user_id&#x27;: user_id,
                        &#x27;amount&#x27;: amount,
                        &#x27;timestamp&#x27;: time.time(),
                        &#x27;status&#x27;: &#x27;completed&#x27;
                    })
                return True
            else:
                with self.global_lock:
                    self.transactions.append({
                        &#x27;id&#x27;: str(uuid.uuid4()),
                        &#x27;type&#x27;: &#x27;withdraw_failed&#x27;,
                        &#x27;user_id&#x27;: user_id,
                        &#x27;amount&#x27;: amount,
                        &#x27;timestamp&#x27;: time.time(),
                        &#x27;status&#x27;: &#x27;insufficient_funds&#x27;
                    })
                return False

    def transfer(self, from_user_id, to_user_id, amount):
        &quot;&quot;&quot;Thread-safe transfer between users&quot;&quot;&quot;
        if amount &lt;= 0:
            raise ValueError(&quot;Transfer amount must be positive&quot;)

        if from_user_id == to_user_id:
            raise ValueError(&quot;Cannot transfer to same user&quot;)

        # Always acquire locks in consistent order to prevent deadlock
        user_ids = sorted([from_user_id, to_user_id])

        with self.locks[user_ids[0]], self.locks[user_ids[1]]:
            if self.balances[from_user_id] &gt;= amount:
                self.balances[from_user_id] -= amount
                self.balances[to_user_id] += amount

                with self.global_lock:
                    transaction_id = str(uuid.uuid4())

                    # Record as single atomic transaction
                    self.transactions.append({
                        &#x27;id&#x27;: transaction_id,
                        &#x27;type&#x27;: &#x27;transfer&#x27;,
                        &#x27;from_user_id&#x27;: from_user_id,
                        &#x27;to_user_id&#x27;: to_user_id,
                        &#x27;amount&#x27;: amount,
                        &#x27;timestamp&#x27;: time.time(),
                        &#x27;status&#x27;: &#x27;completed&#x27;
                    })

                return transaction_id
            else:
                raise ValueError(&quot;Insufficient funds for transfer&quot;)

# Demonstration of race condition
def demonstrate_race_condition():
    &quot;&quot;&quot;Demonstrate race condition vulnerability&quot;&quot;&quot;
    vulnerable_wallet = VulnerableWallet()
    secure_wallet = SecureWallet()

    # Add initial balance
    vulnerable_wallet.balances[&#x27;user1&#x27;] = 100
    secure_wallet.balances[&#x27;user1&#x27;] = 100

    def attempt_concurrent_withdrawals(wallet, user_id, amount, attempts):
        &quot;&quot;&quot;Attempt multiple concurrent withdrawals&quot;&quot;&quot;
        threads = []
        results = []

        def withdraw_worker():
            result = wallet.withdraw(user_id, amount)
            results.append(result)

        # Start multiple threads simultaneously
        for _ in range(attempts):
            thread = threading.Thread(target=withdraw_worker)
            threads.append(thread)
            thread.start()

        # Wait for all threads to complete
        for thread in threads:
            thread.join()

        return results

    print(&quot;Testing vulnerable wallet...&quot;)
    vulnerable_results = attempt_concurrent_withdrawals(vulnerable_wallet, &#x27;user1&#x27;, 50, 5)
    print(f&quot;Vulnerable wallet successful withdrawals: {sum(vulnerable_results)}&quot;)
    print(f&quot;Vulnerable wallet final balance: {vulnerable_wallet.balances[&#x27;user1&#x27;]}&quot;)

    print(&quot;\nTesting secure wallet...&quot;)
    secure_results = attempt_concurrent_withdrawals(secure_wallet, &#x27;user1&#x27;, 50, 5)
    print(f&quot;Secure wallet successful withdrawals: {sum(secure_results)}&quot;)
    print(f&quot;Secure wallet final balance: {secure_wallet.balances[&#x27;user1&#x27;]}&quot;)

if __name__ == &quot;__main__&quot;:
    demonstrate_race_condition()
</code></pre>
</div>
<h3 id="database-level-race-condition-prevention">Database-Level Race Condition Prevention<a class="headerlink" href="#database-level-race-condition-prevention" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import sqlite3
import threading
from contextlib import contextmanager

class DatabaseTransactionManager:
    &quot;&quot;&quot;Manages database transactions to prevent race conditions&quot;&quot;&quot;

    def __init__(self, db_path):
        self.db_path = db_path
        self.local = threading.local()

    @contextmanager
    def get_connection(self):
        &quot;&quot;&quot;Get database connection with proper isolation&quot;&quot;&quot;
        if not hasattr(self.local, &#x27;connection&#x27;):
            self.local.connection = sqlite3.connect(
                self.db_path,
                isolation_level=None,  # Manual transaction control
                check_same_thread=False
            )
            self.local.connection.execute(&#x27;PRAGMA foreign_keys = ON&#x27;)

        try:
            yield self.local.connection
        finally:
            # Connection cleanup handled by thread-local storage
            pass

    @contextmanager
    def transaction(self):
        &quot;&quot;&quot;Database transaction context manager&quot;&quot;&quot;
        with self.get_connection() as conn:
            try:
                conn.execute(&#x27;BEGIN IMMEDIATE&#x27;)  # Exclusive lock
                yield conn
                conn.execute(&#x27;COMMIT&#x27;)
            except Exception as e:
                conn.execute(&#x27;ROLLBACK&#x27;)
                raise e

    def secure_balance_update(self, user_id, amount_change):
        &quot;&quot;&quot;Update balance with proper locking&quot;&quot;&quot;
        with self.transaction() as conn:
            # Use SELECT FOR UPDATE equivalent (IMMEDIATE transaction)
            cursor = conn.execute(
                &#x27;SELECT balance FROM users WHERE id = ?&#x27;,
                (user_id,)
            )
            row = cursor.fetchone()

            if not row:
                raise ValueError(&quot;User not found&quot;)

            current_balance = row[0]
            new_balance = current_balance + amount_change

            if new_balance &lt; 0:
                raise ValueError(&quot;Insufficient funds&quot;)

            # Update with WHERE clause to ensure row hasn&#x27;t changed
            cursor = conn.execute(
                &#x27;UPDATE users SET balance = ? WHERE id = ? AND balance = ?&#x27;,
                (new_balance, user_id, current_balance)
            )

            if cursor.rowcount == 0:
                raise Exception(&quot;Balance update failed - concurrent modification detected&quot;)

            return new_balance
</code></pre>
</div>
<h2 id="side-channel-attacks">Side-Channel Attacks<a class="headerlink" href="#side-channel-attacks" title="Permanent link">&para;</a></h2>
<h3 id="understanding-side-channel-attacks">Understanding Side-Channel Attacks<a class="headerlink" href="#understanding-side-channel-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Side-channel attacks</strong> exploit information leaked through implementation details rather than vulnerabilities in the algorithm itself. Common side-channels include timing, power consumption, and electromagnetic radiation.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import time
import hmac
import hashlib
import secrets
from typing import Dict, Any

class VulnerableComparison:
    &quot;&quot;&quot;Example of timing attack vulnerability&quot;&quot;&quot;

    def __init__(self):
        self.valid_tokens = {
            &#x27;user1&#x27;: &#x27;secret_token_123&#x27;,
            &#x27;user2&#x27;: &#x27;another_secret_456&#x27;
        }

    def vulnerable_token_check(self, username, provided_token):
        &quot;&quot;&quot;Vulnerable to timing attacks&quot;&quot;&quot;
        if username not in self.valid_tokens:
            return False

        valid_token = self.valid_tokens[username]

        # Vulnerable: early return on first character mismatch
        # Attacker can measure response time to guess characters
        if len(provided_token) != len(valid_token):
            return False

        for i in range(len(valid_token)):
            if provided_token[i] != valid_token[i]:
                return False  # Early return leaks timing information

        return True

    def vulnerable_login(self, username, password):
        &quot;&quot;&quot;Vulnerable login with timing side-channel&quot;&quot;&quot;
        # User enumeration via timing
        if username not in self.valid_tokens:
            # Fast path: no password hashing for invalid users
            return False

        # Slow path: password hashing for valid users
        # This timing difference allows username enumeration
        time.sleep(0.1)  # Simulate password hashing
        return password == &quot;correct_password&quot;

class SecureComparison:
    &quot;&quot;&quot;Secure implementation resistant to timing attacks&quot;&quot;&quot;

    def __init__(self):
        # Store hashed tokens instead of plaintext
        self.user_token_hashes = {
            &#x27;user1&#x27;: hashlib.sha256(b&#x27;secret_token_123&#x27;).hexdigest(),
            &#x27;user2&#x27;: hashlib.sha256(b&#x27;another_secret_456&#x27;).hexdigest()
        }

        self.dummy_user_data = {
            &#x27;password_hash&#x27;: hashlib.sha256(b&#x27;dummy_password&#x27;).hexdigest()
        }

    def secure_token_check(self, username, provided_token):
        &quot;&quot;&quot;Timing-safe token verification&quot;&quot;&quot;
        if username not in self.user_token_hashes:
            # Use dummy comparison to maintain constant time
            dummy_hash = hashlib.sha256(b&#x27;dummy_token&#x27;).hexdigest()
            hmac.compare_digest(dummy_hash, hashlib.sha256(provided_token.encode()).hexdigest())
            return False

        # Always perform hash comparison in constant time
        provided_hash = hashlib.sha256(provided_token.encode()).hexdigest()
        valid_hash = self.user_token_hashes[username]

        return hmac.compare_digest(valid_hash, provided_hash)

    def secure_login(self, username, password):
        &quot;&quot;&quot;Constant-time login to prevent user enumeration&quot;&quot;&quot;
        # Always perform the same operations regardless of user existence
        if username in self.user_token_hashes:
            user_data = {&#x27;password_hash&#x27;: &#x27;actual_hash&#x27;}  # From database
        else:
            user_data = self.dummy_user_data  # Dummy data for timing consistency

        # Always perform password hashing (constant time)
        password_hash = hashlib.sha256(password.encode()).hexdigest()

        # Constant-time comparison
        is_valid = hmac.compare_digest(user_data[&#x27;password_hash&#x27;], password_hash)

        # Only return True if user exists AND password matches
        return username in self.user_token_hashes and is_valid

class TimingAttackDetector:
    &quot;&quot;&quot;Detect potential timing attack attempts&quot;&quot;&quot;

    def __init__(self):
        self.request_times = {}
        self.suspicious_patterns = []

    def record_request(self, client_ip, endpoint, duration):
        &quot;&quot;&quot;Record request timing information&quot;&quot;&quot;
        if client_ip not in self.request_times:
            self.request_times[client_ip] = []

        self.request_times[client_ip].append({
            &#x27;endpoint&#x27;: endpoint,
            &#x27;duration&#x27;: duration,
            &#x27;timestamp&#x27;: time.time()
        })

        # Analyze for suspicious patterns
        self.analyze_timing_patterns(client_ip)

    def analyze_timing_patterns(self, client_ip):
        &quot;&quot;&quot;Analyze request patterns for timing attacks&quot;&quot;&quot;
        requests = self.request_times[client_ip]

        if len(requests) &lt; 10:  # Need sufficient data
            return

        # Check for rapid sequential requests to same endpoint
        recent_requests = [r for r in requests if time.time() - r[&#x27;timestamp&#x27;] &lt; 60]

        if len(recent_requests) &gt; 50:  # Many requests in short time
            endpoint_counts = {}
            for req in recent_requests:
                endpoint = req[&#x27;endpoint&#x27;]
                endpoint_counts[endpoint] = endpoint_counts.get(endpoint, 0) + 1

            # Check if focusing on authentication endpoints
            auth_endpoints = [&#x27;/login&#x27;, &#x27;/verify_token&#x27;, &#x27;/reset_password&#x27;]
            auth_requests = sum(endpoint_counts.get(ep, 0) for ep in auth_endpoints)

            if auth_requests &gt; 30:  # Suspicious authentication activity
                self.suspicious_patterns.append({
                    &#x27;client_ip&#x27;: client_ip,
                    &#x27;pattern&#x27;: &#x27;potential_timing_attack&#x27;,
                    &#x27;auth_requests&#x27;: auth_requests,
                    &#x27;timestamp&#x27;: time.time()
                })

# Secure implementation with monitoring
class SecureAuthenticationService:
    &quot;&quot;&quot;Complete secure authentication service&quot;&quot;&quot;

    def __init__(self):
        self.secure_comparison = SecureComparison()
        self.timing_detector = TimingAttackDetector()
        self.rate_limiter = {}  # Simple rate limiting

    def authenticate(self, username, token, client_ip):
        &quot;&quot;&quot;Secure authentication with monitoring&quot;&quot;&quot;
        start_time = time.time()

        try:
            # Rate limiting
            if self.is_rate_limited(client_ip):
                time.sleep(0.1)  # Constant delay
                return False

            # Perform authentication
            result = self.secure_comparison.secure_token_check(username, token)

            return result

        finally:
            # Record timing information
            duration = time.time() - start_time
            self.timing_detector.record_request(client_ip, &#x27;/authenticate&#x27;, duration)

    def is_rate_limited(self, client_ip):
        &quot;&quot;&quot;Simple rate limiting implementation&quot;&quot;&quot;
        current_time = time.time()

        if client_ip not in self.rate_limiter:
            self.rate_limiter[client_ip] = []

        # Clean old requests
        self.rate_limiter[client_ip] = [
            req_time for req_time in self.rate_limiter[client_ip]
            if current_time - req_time &lt; 60  # Last minute
        ]

        # Check limit
        if len(self.rate_limiter[client_ip]) &gt;= 10:  # 10 requests per minute
            return True

        self.rate_limiter[client_ip].append(current_time)
        return False

# Example usage and demonstration
def demonstrate_timing_attack():
    &quot;&quot;&quot;Demonstrate timing attack vulnerability and mitigation&quot;&quot;&quot;
    vulnerable = VulnerableComparison()
    secure = SecureComparison()

    print(&quot;Demonstrating timing attack vulnerability...&quot;)

    # Measure timing for correct vs incorrect tokens
    def measure_timing(func, *args):
        start = time.time()
        result = func(*args)
        end = time.time()
        return result, end - start

    # Test with vulnerable implementation
    print(&quot;\nVulnerable implementation:&quot;)
    _, time1 = measure_timing(vulnerable.vulnerable_token_check, &#x27;user1&#x27;, &#x27;a&#x27;)
    _, time2 = measure_timing(vulnerable.vulnerable_token_check, &#x27;user1&#x27;, &#x27;secret_token_123&#x27;)

    print(f&quot;Wrong token timing: {time1:.6f}s&quot;)
    print(f&quot;Correct token timing: {time2:.6f}s&quot;)
    print(f&quot;Timing difference: {abs(time2 - time1):.6f}s&quot;)

    # Test with secure implementation
    print(&quot;\nSecure implementation:&quot;)
    _, time3 = measure_timing(secure.secure_token_check, &#x27;user1&#x27;, &#x27;a&#x27;)
    _, time4 = measure_timing(secure.secure_token_check, &#x27;user1&#x27;, &#x27;secret_token_123&#x27;)

    print(f&quot;Wrong token timing: {time3:.6f}s&quot;)
    print(f&quot;Correct token timing: {time4:.6f}s&quot;)
    print(f&quot;Timing difference: {abs(time4 - time3):.6f}s&quot;)

if __name__ == &quot;__main__&quot;:
    demonstrate_timing_attack()
</code></pre>
</div>
<h2 id="comprehensive-web-security-implementation">Comprehensive Web Security Implementation<a class="headerlink" href="#comprehensive-web-security-implementation" title="Permanent link">&para;</a></h2>
<p>Let&rsquo;s create a complete secure web application that addresses all the vulnerabilities discussed:</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from flask import Flask, request, session, jsonify, render_template_string
from flask_talisman import Talisman
import secrets
import time
import threading
from functools import wraps

class SecureWebApplication:
    &quot;&quot;&quot;Complete secure web application implementation&quot;&quot;&quot;

    def __init__(self):
        self.app = Flask(__name__)
        self.setup_security()
        self.setup_routes()

        # Security components
        self.csrf_protection = CSRFProtection(self.app)
        self.authenticator = SecureAuthenticator()
        self.config_manager = SecurityConfigurationManager()
        self.wallet = SecureWallet()
        self.timing_detector = TimingAttackDetector()

        # Apply security configuration
        self.config_manager.configure_secure_flask_app(self.app)

    def setup_security(self):
        &quot;&quot;&quot;Configure application security&quot;&quot;&quot;
        self.app.config.update({
            &#x27;SECRET_KEY&#x27;: secrets.token_hex(32),
            &#x27;SESSION_TIMEOUT&#x27;: 1800,  # 30 minutes
            &#x27;MAX_CONTENT_LENGTH&#x27;: 16 * 1024 * 1024,  # 16MB
        })

        # Security headers
        Talisman(self.app, force_https=False)  # Set to True in production

    def require_auth(self, f):
        &quot;&quot;&quot;Authentication decorator&quot;&quot;&quot;
        @wraps(f)
        def decorated(*args, **kwargs):
            session_id = session.get(&#x27;session_id&#x27;)
            if not session_id:
                return jsonify({&#x27;error&#x27;: &#x27;Authentication required&#x27;}), 401

            try:
                username = self.authenticator.validate_session(
                    session_id, 
                    request.remote_addr,
                    request.user_agent.string
                )
                request.current_user = username
                return f(*args, **kwargs)
            except Exception as e:
                return jsonify({&#x27;error&#x27;: &#x27;Invalid session&#x27;}), 401
        return decorated

    def setup_routes(self):
        &quot;&quot;&quot;Setup secure application routes&quot;&quot;&quot;

        @self.app.route(&#x27;/register&#x27;, methods=[&#x27;POST&#x27;])
        def register():
            start_time = time.time()
            try:
                data = request.get_json()
                if not data or &#x27;username&#x27; not in data or &#x27;password&#x27; not in data:
                    return jsonify({&#x27;error&#x27;: &#x27;Username and password required&#x27;}), 400

                self.authenticator.register_user(data[&#x27;username&#x27;], data[&#x27;password&#x27;])
                return jsonify({&#x27;status&#x27;: &#x27;success&#x27;, &#x27;message&#x27;: &#x27;User registered&#x27;})

            except Exception as e:
                return jsonify({&#x27;error&#x27;: str(e)}), 400

            finally:
                duration = time.time() - start_time
                self.timing_detector.record_request(request.remote_addr, &#x27;/register&#x27;, duration)

        @self.app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])
        def login():
            start_time = time.time()
            try:
                data = request.get_json()
                if not data or &#x27;username&#x27; not in data or &#x27;password&#x27; not in data:
                    return jsonify({&#x27;error&#x27;: &#x27;Username and password required&#x27;}), 400

                session_id = self.authenticator.login(
                    data[&#x27;username&#x27;],
                    data[&#x27;password&#x27;],
                    request.remote_addr
                )

                session[&#x27;session_id&#x27;] = session_id
                return jsonify({&#x27;status&#x27;: &#x27;success&#x27;, &#x27;message&#x27;: &#x27;Login successful&#x27;})

            except Exception as e:
                return jsonify({&#x27;error&#x27;: str(e)}), 401

            finally:
                duration = time.time() - start_time
                self.timing_detector.record_request(request.remote_addr, &#x27;/login&#x27;, duration)

        @self.app.route(&#x27;/logout&#x27;, methods=[&#x27;POST&#x27;])
        @self.require_auth
        def logout():
            session_id = session.get(&#x27;session_id&#x27;)
            if session_id:
                self.authenticator.invalidate_session(session_id)
            session.clear()
            return jsonify({&#x27;status&#x27;: &#x27;success&#x27;, &#x27;message&#x27;: &#x27;Logged out&#x27;})

        @self.app.route(&#x27;/profile&#x27;)
        @self.require_auth
        def profile():
            return jsonify({
                &#x27;username&#x27;: request.current_user,
                &#x27;balance&#x27;: self.wallet.balances[request.current_user]
            })

        @self.app.route(&#x27;/transfer&#x27;, methods=[&#x27;POST&#x27;])
        @self.require_auth
        def transfer():
            # CSRF protection automatically applied
            try:
                data = request.get_json()
                transaction_id = self.wallet.transfer(
                    request.current_user,
                    data[&#x27;to_user&#x27;],
                    float(data[&#x27;amount&#x27;])
                )
                return jsonify({
                    &#x27;status&#x27;: &#x27;success&#x27;,
                    &#x27;transaction_id&#x27;: transaction_id
                })
            except Exception as e:
                return jsonify({&#x27;error&#x27;: str(e)}), 400

        @self.app.route(&#x27;/security_audit&#x27;)
        @self.require_auth  
        def security_audit():
            # Only allow admin users
            if request.current_user != &#x27;admin&#x27;:
                return jsonify({&#x27;error&#x27;: &#x27;Admin access required&#x27;}), 403

            issues = self.config_manager.check_configuration_security(self.app)
            suspicious_patterns = self.timing_detector.suspicious_patterns

            return jsonify({
                &#x27;configuration_issues&#x27;: issues,
                &#x27;suspicious_patterns&#x27;: suspicious_patterns
            })

# Example usage
def create_app():
    &quot;&quot;&quot;Create and configure secure web application&quot;&quot;&quot;
    secure_app = SecureWebApplication()
    return secure_app.app

if __name__ == &quot;__main__&quot;:
    app = create_app()
    app.run(debug=False, host=&#x27;127.0.0.1&#x27;, port=5000)
</code></pre>
</div>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">&para;</a></h2>
<h3 id="web-application-security-principles">Web Application Security Principles<a class="headerlink" href="#web-application-security-principles" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>CSRF Protection</strong>: Always validate state-changing requests with tokens</p>
</li>
<li>
<p><strong>Authentication Security</strong>: Use strong passwords, rate limiting, and secure sessions</p>
</li>
<li>
<p><strong>Configuration Management</strong>: Secure defaults, environment separation, regular audits</p>
</li>
<li>
<p><strong>Concurrency Safety</strong>: Proper locking, atomic operations, transaction management</p>
</li>
<li>
<p><strong>Side-Channel Resistance</strong>: Constant-time operations, timing attack detection</p>
</li>
</ol>
<h3 id="best-practices-summary">Best Practices Summary<a class="headerlink" href="#best-practices-summary" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Defense in Depth</strong>: Layer multiple security controls</p>
</li>
<li>
<p><strong>Secure by Default</strong>: Start with secure configurations</p>
</li>
<li>
<p><strong>Constant-Time Operations</strong>: Prevent timing-based information leakage</p>
</li>
<li>
<p><strong>Proper Error Handling</strong>: Don&rsquo;t leak sensitive information</p>
</li>
<li>
<p><strong>Regular Security Audits</strong>: Continuously assess and improve security posture</p>
</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 15, 2025 07:03:58 UTC">October 15, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 â€“ <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>