
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-02-Privacy-by-Design/">
      
      
        <link rel="prev" href="../16-01-Input-Validation-and-Sanitization/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Content - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-162-privacy-by-design" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> – content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Secure Software Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-14-Security-Foundations/14-01-The-Business-Case-for-Security/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 14 — Security Foundations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-15-Core-Security-Principles/15-01-Security-Fundamentals-CIA-Triad-and-AAA/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 15 — Core Security Principles
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 16 — Input Security and Data Protection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 16 — Input Security and Data Protection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../16-01-Input-Validation-and-Sanitization/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    16.1 Input Validation and Sanitization
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_4_2" id="__nav_3_2_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    16.2 Privacy by Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            16.2 Privacy by Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-privacy-by-design-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Privacy by Design Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-privacy-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Core Privacy Principles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Privacy Principles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-minimization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Minimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-consent-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Consent Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-purpose-limitation-and-data-retention" class="md-nav__link">
    <span class="md-ellipsis">
      3. Purpose Limitation and Data Retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-privacy-impact-assessments" class="md-nav__link">
    <span class="md-ellipsis">
      4. Privacy Impact Assessments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdpr-and-privacy-law-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      GDPR and Privacy Law Fundamentals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-17-System-Security-and-APIs/17-01-Secure-API-Design/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 17 — System Security and APIs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-18-Security-Testing-and-Vulnerabilities/18-01-Security-Testing-Fundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 18 — Security Testing & Vulnerabilities
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-19-Security-in-Context/19-01-Security-in-Development-Teams/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 19 — Security in Context
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareAutomation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-privacy-by-design-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Privacy by Design Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-privacy-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Core Privacy Principles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Privacy Principles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-minimization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Minimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-consent-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Consent Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-purpose-limitation-and-data-retention" class="md-nav__link">
    <span class="md-ellipsis">
      3. Purpose Limitation and Data Retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-privacy-impact-assessments" class="md-nav__link">
    <span class="md-ellipsis">
      4. Privacy Impact Assessments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdpr-and-privacy-law-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      GDPR and Privacy Law Fundamentals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-02-Privacy-by-Design/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-02-Privacy-by-Design/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="section-162-privacy-by-design">Section 16.2: Privacy by Design<a class="headerlink" href="#section-162-privacy-by-design" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this section, you will be able to:</p>
<ul>
<li>
<p><strong>Apply data minimization principles</strong> to collect only necessary personal information</p>
</li>
<li>
<p><strong>Implement consent management systems</strong> that respect user choices and legal requirements</p>
</li>
<li>
<p><strong>Design purpose limitation and data retention</strong> policies that protect user privacy</p>
</li>
<li>
<p><strong>Conduct privacy impact assessments</strong> to identify and mitigate privacy risks</p>
</li>
<li>
<p><strong>Understand GDPR and privacy law fundamentals</strong> and their implications for software design</p>
</li>
</ul>
<h2 id="why-privacy-by-design-matters">Why Privacy by Design Matters<a class="headerlink" href="#why-privacy-by-design-matters" title="Permanent link">&para;</a></h2>
<p>Privacy by Design is a framework that embeds privacy considerations into the design and operation of systems from the ground up. It&rsquo;s not just about compliance with regulations like GDPR—it&rsquo;s about building trust with users and creating sustainable, ethical software systems.</p>
<p><strong>Without Privacy by Design:</strong></p>
<ul>
<li>
<p>User data is collected unnecessarily, creating privacy risks and compliance burdens</p>
</li>
<li>
<p>Data breaches expose more personal information than required for business operations</p>
</li>
<li>
<p>Users lose trust when they discover unexpected data collection or usage</p>
</li>
<li>
<p>Organizations face significant penalties under privacy regulations</p>
</li>
<li>
<p>Technical debt accumulates as privacy requirements are retrofitted</p>
</li>
</ul>
<h2 id="core-privacy-principles">Core Privacy Principles<a class="headerlink" href="#core-privacy-principles" title="Permanent link">&para;</a></h2>
<h3 id="1-data-minimization">1. Data Minimization<a class="headerlink" href="#1-data-minimization" title="Permanent link">&para;</a></h3>
<p><strong>Data minimization</strong> means collecting, processing, and storing only the personal data that is necessary for the specific purpose.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from typing import Dict, List, Optional, Set
from datetime import datetime, timedelta
from enum import Enum
import json

class DataCategory(Enum):
    ESSENTIAL = &quot;essential&quot;  # Required for core functionality
    FUNCTIONAL = &quot;functional&quot;  # Enhances user experience
    ANALYTICS = &quot;analytics&quot;  # For improving services
    MARKETING = &quot;marketing&quot;  # For promotional purposes

class PurposeLimitation(Enum):
    ACCOUNT_MANAGEMENT = &quot;account_management&quot;
    SERVICE_DELIVERY = &quot;service_delivery&quot;
    SECURITY = &quot;security&quot;
    ANALYTICS = &quot;analytics&quot;
    MARKETING = &quot;marketing&quot;
    LEGAL_COMPLIANCE = &quot;legal_compliance&quot;

class DataMinimizationManager:
    def __init__(self):
        # Define what data is necessary for each purpose
        self.purpose_data_mapping = {
            PurposeLimitation.ACCOUNT_MANAGEMENT: {
                &#x27;required&#x27;: [&#x27;username&#x27;, &#x27;email&#x27;, &#x27;password_hash&#x27;],
                &#x27;optional&#x27;: [&#x27;display_name&#x27;, &#x27;timezone&#x27;]
            },
            PurposeLimitation.SERVICE_DELIVERY: {
                &#x27;required&#x27;: [&#x27;user_id&#x27;, &#x27;service_preferences&#x27;],
                &#x27;optional&#x27;: [&#x27;usage_history&#x27;, &#x27;personalization_settings&#x27;]
            },
            PurposeLimitation.SECURITY: {
                &#x27;required&#x27;: [&#x27;login_attempts&#x27;, &#x27;ip_address&#x27;, &#x27;session_data&#x27;],
                &#x27;optional&#x27;: [&#x27;device_fingerprint&#x27;, &#x27;security_questions&#x27;]
            },
            PurposeLimitation.ANALYTICS: {
                &#x27;required&#x27;: [],
                &#x27;optional&#x27;: [&#x27;page_views&#x27;, &#x27;feature_usage&#x27;, &#x27;performance_metrics&#x27;]
            },
            PurposeLimitation.MARKETING: {
                &#x27;required&#x27;: [],
                &#x27;optional&#x27;: [&#x27;communication_preferences&#x27;, &#x27;interest_categories&#x27;]
            }
        }

        # Define data retention periods
        self.retention_periods = {
            DataCategory.ESSENTIAL: timedelta(days=2555),  # 7 years (legal requirement)
            DataCategory.FUNCTIONAL: timedelta(days=365),  # 1 year
            DataCategory.ANALYTICS: timedelta(days=90),    # 3 months
            DataCategory.MARKETING: timedelta(days=730)    # 2 years
        }

    def validate_data_collection(self, requested_data: Dict[str, any], 
                                purpose: PurposeLimitation) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Validate that data collection adheres to minimization principles&quot;&quot;&quot;

        if purpose not in self.purpose_data_mapping:
            return {
                &#x27;is_valid&#x27;: False,
                &#x27;error&#x27;: f&quot;Unknown purpose: {purpose}&quot;,
                &#x27;allowed_data&#x27;: {},
                &#x27;rejected_data&#x27;: requested_data
            }

        allowed_fields = self.purpose_data_mapping[purpose]
        required_fields = set(allowed_fields[&#x27;required&#x27;])
        optional_fields = set(allowed_fields[&#x27;optional&#x27;])
        all_allowed = required_fields.union(optional_fields)

        # Separate allowed and rejected data
        allowed_data = {}
        rejected_data = {}
        missing_required = []

        for field, value in requested_data.items():
            if field in all_allowed:
                allowed_data[field] = value
            else:
                rejected_data[field] = value

        # Check for missing required fields
        for required_field in required_fields:
            if required_field not in requested_data:
                missing_required.append(required_field)

        is_valid = len(rejected_data) == 0 and len(missing_required) == 0

        return {
            &#x27;is_valid&#x27;: is_valid,
            &#x27;allowed_data&#x27;: allowed_data,
            &#x27;rejected_data&#x27;: rejected_data,
            &#x27;missing_required&#x27;: missing_required,
            &#x27;purpose&#x27;: purpose.value,
            &#x27;minimization_applied&#x27;: len(rejected_data) &gt; 0
        }

    def create_privacy_compliant_user_profile(self, user_data: Dict[str, any], 
                                            purposes: List[PurposeLimitation]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Create user profile that only includes data needed for specified purposes&quot;&quot;&quot;

        all_allowed_data = {}
        collection_log = []

        for purpose in purposes:
            validation_result = self.validate_data_collection(user_data, purpose)

            # Merge allowed data
            all_allowed_data.update(validation_result[&#x27;allowed_data&#x27;])

            # Log collection rationale
            collection_log.append({
                &#x27;purpose&#x27;: purpose.value,
                &#x27;fields_collected&#x27;: list(validation_result[&#x27;allowed_data&#x27;].keys()),
                &#x27;fields_rejected&#x27;: list(validation_result[&#x27;rejected_data&#x27;].keys()),
                &#x27;timestamp&#x27;: datetime.now().isoformat()
            })

        return {
            &#x27;user_profile&#x27;: all_allowed_data,
            &#x27;collection_rationale&#x27;: collection_log,
            &#x27;data_categories&#x27;: self._categorize_collected_data(all_allowed_data),
            &#x27;retention_schedule&#x27;: self._calculate_retention_schedule(all_allowed_data)
        }

    def _categorize_collected_data(self, collected_data: Dict[str, any]) -&gt; Dict[str, List[str]]:
        &quot;&quot;&quot;Categorize collected data by privacy impact&quot;&quot;&quot;

        # Define data categories based on privacy sensitivity
        categorization = {
            DataCategory.ESSENTIAL.value: [],
            DataCategory.FUNCTIONAL.value: [],
            DataCategory.ANALYTICS.value: [],
            DataCategory.MARKETING.value: []
        }

        essential_fields = [&#x27;username&#x27;, &#x27;email&#x27;, &#x27;password_hash&#x27;, &#x27;user_id&#x27;]
        functional_fields = [&#x27;display_name&#x27;, &#x27;timezone&#x27;, &#x27;service_preferences&#x27;, &#x27;personalization_settings&#x27;]
        analytics_fields = [&#x27;page_views&#x27;, &#x27;feature_usage&#x27;, &#x27;performance_metrics&#x27;, &#x27;usage_history&#x27;]
        marketing_fields = [&#x27;communication_preferences&#x27;, &#x27;interest_categories&#x27;]

        for field in collected_data.keys():
            if field in essential_fields:
                categorization[DataCategory.ESSENTIAL.value].append(field)
            elif field in functional_fields:
                categorization[DataCategory.FUNCTIONAL.value].append(field)
            elif field in analytics_fields:
                categorization[DataCategory.ANALYTICS.value].append(field)
            elif field in marketing_fields:
                categorization[DataCategory.MARKETING.value].append(field)
            else:
                # Default to functional if not categorized
                categorization[DataCategory.FUNCTIONAL.value].append(field)

        return categorization

    def _calculate_retention_schedule(self, collected_data: Dict[str, any]) -&gt; Dict[str, str]:
        &quot;&quot;&quot;Calculate when each piece of data should be deleted&quot;&quot;&quot;

        categorized_data = self._categorize_collected_data(collected_data)
        retention_schedule = {}

        for category, fields in categorized_data.items():
            if fields:  # Only process non-empty categories
                category_enum = DataCategory(category)
                retention_period = self.retention_periods[category_enum]
                deletion_date = (datetime.now() + retention_period).isoformat()

                for field in fields:
                    retention_schedule[field] = deletion_date

        return retention_schedule

# Demonstration of data minimization
def demonstrate_data_minimization():
    &quot;&quot;&quot;Demonstrate data minimization in practice&quot;&quot;&quot;

    print(&quot;=== Data Minimization Demo ===&quot;)

    minimizer = DataMinimizationManager()

    # Simulate user registration form with excessive data collection
    excessive_user_data = {
        &#x27;username&#x27;: &#x27;student123&#x27;,
        &#x27;email&#x27;: &#x27;student@school.edu&#x27;,
        &#x27;password_hash&#x27;: &#x27;hashed_password&#x27;,
        &#x27;first_name&#x27;: &#x27;Alice&#x27;,
        &#x27;last_name&#x27;: &#x27;Johnson&#x27;,
        &#x27;phone_number&#x27;: &#x27;+1234567890&#x27;,
        &#x27;address&#x27;: &#x27;123 Main St, City, State&#x27;,
        &#x27;date_of_birth&#x27;: &#x27;2005-01-15&#x27;,
        &#x27;social_security_number&#x27;: &#x27;123-45-6789&#x27;,  # Excessive!
        &#x27;emergency_contact&#x27;: &#x27;Parent Name&#x27;,
        &#x27;medical_conditions&#x27;: &#x27;None&#x27;,  # Excessive!
        &#x27;favorite_color&#x27;: &#x27;Blue&#x27;,  # Excessive!
        &#x27;display_name&#x27;: &#x27;Alice J&#x27;,
        &#x27;timezone&#x27;: &#x27;UTC-5&#x27;
    }

    print(&quot;Original registration data fields:&quot;, len(excessive_user_data))
    print(&quot;Fields:&quot;, list(excessive_user_data.keys()))

    # Apply data minimization for account management only
    purposes = [PurposeLimitation.ACCOUNT_MANAGEMENT]

    privacy_compliant_profile = minimizer.create_privacy_compliant_user_profile(
        excessive_user_data, purposes
    )

    print(f&quot;\nAfter data minimization for {[p.value for p in purposes]}:&quot;)
    print(&quot;Collected fields:&quot;, len(privacy_compliant_profile[&#x27;user_profile&#x27;]))
    print(&quot;Fields:&quot;, list(privacy_compliant_profile[&#x27;user_profile&#x27;].keys()))

    print(&quot;\nCollection rationale:&quot;)
    for log_entry in privacy_compliant_profile[&#x27;collection_rationale&#x27;]:
        print(f&quot;  Purpose: {log_entry[&#x27;purpose&#x27;]}&quot;)
        print(f&quot;  Collected: {log_entry[&#x27;fields_collected&#x27;]}&quot;)
        print(f&quot;  Rejected: {log_entry[&#x27;fields_rejected&#x27;]}&quot;)
        print()

    print(&quot;Data categories:&quot;)
    for category, fields in privacy_compliant_profile[&#x27;data_categories&#x27;].items():
        if fields:
            print(f&quot;  {category}: {fields}&quot;)

    # Demonstrate adding more purposes
    print(&quot;\n=== Adding Service Delivery Purpose ===&quot;)

    extended_purposes = [
        PurposeLimitation.ACCOUNT_MANAGEMENT,
        PurposeLimitation.SERVICE_DELIVERY
    ]

    extended_profile = minimizer.create_privacy_compliant_user_profile(
        excessive_user_data, extended_purposes
    )

    print(&quot;Extended collection fields:&quot;, list(extended_profile[&#x27;user_profile&#x27;].keys()))
    print(&quot;Still rejected excessive fields like SSN, medical conditions, favorite color&quot;)
</code></pre>
</div>
<h3 id="2-consent-management">2. Consent Management<a class="headerlink" href="#2-consent-management" title="Permanent link">&para;</a></h3>
<p><strong>Consent management</strong> ensures users have control over how their personal data is collected and used.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from datetime import datetime, timedelta
from typing import Dict, List, Optional
import uuid

class ConsentType(Enum):
    NECESSARY = &quot;necessary&quot;  # Required for service
    FUNCTIONAL = &quot;functional&quot;  # Enhances experience
    ANALYTICS = &quot;analytics&quot;  # Service improvement
    MARKETING = &quot;marketing&quot;  # Promotional communications
    PERSONALIZATION = &quot;personalization&quot;  # Customized content

class ConsentStatus(Enum):
    GRANTED = &quot;granted&quot;
    DENIED = &quot;denied&quot;
    WITHDRAWN = &quot;withdrawn&quot;
    EXPIRED = &quot;expired&quot;

class ConsentRecord:
    def __init__(self, consent_type: ConsentType, status: ConsentStatus, 
                 user_id: str, ip_address: str = &quot;unknown&quot;, user_agent: str = &quot;unknown&quot;):
        self.consent_id = str(uuid.uuid4())
        self.consent_type = consent_type
        self.status = status
        self.user_id = user_id
        self.timestamp = datetime.now()
        self.ip_address = ip_address
        self.user_agent = user_agent
        self.expiry_date = self._calculate_expiry()
        self.withdrawal_date = None

    def _calculate_expiry(self) -&gt; datetime:
        &quot;&quot;&quot;Calculate when consent expires (typically 12 months)&quot;&quot;&quot;
        return self.timestamp + timedelta(days=365)

    def is_valid(self) -&gt; bool:
        &quot;&quot;&quot;Check if consent is currently valid&quot;&quot;&quot;
        if self.status in [ConsentStatus.DENIED, ConsentStatus.WITHDRAWN]:
            return False

        if datetime.now() &gt; self.expiry_date:
            self.status = ConsentStatus.EXPIRED
            return False

        return True

    def withdraw(self) -&gt; bool:
        &quot;&quot;&quot;Withdraw consent&quot;&quot;&quot;
        if self.status == ConsentStatus.GRANTED:
            self.status = ConsentStatus.WITHDRAWN
            self.withdrawal_date = datetime.now()
            return True
        return False

class ConsentManager:
    def __init__(self):
        self.consent_records: Dict[str, List[ConsentRecord]] = {}

        # Define what each consent type enables
        self.consent_capabilities = {
            ConsentType.NECESSARY: {
                &#x27;description&#x27;: &#x27;Essential for basic service functionality&#x27;,
                &#x27;can_opt_out&#x27;: False,
                &#x27;data_types&#x27;: [&#x27;account_data&#x27;, &#x27;security_logs&#x27;, &#x27;essential_preferences&#x27;],
                &#x27;processing_activities&#x27;: [&#x27;authentication&#x27;, &#x27;service_delivery&#x27;, &#x27;security&#x27;]
            },
            ConsentType.FUNCTIONAL: {
                &#x27;description&#x27;: &#x27;Enhances your experience with additional features&#x27;,
                &#x27;can_opt_out&#x27;: True,
                &#x27;data_types&#x27;: [&#x27;usage_preferences&#x27;, &#x27;ui_customizations&#x27;, &#x27;feature_settings&#x27;],
                &#x27;processing_activities&#x27;: [&#x27;personalization&#x27;, &#x27;feature_enhancement&#x27;]
            },
            ConsentType.ANALYTICS: {
                &#x27;description&#x27;: &#x27;Helps us improve our services through usage analysis&#x27;,
                &#x27;can_opt_out&#x27;: True,
                &#x27;data_types&#x27;: [&#x27;page_views&#x27;, &#x27;feature_usage&#x27;, &#x27;performance_data&#x27;],
                &#x27;processing_activities&#x27;: [&#x27;service_improvement&#x27;, &#x27;bug_detection&#x27;, &#x27;optimization&#x27;]
            },
            ConsentType.MARKETING: {
                &#x27;description&#x27;: &#x27;Allows us to send you promotional communications&#x27;,
                &#x27;can_opt_out&#x27;: True,
                &#x27;data_types&#x27;: [&#x27;communication_preferences&#x27;, &#x27;interest_data&#x27;],
                &#x27;processing_activities&#x27;: [&#x27;email_marketing&#x27;, &#x27;targeted_communications&#x27;]
            },
            ConsentType.PERSONALIZATION: {
                &#x27;description&#x27;: &#x27;Enables customized content and recommendations&#x27;,
                &#x27;can_opt_out&#x27;: True,
                &#x27;data_types&#x27;: [&#x27;behavior_patterns&#x27;, &#x27;preferences&#x27;, &#x27;interaction_history&#x27;],
                &#x27;processing_activities&#x27;: [&#x27;content_customization&#x27;, &#x27;recommendations&#x27;]
            }
        }

    def request_consent(self, user_id: str, consent_types: List[ConsentType], 
                       ip_address: str = &quot;unknown&quot;, user_agent: str = &quot;unknown&quot;) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Request consent from user with clear information&quot;&quot;&quot;

        consent_request = {
            &#x27;request_id&#x27;: str(uuid.uuid4()),
            &#x27;user_id&#x27;: user_id,
            &#x27;timestamp&#x27;: datetime.now().isoformat(),
            &#x27;consent_options&#x27;: []
        }

        for consent_type in consent_types:
            if consent_type in self.consent_capabilities:
                capability = self.consent_capabilities[consent_type]

                consent_option = {
                    &#x27;consent_type&#x27;: consent_type.value,
                    &#x27;description&#x27;: capability[&#x27;description&#x27;],
                    &#x27;can_opt_out&#x27;: capability[&#x27;can_opt_out&#x27;],
                    &#x27;data_types&#x27;: capability[&#x27;data_types&#x27;],
                    &#x27;processing_activities&#x27;: capability[&#x27;processing_activities&#x27;],
                    &#x27;is_required&#x27;: not capability[&#x27;can_opt_out&#x27;]
                }

                consent_request[&#x27;consent_options&#x27;].append(consent_option)

        return consent_request

    def record_consent_decision(self, user_id: str, consent_decisions: Dict[ConsentType, bool],
                              ip_address: str = &quot;unknown&quot;, user_agent: str = &quot;unknown&quot;) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Record user&#x27;s consent decisions&quot;&quot;&quot;

        if user_id not in self.consent_records:
            self.consent_records[user_id] = []

        recorded_consents = []
        validation_errors = []

        for consent_type, granted in consent_decisions.items():
            # Check if this is a required consent that was denied
            if not granted and not self.consent_capabilities[consent_type][&#x27;can_opt_out&#x27;]:
                validation_errors.append(f&quot;Cannot deny required consent: {consent_type.value}&quot;)
                continue

            # Create consent record
            status = ConsentStatus.GRANTED if granted else ConsentStatus.DENIED
            consent_record = ConsentRecord(consent_type, status, user_id, ip_address, user_agent)

            # Withdraw any previous consent for this type
            self._withdraw_previous_consent(user_id, consent_type)

            # Store new consent
            self.consent_records[user_id].append(consent_record)
            recorded_consents.append({
                &#x27;consent_id&#x27;: consent_record.consent_id,
                &#x27;consent_type&#x27;: consent_type.value,
                &#x27;status&#x27;: status.value,
                &#x27;expiry_date&#x27;: consent_record.expiry_date.isoformat()
            })

        return {
            &#x27;success&#x27;: len(validation_errors) == 0,
            &#x27;recorded_consents&#x27;: recorded_consents,
            &#x27;validation_errors&#x27;: validation_errors,
            &#x27;processing_lawful_basis&#x27;: self._determine_lawful_basis(user_id)
        }

    def check_consent(self, user_id: str, consent_type: ConsentType) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Check if user has given valid consent for specific processing&quot;&quot;&quot;

        if user_id not in self.consent_records:
            return {
                &#x27;has_consent&#x27;: False,
                &#x27;reason&#x27;: &#x27;No consent records found&#x27;,
                &#x27;can_process&#x27;: False
            }

        # Find most recent consent for this type
        user_consents = self.consent_records[user_id]
        relevant_consents = [c for c in user_consents if c.consent_type == consent_type]

        if not relevant_consents:
            # Check if this is necessary processing
            if consent_type == ConsentType.NECESSARY:
                return {
                    &#x27;has_consent&#x27;: True,
                    &#x27;reason&#x27;: &#x27;Necessary for service delivery&#x27;,
                    &#x27;can_process&#x27;: True,
                    &#x27;lawful_basis&#x27;: &#x27;legitimate_interest&#x27;
                }
            return {
                &#x27;has_consent&#x27;: False,
                &#x27;reason&#x27;: &#x27;No consent given for this type&#x27;,
                &#x27;can_process&#x27;: False
            }

        # Get most recent consent
        latest_consent = max(relevant_consents, key=lambda c: c.timestamp)

        if latest_consent.is_valid():
            return {
                &#x27;has_consent&#x27;: True,
                &#x27;consent_id&#x27;: latest_consent.consent_id,
                &#x27;granted_date&#x27;: latest_consent.timestamp.isoformat(),
                &#x27;expiry_date&#x27;: latest_consent.expiry_date.isoformat(),
                &#x27;can_process&#x27;: True,
                &#x27;lawful_basis&#x27;: &#x27;consent&#x27;
            }
        else:
            return {
                &#x27;has_consent&#x27;: False,
                &#x27;reason&#x27;: f&#x27;Consent {latest_consent.status.value}&#x27;,
                &#x27;can_process&#x27;: consent_type == ConsentType.NECESSARY,
                &#x27;lawful_basis&#x27;: &#x27;legitimate_interest&#x27; if consent_type == ConsentType.NECESSARY else None
            }

    def withdraw_consent(self, user_id: str, consent_type: ConsentType) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Allow user to withdraw consent&quot;&quot;&quot;

        if consent_type == ConsentType.NECESSARY:
            return {
                &#x27;success&#x27;: False,
                &#x27;error&#x27;: &#x27;Cannot withdraw consent for necessary processing&#x27;,
                &#x27;alternative&#x27;: &#x27;You can delete your account if you wish to stop all processing&#x27;
            }

        withdrawal_result = self._withdraw_previous_consent(user_id, consent_type)

        if withdrawal_result:
            return {
                &#x27;success&#x27;: True,
                &#x27;message&#x27;: f&#x27;Consent withdrawn for {consent_type.value}&#x27;,
                &#x27;data_processing_stopped&#x27;: True,
                &#x27;data_deletion_scheduled&#x27;: True
            }
        else:
            return {
                &#x27;success&#x27;: False,
                &#x27;error&#x27;: &#x27;No active consent found to withdraw&#x27;
            }

    def get_consent_dashboard(self, user_id: str) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Provide user with overview of their consent status&quot;&quot;&quot;

        if user_id not in self.consent_records:
            return {
                &#x27;user_id&#x27;: user_id,
                &#x27;consent_status&#x27;: {},
                &#x27;data_processing_activities&#x27;: [],
                &#x27;withdrawal_options&#x27;: []
            }

        consent_status = {}
        processing_activities = []
        withdrawal_options = []

        for consent_type in ConsentType:
            check_result = self.check_consent(user_id, consent_type)
            consent_status[consent_type.value] = {
                &#x27;has_consent&#x27;: check_result[&#x27;has_consent&#x27;],
                &#x27;can_process&#x27;: check_result[&#x27;can_process&#x27;],
                &#x27;reason&#x27;: check_result.get(&#x27;reason&#x27;, &#x27;&#x27;),
                &#x27;expiry_date&#x27;: check_result.get(&#x27;expiry_date&#x27;, &#x27;&#x27;)
            }

            if check_result[&#x27;can_process&#x27;]:
                capability = self.consent_capabilities[consent_type]
                processing_activities.extend(capability[&#x27;processing_activities&#x27;])

            if consent_type != ConsentType.NECESSARY and check_result[&#x27;has_consent&#x27;]:
                withdrawal_options.append({
                    &#x27;consent_type&#x27;: consent_type.value,
                    &#x27;description&#x27;: self.consent_capabilities[consent_type][&#x27;description&#x27;]
                })

        return {
            &#x27;user_id&#x27;: user_id,
            &#x27;consent_status&#x27;: consent_status,
            &#x27;data_processing_activities&#x27;: list(set(processing_activities)),
            &#x27;withdrawal_options&#x27;: withdrawal_options,
            &#x27;last_updated&#x27;: datetime.now().isoformat()
        }

    def _withdraw_previous_consent(self, user_id: str, consent_type: ConsentType) -&gt; bool:
        &quot;&quot;&quot;Withdraw any existing consent for the specified type&quot;&quot;&quot;

        if user_id not in self.consent_records:
            return False

        user_consents = self.consent_records[user_id]
        relevant_consents = [c for c in user_consents if c.consent_type == consent_type]

        withdrawal_count = 0
        for consent in relevant_consents:
            if consent.status == ConsentStatus.GRANTED:
                consent.withdraw()
                withdrawal_count += 1

        return withdrawal_count &gt; 0

    def _determine_lawful_basis(self, user_id: str) -&gt; Dict[ConsentType, str]:
        &quot;&quot;&quot;Determine lawful basis for processing under GDPR&quot;&quot;&quot;

        lawful_basis = {}

        for consent_type in ConsentType:
            check_result = self.check_consent(user_id, consent_type)

            if consent_type == ConsentType.NECESSARY:
                lawful_basis[consent_type] = &quot;legitimate_interest&quot;
            elif check_result[&#x27;has_consent&#x27;]:
                lawful_basis[consent_type] = &quot;consent&quot;
            else:
                lawful_basis[consent_type] = &quot;none&quot;

        return lawful_basis

# Demonstration of consent management
def demonstrate_consent_management():
    &quot;&quot;&quot;Demonstrate comprehensive consent management&quot;&quot;&quot;

    print(&quot;=== Consent Management Demo ===&quot;)

    consent_manager = ConsentManager()
    user_id = &quot;student_12345&quot;

    # Step 1: Request consent from user
    print(&quot;1. Requesting consent from user...&quot;)

    consent_request = consent_manager.request_consent(
        user_id,
        [ConsentType.NECESSARY, ConsentType.FUNCTIONAL, ConsentType.ANALYTICS, ConsentType.MARKETING],
        &quot;192.168.1.100&quot;,
        &quot;Mozilla/5.0 Student Browser&quot;
    )

    print(f&quot;Consent request ID: {consent_request[&#x27;request_id&#x27;]}&quot;)
    print(&quot;Available consent options:&quot;)
    for option in consent_request[&#x27;consent_options&#x27;]:
        required = &quot; (REQUIRED)&quot; if option[&#x27;is_required&#x27;] else &quot; (OPTIONAL)&quot;
        print(f&quot;  {option[&#x27;consent_type&#x27;]}{required}: {option[&#x27;description&#x27;]}&quot;)

    # Step 2: User makes consent decisions
    print(&quot;\n2. User consent decisions...&quot;)

    user_decisions = {
        ConsentType.NECESSARY: True,    # Required
        ConsentType.FUNCTIONAL: True,   # User chooses yes
        ConsentType.ANALYTICS: True,    # User chooses yes
        ConsentType.MARKETING: False    # User chooses no
    }

    decision_result = consent_manager.record_consent_decision(
        user_id, user_decisions, &quot;192.168.1.100&quot;, &quot;Mozilla/5.0 Student Browser&quot;
    )

    print(f&quot;Consent recording successful: {decision_result[&#x27;success&#x27;]}&quot;)
    print(&quot;Recorded consents:&quot;)
    for consent in decision_result[&#x27;recorded_consents&#x27;]:
        print(f&quot;  {consent[&#x27;consent_type&#x27;]}: {consent[&#x27;status&#x27;]}&quot;)

    # Step 3: Check consent before processing
    print(&quot;\n3. Checking consent before data processing...&quot;)

    processing_scenarios = [
        (ConsentType.NECESSARY, &quot;User authentication&quot;),
        (ConsentType.FUNCTIONAL, &quot;UI customization&quot;),
        (ConsentType.ANALYTICS, &quot;Usage tracking&quot;),
        (ConsentType.MARKETING, &quot;Promotional emails&quot;)
    ]

    for consent_type, activity in processing_scenarios:
        check_result = consent_manager.check_consent(user_id, consent_type)
        status = &quot;✅ ALLOWED&quot; if check_result[&#x27;can_process&#x27;] else &quot;❌ BLOCKED&quot;
        print(f&quot;  {activity}: {status}&quot;)
        if not check_result[&#x27;can_process&#x27;]:
            print(f&quot;    Reason: {check_result[&#x27;reason&#x27;]}&quot;)

    # Step 4: User consent dashboard
    print(&quot;\n4. User consent dashboard...&quot;)

    dashboard = consent_manager.get_consent_dashboard(user_id)

    print(&quot;Current consent status:&quot;)
    for consent_type, status in dashboard[&#x27;consent_status&#x27;].items():
        indicator = &quot;✅&quot; if status[&#x27;has_consent&#x27;] else &quot;❌&quot;
        print(f&quot;  {indicator} {consent_type}: {status[&#x27;reason&#x27;]}&quot;)

    print(f&quot;\nActive processing activities: {dashboard[&#x27;data_processing_activities&#x27;]}&quot;)

    # Step 5: Withdraw consent
    print(&quot;\n5. Withdrawing marketing consent...&quot;)

    # Note: User already denied marketing, but let&#x27;s try withdrawing analytics
    withdrawal_result = consent_manager.withdraw_consent(user_id, ConsentType.ANALYTICS)
    print(f&quot;Withdrawal successful: {withdrawal_result[&#x27;success&#x27;]}&quot;)

    if withdrawal_result[&#x27;success&#x27;]:
        print(f&quot;Message: {withdrawal_result[&#x27;message&#x27;]}&quot;)

        # Check processing after withdrawal
        updated_check = consent_manager.check_consent(user_id, ConsentType.ANALYTICS)
        print(f&quot;Analytics processing now allowed: {updated_check[&#x27;can_process&#x27;]}&quot;)
</code></pre>
</div>
<h3 id="3-purpose-limitation-and-data-retention">3. Purpose Limitation and Data Retention<a class="headerlink" href="#3-purpose-limitation-and-data-retention" title="Permanent link">&para;</a></h3>
<p><strong>Purpose limitation</strong> ensures data is only used for the purposes it was collected for, and <strong>data retention</strong> policies ensure data is not kept longer than necessary.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from datetime import datetime, timedelta
from typing import Dict, List, Optional
from enum import Enum
import json

class RetentionPolicy:
    def __init__(self, policy_id: str, data_category: str, 
                 retention_period: timedelta, legal_basis: str):
        self.policy_id = policy_id
        self.data_category = data_category
        self.retention_period = retention_period
        self.legal_basis = legal_basis
        self.created_date = datetime.now()

    def calculate_deletion_date(self, collection_date: datetime) -&gt; datetime:
        &quot;&quot;&quot;Calculate when data should be deleted&quot;&quot;&quot;
        return collection_date + self.retention_period

    def is_deletion_due(self, collection_date: datetime) -&gt; bool:
        &quot;&quot;&quot;Check if data should be deleted now&quot;&quot;&quot;
        deletion_date = self.calculate_deletion_date(collection_date)
        return datetime.now() &gt;= deletion_date

class DataRetentionManager:
    def __init__(self):
        # Define retention policies for different data types
        self.retention_policies = {
            &#x27;account_data&#x27;: RetentionPolicy(
                &#x27;account_001&#x27;,
                &#x27;account_data&#x27;,
                timedelta(days=2555),  # 7 years (legal requirement)
                &#x27;Legal obligation - financial records retention&#x27;
            ),
            &#x27;usage_analytics&#x27;: RetentionPolicy(
                &#x27;analytics_001&#x27;,
                &#x27;usage_analytics&#x27;,
                timedelta(days=90),  # 3 months
                &#x27;Legitimate interest - service improvement&#x27;
            ),
            &#x27;marketing_data&#x27;: RetentionPolicy(
                &#x27;marketing_001&#x27;,
                &#x27;marketing_data&#x27;,
                timedelta(days=730),  # 2 years
                &#x27;Consent - promotional communications&#x27;
            ),
            &#x27;security_logs&#x27;: RetentionPolicy(
                &#x27;security_001&#x27;,
                &#x27;security_logs&#x27;,
                timedelta(days=180),  # 6 months
                &#x27;Legitimate interest - security monitoring&#x27;
            ),
            &#x27;session_data&#x27;: RetentionPolicy(
                &#x27;session_001&#x27;,
                &#x27;session_data&#x27;,
                timedelta(hours=24),  # 24 hours
                &#x27;Legitimate interest - service delivery&#x27;
            ),
            &#x27;support_tickets&#x27;: RetentionPolicy(
                &#x27;support_001&#x27;,
                &#x27;support_tickets&#x27;,
                timedelta(days=1095),  # 3 years
                &#x27;Legitimate interest - customer service&#x27;
            )
        }

        # Track data collection and purposes
        self.data_inventory = {}

    def record_data_collection(self, user_id: str, data_type: str, 
                             purpose: PurposeLimitation, data_content: Dict[str, any]) -&gt; str:
        &quot;&quot;&quot;Record when data is collected and for what purpose&quot;&quot;&quot;

        record_id = f&quot;{user_id}_{data_type}_{datetime.now().timestamp()}&quot;

        if user_id not in self.data_inventory:
            self.data_inventory[user_id] = []

        collection_record = {
            &#x27;record_id&#x27;: record_id,
            &#x27;user_id&#x27;: user_id,
            &#x27;data_type&#x27;: data_type,
            &#x27;purpose&#x27;: purpose.value,
            &#x27;collection_date&#x27;: datetime.now(),
            &#x27;data_fields&#x27;: list(data_content.keys()),
            &#x27;retention_policy&#x27;: self.retention_policies.get(data_type),
            &#x27;deletion_scheduled&#x27;: False,
            &#x27;deleted&#x27;: False
        }

        self.data_inventory[user_id].append(collection_record)

        return record_id

    def check_purpose_compliance(self, user_id: str, data_type: str, 
                               requested_purpose: PurposeLimitation) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Check if data can be used for the requested purpose&quot;&quot;&quot;

        if user_id not in self.data_inventory:
            return {
                &#x27;compliant&#x27;: False,
                &#x27;reason&#x27;: &#x27;No data records found for user&#x27;
            }

        user_records = self.data_inventory[user_id]
        relevant_records = [r for r in user_records if r[&#x27;data_type&#x27;] == data_type and not r[&#x27;deleted&#x27;]]

        if not relevant_records:
            return {
                &#x27;compliant&#x27;: False,
                &#x27;reason&#x27;: f&#x27;No active {data_type} records found&#x27;
            }

        # Check if any record allows this purpose
        allowed_purposes = []
        for record in relevant_records:
            original_purpose = PurposeLimitation(record[&#x27;purpose&#x27;])
            allowed_purposes.append(original_purpose)

            # Define compatible purposes
            compatible_purposes = self._get_compatible_purposes(original_purpose)

            if requested_purpose in compatible_purposes:
                return {
                    &#x27;compliant&#x27;: True,
                    &#x27;original_purpose&#x27;: original_purpose.value,
                    &#x27;requested_purpose&#x27;: requested_purpose.value,
                    &#x27;record_id&#x27;: record[&#x27;record_id&#x27;]
                }

        return {
            &#x27;compliant&#x27;: False,
            &#x27;reason&#x27;: f&#x27;Purpose {requested_purpose.value} not compatible with collection purposes: {[p.value for p in allowed_purposes]}&#x27;
        }

    def schedule_data_deletion(self, user_id: str = None) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Schedule data for deletion based on retention policies&quot;&quot;&quot;

        deletion_schedule = []

        users_to_check = [user_id] if user_id else self.data_inventory.keys()

        for uid in users_to_check:
            if uid not in self.data_inventory:
                continue

            user_records = self.data_inventory[uid]

            for record in user_records:
                if record[&#x27;deleted&#x27;] or record[&#x27;deletion_scheduled&#x27;]:
                    continue

                retention_policy = record[&#x27;retention_policy&#x27;]
                if retention_policy and retention_policy.is_deletion_due(record[&#x27;collection_date&#x27;]):
                    record[&#x27;deletion_scheduled&#x27;] = True

                    deletion_schedule.append({
                        &#x27;user_id&#x27;: uid,
                        &#x27;record_id&#x27;: record[&#x27;record_id&#x27;],
                        &#x27;data_type&#x27;: record[&#x27;data_type&#x27;],
                        &#x27;collection_date&#x27;: record[&#x27;collection_date&#x27;].isoformat(),
                        &#x27;deletion_due_date&#x27;: retention_policy.calculate_deletion_date(record[&#x27;collection_date&#x27;]).isoformat(),
                        &#x27;legal_basis&#x27;: retention_policy.legal_basis
                    })

        return {
            &#x27;deletion_scheduled_count&#x27;: len(deletion_schedule),
            &#x27;deletion_schedule&#x27;: deletion_schedule
        }

    def execute_data_deletion(self, record_ids: List[str]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Execute scheduled data deletions&quot;&quot;&quot;

        deleted_records = []
        not_found_records = []

        for record_id in record_ids:
            found = False

            for user_id, user_records in self.data_inventory.items():
                for record in user_records:
                    if record[&#x27;record_id&#x27;] == record_id and record[&#x27;deletion_scheduled&#x27;]:
                        record[&#x27;deleted&#x27;] = True
                        record[&#x27;deletion_date&#x27;] = datetime.now()

                        deleted_records.append({
                            &#x27;record_id&#x27;: record_id,
                            &#x27;user_id&#x27;: user_id,
                            &#x27;data_type&#x27;: record[&#x27;data_type&#x27;],
                            &#x27;deletion_date&#x27;: record[&#x27;deletion_date&#x27;].isoformat()
                        })

                        found = True
                        break

                if found:
                    break

            if not found:
                not_found_records.append(record_id)

        return {
            &#x27;deleted_count&#x27;: len(deleted_records),
            &#x27;deleted_records&#x27;: deleted_records,
            &#x27;not_found_records&#x27;: not_found_records
        }

    def get_data_inventory_report(self, user_id: str) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Generate data inventory report for user&quot;&quot;&quot;

        if user_id not in self.data_inventory:
            return {
                &#x27;user_id&#x27;: user_id,
                &#x27;total_records&#x27;: 0,
                &#x27;active_records&#x27;: [],
                &#x27;scheduled_deletions&#x27;: [],
                &#x27;deleted_records&#x27;: []
            }

        user_records = self.data_inventory[user_id]

        active_records = []
        scheduled_deletions = []
        deleted_records = []

        for record in user_records:
            record_summary = {
                &#x27;record_id&#x27;: record[&#x27;record_id&#x27;],
                &#x27;data_type&#x27;: record[&#x27;data_type&#x27;],
                &#x27;purpose&#x27;: record[&#x27;purpose&#x27;],
                &#x27;collection_date&#x27;: record[&#x27;collection_date&#x27;].isoformat(),
                &#x27;data_fields&#x27;: record[&#x27;data_fields&#x27;]
            }

            if record[&#x27;deleted&#x27;]:
                record_summary[&#x27;deletion_date&#x27;] = record.get(&#x27;deletion_date&#x27;, &#x27;&#x27;).isoformat() if record.get(&#x27;deletion_date&#x27;) else &#x27;&#x27;
                deleted_records.append(record_summary)
            elif record[&#x27;deletion_scheduled&#x27;]:
                retention_policy = record[&#x27;retention_policy&#x27;]
                if retention_policy:
                    record_summary[&#x27;scheduled_deletion_date&#x27;] = retention_policy.calculate_deletion_date(record[&#x27;collection_date&#x27;]).isoformat()
                scheduled_deletions.append(record_summary)
            else:
                retention_policy = record[&#x27;retention_policy&#x27;]
                if retention_policy:
                    record_summary[&#x27;retention_until&#x27;] = retention_policy.calculate_deletion_date(record[&#x27;collection_date&#x27;]).isoformat()
                    record_summary[&#x27;retention_policy&#x27;] = retention_policy.legal_basis
                active_records.append(record_summary)

        return {
            &#x27;user_id&#x27;: user_id,
            &#x27;total_records&#x27;: len(user_records),
            &#x27;active_records&#x27;: active_records,
            &#x27;scheduled_deletions&#x27;: scheduled_deletions,
            &#x27;deleted_records&#x27;: deleted_records,
            &#x27;report_generated&#x27;: datetime.now().isoformat()
        }

    def _get_compatible_purposes(self, original_purpose: PurposeLimitation) -&gt; List[PurposeLimitation]:
        &quot;&quot;&quot;Define which purposes are compatible with each other&quot;&quot;&quot;

        # Define purpose compatibility matrix
        compatibility_matrix = {
            PurposeLimitation.ACCOUNT_MANAGEMENT: [
                PurposeLimitation.ACCOUNT_MANAGEMENT,
                PurposeLimitation.SECURITY
            ],
            PurposeLimitation.SERVICE_DELIVERY: [
                PurposeLimitation.SERVICE_DELIVERY,
                PurposeLimitation.SECURITY
            ],
            PurposeLimitation.SECURITY: [
                PurposeLimitation.SECURITY,
                PurposeLimitation.LEGAL_COMPLIANCE
            ],
            PurposeLimitation.ANALYTICS: [
                PurposeLimitation.ANALYTICS
            ],
            PurposeLimitation.MARKETING: [
                PurposeLimitation.MARKETING
            ],
            PurposeLimitation.LEGAL_COMPLIANCE: [
                PurposeLimitation.LEGAL_COMPLIANCE,
                PurposeLimitation.SECURITY
            ]
        }

        return compatibility_matrix.get(original_purpose, [original_purpose])

# Demonstration of purpose limitation and retention
def demonstrate_purpose_limitation_and_retention():
    &quot;&quot;&quot;Demonstrate purpose limitation and data retention management&quot;&quot;&quot;

    print(&quot;=== Purpose Limitation and Data Retention Demo ===&quot;)

    retention_manager = DataRetentionManager()
    user_id = &quot;student_67890&quot;

    # Step 1: Record data collection for different purposes
    print(&quot;1. Recording data collection for different purposes...&quot;)

    # Collect account data
    account_record_id = retention_manager.record_data_collection(
        user_id,
        &#x27;account_data&#x27;,
        PurposeLimitation.ACCOUNT_MANAGEMENT,
        {&#x27;username&#x27;: &#x27;student67890&#x27;, &#x27;email&#x27;: &#x27;student@school.edu&#x27;, &#x27;password_hash&#x27;: &#x27;hashed&#x27;}
    )

    # Collect analytics data
    analytics_record_id = retention_manager.record_data_collection(
        user_id,
        &#x27;usage_analytics&#x27;,
        PurposeLimitation.ANALYTICS,
        {&#x27;page_views&#x27;: 150, &#x27;feature_usage&#x27;: {&#x27;login&#x27;: 45, &#x27;homework&#x27;: 30}}
    )

    # Collect marketing data
    marketing_record_id = retention_manager.record_data_collection(
        user_id,
        &#x27;marketing_data&#x27;,
        PurposeLimitation.MARKETING,
        {&#x27;email_preferences&#x27;: &#x27;weekly&#x27;, &#x27;interests&#x27;: [&#x27;math&#x27;, &#x27;science&#x27;]}
    )

    print(f&quot;Recorded account data: {account_record_id}&quot;)
    print(f&quot;Recorded analytics data: {analytics_record_id}&quot;)
    print(f&quot;Recorded marketing data: {marketing_record_id}&quot;)

    # Step 2: Test purpose limitation compliance
    print(&quot;\n2. Testing purpose limitation compliance...&quot;)

    test_scenarios = [
        (&#x27;account_data&#x27;, PurposeLimitation.ACCOUNT_MANAGEMENT, &quot;User profile display&quot;),
        (&#x27;account_data&#x27;, PurposeLimitation.SECURITY, &quot;Security audit&quot;),
        (&#x27;account_data&#x27;, PurposeLimitation.MARKETING, &quot;Email promotion&quot;),
        (&#x27;usage_analytics&#x27;, PurposeLimitation.ANALYTICS, &quot;Service improvement&quot;),
        (&#x27;usage_analytics&#x27;, PurposeLimitation.MARKETING, &quot;Behavioral targeting&quot;)
    ]

    for data_type, purpose, description in test_scenarios:
        compliance_check = retention_manager.check_purpose_compliance(user_id, data_type, purpose)
        status = &quot;✅ COMPLIANT&quot; if compliance_check[&#x27;compliant&#x27;] else &quot;❌ NON-COMPLIANT&quot;
        print(f&quot;  {description}: {status}&quot;)
        if not compliance_check[&#x27;compliant&#x27;]:
            print(f&quot;    Reason: {compliance_check[&#x27;reason&#x27;]}&quot;)

    # Step 3: Generate data inventory report
    print(&quot;\n3. Data inventory report...&quot;)

    inventory_report = retention_manager.get_data_inventory_report(user_id)

    print(f&quot;Total records: {inventory_report[&#x27;total_records&#x27;]}&quot;)
    print(&quot;Active records:&quot;)
    for record in inventory_report[&#x27;active_records&#x27;]:
        print(f&quot;  {record[&#x27;data_type&#x27;]} (Purpose: {record[&#x27;purpose&#x27;]})&quot;)
        print(f&quot;    Collected: {record[&#x27;collection_date&#x27;][:10]}&quot;)
        print(f&quot;    Retention until: {record.get(&#x27;retention_until&#x27;, &#x27;N/A&#x27;)[:10]}&quot;)
        print(f&quot;    Legal basis: {record.get(&#x27;retention_policy&#x27;, &#x27;Not specified&#x27;)}&quot;)

    # Step 4: Simulate passage of time and check deletions
    print(&quot;\n4. Simulating data retention and deletion...&quot;)

    # For demo purposes, let&#x27;s manually trigger deletion check
    deletion_schedule = retention_manager.schedule_data_deletion(user_id)

    print(f&quot;Records scheduled for deletion: {deletion_schedule[&#x27;deletion_scheduled_count&#x27;]}&quot;)

    if deletion_schedule[&#x27;deletion_schedule&#x27;]:
        print(&quot;Deletion schedule:&quot;)
        for item in deletion_schedule[&#x27;deletion_schedule&#x27;]:
            print(f&quot;  {item[&#x27;data_type&#x27;]}: Due {item[&#x27;deletion_due_date&#x27;][:10]}&quot;)
            print(f&quot;    Legal basis: {item[&#x27;legal_basis&#x27;]}&quot;)
</code></pre>
</div>
<h3 id="4-privacy-impact-assessments">4. Privacy Impact Assessments<a class="headerlink" href="#4-privacy-impact-assessments" title="Permanent link">&para;</a></h3>
<p><strong>Privacy Impact Assessments (PIAs)</strong> systematically evaluate how personal data processing activities affect individual privacy.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from typing import Dict, List, Optional, Set
from datetime import datetime
from enum import Enum
import json

class RiskLevel(Enum):
    LOW = &quot;low&quot;
    MEDIUM = &quot;medium&quot;
    HIGH = &quot;high&quot;
    CRITICAL = &quot;critical&quot;

class DataSensitivity(Enum):
    PUBLIC = &quot;public&quot;
    INTERNAL = &quot;internal&quot;
    CONFIDENTIAL = &quot;confidential&quot;
    RESTRICTED = &quot;restricted&quot;

class PrivacyRisk:
    def __init__(self, risk_id: str, description: str, likelihood: RiskLevel, 
                 impact: RiskLevel, data_types_affected: List[str]):
        self.risk_id = risk_id
        self.description = description
        self.likelihood = likelihood
        self.impact = impact
        self.data_types_affected = data_types_affected
        self.overall_risk = self._calculate_overall_risk()
        self.mitigation_measures = []
        self.residual_risk = self.overall_risk

    def _calculate_overall_risk(self) -&gt; RiskLevel:
        &quot;&quot;&quot;Calculate overall risk based on likelihood and impact&quot;&quot;&quot;
        risk_matrix = {
            (RiskLevel.LOW, RiskLevel.LOW): RiskLevel.LOW,
            (RiskLevel.LOW, RiskLevel.MEDIUM): RiskLevel.LOW,
            (RiskLevel.LOW, RiskLevel.HIGH): RiskLevel.MEDIUM,
            (RiskLevel.LOW, RiskLevel.CRITICAL): RiskLevel.MEDIUM,
            (RiskLevel.MEDIUM, RiskLevel.LOW): RiskLevel.LOW,
            (RiskLevel.MEDIUM, RiskLevel.MEDIUM): RiskLevel.MEDIUM,
            (RiskLevel.MEDIUM, RiskLevel.HIGH): RiskLevel.HIGH,
            (RiskLevel.MEDIUM, RiskLevel.CRITICAL): RiskLevel.HIGH,
            (RiskLevel.HIGH, RiskLevel.LOW): RiskLevel.MEDIUM,
            (RiskLevel.HIGH, RiskLevel.MEDIUM): RiskLevel.HIGH,
            (RiskLevel.HIGH, RiskLevel.HIGH): RiskLevel.HIGH,
            (RiskLevel.HIGH, RiskLevel.CRITICAL): RiskLevel.CRITICAL,
            (RiskLevel.CRITICAL, RiskLevel.LOW): RiskLevel.MEDIUM,
            (RiskLevel.CRITICAL, RiskLevel.MEDIUM): RiskLevel.HIGH,
            (RiskLevel.CRITICAL, RiskLevel.HIGH): RiskLevel.CRITICAL,
            (RiskLevel.CRITICAL, RiskLevel.CRITICAL): RiskLevel.CRITICAL,
        }

        return risk_matrix.get((self.likelihood, self.impact), RiskLevel.HIGH)

    def add_mitigation_measure(self, measure: str, risk_reduction: RiskLevel):
        &quot;&quot;&quot;Add mitigation measure and update residual risk&quot;&quot;&quot;
        self.mitigation_measures.append({
            &#x27;measure&#x27;: measure,
            &#x27;risk_reduction&#x27;: risk_reduction,
            &#x27;implemented&#x27;: False
        })

        # Simplified residual risk calculation
        if risk_reduction == RiskLevel.HIGH and self.residual_risk in [RiskLevel.HIGH, RiskLevel.CRITICAL]:
            if self.residual_risk == RiskLevel.CRITICAL:
                self.residual_risk = RiskLevel.HIGH
            else:
                self.residual_risk = RiskLevel.MEDIUM

class PrivacyImpactAssessment:
    def __init__(self, project_name: str, assessor: str):
        self.assessment_id = f&quot;PIA_{datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)}&quot;
        self.project_name = project_name
        self.assessor = assessor
        self.assessment_date = datetime.now()
        self.data_processing_activities = []
        self.identified_risks = []
        self.stakeholders = []
        self.legal_basis_analysis = {}
        self.consultation_required = False

    def add_data_processing_activity(self, activity_name: str, purpose: str,
                                   data_types: List[str], data_subjects: List[str],
                                   data_sources: List[str], data_recipients: List[str],
                                   retention_period: str, data_sensitivity: DataSensitivity):
        &quot;&quot;&quot;Add data processing activity to assessment&quot;&quot;&quot;

        activity = {
            &#x27;activity_id&#x27;: f&quot;DPA_{len(self.data_processing_activities) + 1:03d}&quot;,
            &#x27;activity_name&#x27;: activity_name,
            &#x27;purpose&#x27;: purpose,
            &#x27;data_types&#x27;: data_types,
            &#x27;data_subjects&#x27;: data_subjects,
            &#x27;data_sources&#x27;: data_sources,
            &#x27;data_recipients&#x27;: data_recipients,
            &#x27;retention_period&#x27;: retention_period,
            &#x27;data_sensitivity&#x27;: data_sensitivity.value,
            &#x27;cross_border_transfers&#x27;: False,
            &#x27;automated_decision_making&#x27;: False
        }

        self.data_processing_activities.append(activity)

        # Automatically assess basic risks
        self._assess_activity_risks(activity)

        return activity[&#x27;activity_id&#x27;]

    def _assess_activity_risks(self, activity: Dict[str, any]):
        &quot;&quot;&quot;Automatically assess privacy risks for processing activity&quot;&quot;&quot;

        # Risk 1: Data breach exposure
        if activity[&#x27;data_sensitivity&#x27;] in [&#x27;confidential&#x27;, &#x27;restricted&#x27;]:
            breach_risk = PrivacyRisk(
                f&quot;BREACH_{activity[&#x27;activity_id&#x27;]}&quot;,
                f&quot;Risk of data breach exposing {activity[&#x27;data_sensitivity&#x27;]} data in {activity[&#x27;activity_name&#x27;]}&quot;,
                RiskLevel.MEDIUM,
                RiskLevel.HIGH if activity[&#x27;data_sensitivity&#x27;] == &#x27;restricted&#x27; else RiskLevel.MEDIUM,
                activity[&#x27;data_types&#x27;]
            )
            self.identified_risks.append(breach_risk)

        # Risk 2: Unauthorized access
        if len(activity[&#x27;data_recipients&#x27;]) &gt; 2:
            access_risk = PrivacyRisk(
                f&quot;ACCESS_{activity[&#x27;activity_id&#x27;]}&quot;,
                f&quot;Risk of unauthorized access due to multiple data recipients in {activity[&#x27;activity_name&#x27;]}&quot;,
                RiskLevel.MEDIUM,
                RiskLevel.MEDIUM,
                activity[&#x27;data_types&#x27;]
            )
            self.identified_risks.append(access_risk)

        # Risk 3: Data retention
        if &#x27;indefinite&#x27; in activity[&#x27;retention_period&#x27;].lower():
            retention_risk = PrivacyRisk(
                f&quot;RETENTION_{activity[&#x27;activity_id&#x27;]}&quot;,
                f&quot;Risk of excessive data retention in {activity[&#x27;activity_name&#x27;]}&quot;,
                RiskLevel.HIGH,
                RiskLevel.MEDIUM,
                activity[&#x27;data_types&#x27;]
            )
            self.identified_risks.append(retention_risk)

        # Risk 4: Purpose creep
        if &#x27;marketing&#x27; in activity[&#x27;purpose&#x27;].lower() and any(&#x27;personal&#x27; in dt.lower() for dt in activity[&#x27;data_types&#x27;]):
            purpose_risk = PrivacyRisk(
                f&quot;PURPOSE_{activity[&#x27;activity_id&#x27;]}&quot;,
                f&quot;Risk of purpose creep in marketing activities for {activity[&#x27;activity_name&#x27;]}&quot;,
                RiskLevel.MEDIUM,
                RiskLevel.MEDIUM,
                activity[&#x27;data_types&#x27;]
            )
            self.identified_risks.append(purpose_risk)

    def assess_legal_basis(self, activity_id: str, proposed_legal_basis: str,
                          justification: str) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Assess legal basis for processing activity&quot;&quot;&quot;

        valid_legal_bases = [
            &#x27;consent&#x27;,
            &#x27;contract&#x27;,
            &#x27;legal_obligation&#x27;,
            &#x27;vital_interests&#x27;,
            &#x27;public_task&#x27;,
            &#x27;legitimate_interests&#x27;
        ]

        if proposed_legal_basis not in valid_legal_bases:
            return {
                &#x27;valid&#x27;: False,
                &#x27;error&#x27;: f&quot;Invalid legal basis. Must be one of: {valid_legal_bases}&quot;
            }

        # Find the activity
        activity = next((a for a in self.data_processing_activities if a[&#x27;activity_id&#x27;] == activity_id), None)
        if not activity:
            return {
                &#x27;valid&#x27;: False,
                &#x27;error&#x27;: f&quot;Activity {activity_id} not found&quot;
            }

        # Assess appropriateness of legal basis
        assessment = self._evaluate_legal_basis_appropriateness(activity, proposed_legal_basis)

        self.legal_basis_analysis[activity_id] = {
            &#x27;proposed_legal_basis&#x27;: proposed_legal_basis,
            &#x27;justification&#x27;: justification,
            &#x27;assessment&#x27;: assessment,
            &#x27;assessed_date&#x27;: datetime.now().isoformat()
        }

        return {
            &#x27;valid&#x27;: True,
            &#x27;assessment&#x27;: assessment
        }

    def _evaluate_legal_basis_appropriateness(self, activity: Dict[str, any], 
                                            legal_basis: str) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Evaluate if proposed legal basis is appropriate&quot;&quot;&quot;

        appropriateness = {
            &#x27;appropriate&#x27;: True,
            &#x27;concerns&#x27;: [],
            &#x27;recommendations&#x27;: []
        }

        # Check for high-risk scenarios
        if activity[&#x27;data_sensitivity&#x27;] == &#x27;restricted&#x27;:
            if legal_basis == &#x27;legitimate_interests&#x27;:
                appropriateness[&#x27;concerns&#x27;].append(
                    &quot;Legitimate interests may not be sufficient for restricted data&quot;
                )
                appropriateness[&#x27;recommendations&#x27;].append(
                    &quot;Consider explicit consent or legal obligation&quot;
                )

        # Check marketing activities
        if &#x27;marketing&#x27; in activity[&#x27;purpose&#x27;].lower():
            if legal_basis != &#x27;consent&#x27;:
                appropriateness[&#x27;concerns&#x27;].append(
                    &quot;Marketing activities typically require explicit consent&quot;
                )
                appropriateness[&#x27;recommendations&#x27;].append(
                    &quot;Use consent as legal basis for marketing&quot;
                )

        # Check sensitive data types
        sensitive_indicators = [&#x27;health&#x27;, &#x27;medical&#x27;, &#x27;financial&#x27;, &#x27;biometric&#x27;, &#x27;religious&#x27;, &#x27;political&#x27;]
        has_sensitive_data = any(indicator in &#x27; &#x27;.join(activity[&#x27;data_types&#x27;]).lower() 
                               for indicator in sensitive_indicators)

        if has_sensitive_data and legal_basis not in [&#x27;consent&#x27;, &#x27;legal_obligation&#x27;, &#x27;vital_interests&#x27;]:
            appropriateness[&#x27;concerns&#x27;].append(
                &quot;Sensitive personal data typically requires explicit consent or legal obligation&quot;
            )
            appropriateness[&#x27;recommendations&#x27;].append(
                &quot;Review legal basis for sensitive data processing&quot;
            )

        appropriateness[&#x27;appropriate&#x27;] = len(appropriateness[&#x27;concerns&#x27;]) == 0

        return appropriateness

    def add_mitigation_measures(self):
        &quot;&quot;&quot;Add standard mitigation measures for identified risks&quot;&quot;&quot;

        for risk in self.identified_risks:
            if &#x27;BREACH&#x27; in risk.risk_id:
                risk.add_mitigation_measure(&quot;Implement end-to-end encryption&quot;, RiskLevel.HIGH)
                risk.add_mitigation_measure(&quot;Regular security audits&quot;, RiskLevel.MEDIUM)
                risk.add_mitigation_measure(&quot;Access controls and authentication&quot;, RiskLevel.MEDIUM)

            elif &#x27;ACCESS&#x27; in risk.risk_id:
                risk.add_mitigation_measure(&quot;Role-based access controls&quot;, RiskLevel.HIGH)
                risk.add_mitigation_measure(&quot;Audit logging of data access&quot;, RiskLevel.MEDIUM)
                risk.add_mitigation_measure(&quot;Regular access reviews&quot;, RiskLevel.MEDIUM)

            elif &#x27;RETENTION&#x27; in risk.risk_id:
                risk.add_mitigation_measure(&quot;Implement automated data deletion&quot;, RiskLevel.HIGH)
                risk.add_mitigation_measure(&quot;Regular data retention reviews&quot;, RiskLevel.MEDIUM)
                risk.add_mitigation_measure(&quot;Data minimization policies&quot;, RiskLevel.MEDIUM)

            elif &#x27;PURPOSE&#x27; in risk.risk_id:
                risk.add_mitigation_measure(&quot;Clear purpose documentation&quot;, RiskLevel.MEDIUM)
                risk.add_mitigation_measure(&quot;Staff training on purpose limitation&quot;, RiskLevel.MEDIUM)
                risk.add_mitigation_measure(&quot;Technical controls to prevent purpose creep&quot;, RiskLevel.HIGH)

    def determine_consultation_requirement(self) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Determine if consultation with privacy authority is required&quot;&quot;&quot;

        high_risk_indicators = []

        # Check for high/critical risks
        critical_risks = [r for r in self.identified_risks if r.residual_risk == RiskLevel.CRITICAL]
        high_risks = [r for r in self.identified_risks if r.residual_risk == RiskLevel.HIGH]

        if critical_risks:
            high_risk_indicators.append(f&quot;{len(critical_risks)} critical privacy risks identified&quot;)

        if len(high_risks) &gt;= 3:
            high_risk_indicators.append(f&quot;{len(high_risks)} high privacy risks identified&quot;)

        # Check for sensitive data processing
        sensitive_activities = []
        for activity in self.data_processing_activities:
            if activity[&#x27;data_sensitivity&#x27;] == &#x27;restricted&#x27;:
                sensitive_activities.append(activity[&#x27;activity_name&#x27;])

        if sensitive_activities:
            high_risk_indicators.append(f&quot;Processing restricted data: {&#x27;, &#x27;.join(sensitive_activities)}&quot;)

        # Check for automated decision making
        automated_activities = [a for a in self.data_processing_activities if a.get(&#x27;automated_decision_making&#x27;, False)]
        if automated_activities:
            high_risk_indicators.append(&quot;Automated decision making identified&quot;)

        self.consultation_required = len(high_risk_indicators) &gt; 0

        return {
            &#x27;consultation_required&#x27;: self.consultation_required,
            &#x27;risk_indicators&#x27;: high_risk_indicators,
            &#x27;recommendation&#x27;: &#x27;Consult privacy authority before proceeding&#x27; if self.consultation_required else &#x27;No consultation required&#x27;
        }

    def generate_assessment_report(self) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Generate comprehensive PIA report&quot;&quot;&quot;

        # Calculate risk summary
        risk_summary = {
            &#x27;total_risks&#x27;: len(self.identified_risks),
            &#x27;critical_risks&#x27;: len([r for r in self.identified_risks if r.residual_risk == RiskLevel.CRITICAL]),
            &#x27;high_risks&#x27;: len([r for r in self.identified_risks if r.residual_risk == RiskLevel.HIGH]),
            &#x27;medium_risks&#x27;: len([r for r in self.identified_risks if r.residual_risk == RiskLevel.MEDIUM]),
            &#x27;low_risks&#x27;: len([r for r in self.identified_risks if r.residual_risk == RiskLevel.LOW])
        }

        # Generate recommendations
        recommendations = []

        if risk_summary[&#x27;critical_risks&#x27;] &gt; 0:
            recommendations.append(&quot;Address critical privacy risks before project implementation&quot;)

        if risk_summary[&#x27;high_risks&#x27;] &gt; 2:
            recommendations.append(&quot;Implement comprehensive risk mitigation program&quot;)

        if self.consultation_required:
            recommendations.append(&quot;Consult with privacy authority before proceeding&quot;)

        # Check legal basis coverage
        activities_without_legal_basis = [
            a for a in self.data_processing_activities 
            if a[&#x27;activity_id&#x27;] not in self.legal_basis_analysis
        ]

        if activities_without_legal_basis:
            recommendations.append(&quot;Complete legal basis analysis for all processing activities&quot;)

        return {
            &#x27;assessment_summary&#x27;: {
                &#x27;assessment_id&#x27;: self.assessment_id,
                &#x27;project_name&#x27;: self.project_name,
                &#x27;assessor&#x27;: self.assessor,
                &#x27;assessment_date&#x27;: self.assessment_date.isoformat(),
                &#x27;activities_assessed&#x27;: len(self.data_processing_activities),
                &#x27;consultation_required&#x27;: self.consultation_required
            },
            &#x27;risk_summary&#x27;: risk_summary,
            &#x27;processing_activities&#x27;: self.data_processing_activities,
            &#x27;identified_risks&#x27;: [
                {
                    &#x27;risk_id&#x27;: r.risk_id,
                    &#x27;description&#x27;: r.description,
                    &#x27;likelihood&#x27;: r.likelihood.value,
                    &#x27;impact&#x27;: r.impact.value,
                    &#x27;overall_risk&#x27;: r.overall_risk.value,
                    &#x27;residual_risk&#x27;: r.residual_risk.value,
                    &#x27;data_types_affected&#x27;: r.data_types_affected,
                    &#x27;mitigation_measures&#x27;: r.mitigation_measures
                }
                for r in self.identified_risks
            ],
            &#x27;legal_basis_analysis&#x27;: self.legal_basis_analysis,
            &#x27;recommendations&#x27;: recommendations,
            &#x27;next_steps&#x27;: self._generate_next_steps()
        }

    def _generate_next_steps(self) -&gt; List[str]:
        &quot;&quot;&quot;Generate recommended next steps&quot;&quot;&quot;

        next_steps = []

        # Risk mitigation
        high_priority_risks = [r for r in self.identified_risks if r.residual_risk in [RiskLevel.HIGH, RiskLevel.CRITICAL]]
        if high_priority_risks:
            next_steps.append(&quot;Implement mitigation measures for high-priority privacy risks&quot;)

        # Legal basis
        if len(self.legal_basis_analysis) &lt; len(self.data_processing_activities):
            next_steps.append(&quot;Complete legal basis assessment for all processing activities&quot;)

        # Consultation
        if self.consultation_required:
            next_steps.append(&quot;Schedule consultation with privacy authority&quot;)

        # Implementation
        next_steps.append(&quot;Update project design based on PIA findings&quot;)
        next_steps.append(&quot;Establish privacy monitoring and review procedures&quot;)

        return next_steps

# Demonstration of Privacy Impact Assessment
def demonstrate_privacy_impact_assessment():
    &quot;&quot;&quot;Demonstrate comprehensive Privacy Impact Assessment&quot;&quot;&quot;

    print(&quot;=== Privacy Impact Assessment Demo ===&quot;)

    # Create PIA for student information system
    pia = PrivacyImpactAssessment(&quot;Student Information System v2.0&quot;, &quot;Privacy Officer&quot;)

    print(f&quot;Assessment ID: {pia.assessment_id}&quot;)
    print(f&quot;Project: {pia.project_name}&quot;)

    # Add data processing activities
    print(&quot;\n1. Adding data processing activities...&quot;)

    # Activity 1: Student registration
    activity1_id = pia.add_data_processing_activity(
        &quot;Student Registration&quot;,
        &quot;Create and manage student accounts for educational services&quot;,
        [&quot;name&quot;, &quot;email&quot;, &quot;date_of_birth&quot;, &quot;student_id&quot;, &quot;emergency_contact&quot;],
        [&quot;students&quot;, &quot;parents&quot;, &quot;guardians&quot;],
        [&quot;online_registration_form&quot;, &quot;school_records&quot;],
        [&quot;teachers&quot;, &quot;administrators&quot;, &quot;IT_support&quot;],
        &quot;7 years after graduation&quot;,
        DataSensitivity.CONFIDENTIAL
    )

    # Activity 2: Learning analytics
    activity2_id = pia.add_data_processing_activity(
        &quot;Learning Analytics&quot;,
        &quot;Analyze student performance and engagement for educational improvement&quot;,
        [&quot;assignment_scores&quot;, &quot;time_spent&quot;, &quot;interaction_patterns&quot;, &quot;learning_preferences&quot;],
        [&quot;students&quot;],
        [&quot;learning_management_system&quot;, &quot;assessment_tools&quot;],
        [&quot;teachers&quot;, &quot;education_researchers&quot;, &quot;analytics_team&quot;],
        &quot;3 years&quot;,
        DataSensitivity.INTERNAL
    )

    # Activity 3: Marketing communications
    activity3_id = pia.add_data_processing_activity(
        &quot;Alumni Communications&quot;,
        &quot;Send promotional materials and fundraising communications to alumni&quot;,
        [&quot;name&quot;, &quot;email&quot;, &quot;graduation_year&quot;, &quot;donation_history&quot;, &quot;contact_preferences&quot;],
        [&quot;alumni&quot;],
        [&quot;student_records&quot;, &quot;alumni_surveys&quot;],
        [&quot;marketing_team&quot;, &quot;external_fundraising_consultants&quot;],
        &quot;indefinite (until consent withdrawn)&quot;,
        DataSensitivity.INTERNAL
    )

    print(f&quot;Added activities: {activity1_id}, {activity2_id}, {activity3_id}&quot;)

    # Assess legal basis
    print(&quot;\n2. Assessing legal basis...&quot;)

    legal_assessments = [
        (activity1_id, &quot;contract&quot;, &quot;Necessary for providing educational services under enrollment contract&quot;),
        (activity2_id, &quot;legitimate_interests&quot;, &quot;Legitimate interest in improving educational outcomes&quot;),
        (activity3_id, &quot;consent&quot;, &quot;Marketing communications require explicit consent&quot;)
    ]

    for activity_id, legal_basis, justification in legal_assessments:
        assessment = pia.assess_legal_basis(activity_id, legal_basis, justification)
        if assessment[&#x27;valid&#x27;]:
            status = &quot;✅ APPROPRIATE&quot; if assessment[&#x27;assessment&#x27;][&#x27;appropriate&#x27;] else &quot;⚠️ CONCERNS&quot;
            print(f&quot;  {activity_id}: {legal_basis} - {status}&quot;)
            if not assessment[&#x27;assessment&#x27;][&#x27;appropriate&#x27;]:
                for concern in assessment[&#x27;assessment&#x27;][&#x27;concerns&#x27;]:
                    print(f&quot;    Concern: {concern}&quot;)
        else:
            print(f&quot;  {activity_id}: ❌ INVALID - {assessment[&#x27;error&#x27;]}&quot;)

    # Add mitigation measures
    print(&quot;\n3. Adding mitigation measures...&quot;)
    pia.add_mitigation_measures()

    mitigation_count = sum(len(risk.mitigation_measures) for risk in pia.identified_risks)
    print(f&quot;Added {mitigation_count} mitigation measures across {len(pia.identified_risks)} identified risks&quot;)

    # Check consultation requirement
    print(&quot;\n4. Checking consultation requirements...&quot;)
    consultation_result = pia.determine_consultation_requirement()

    print(f&quot;Consultation required: {consultation_result[&#x27;consultation_required&#x27;]}&quot;)
    if consultation_result[&#x27;risk_indicators&#x27;]:
        print(&quot;Risk indicators:&quot;)
        for indicator in consultation_result[&#x27;risk_indicators&#x27;]:
            print(f&quot;  - {indicator}&quot;)
    print(f&quot;Recommendation: {consultation_result[&#x27;recommendation&#x27;]}&quot;)

    # Generate assessment report
    print(&quot;\n5. Generating assessment report...&quot;)

    report = pia.generate_assessment_report()

    print(&quot;Assessment Summary:&quot;)
    summary = report[&#x27;assessment_summary&#x27;]
    print(f&quot;  Project: {summary[&#x27;project_name&#x27;]}&quot;)
    print(f&quot;  Activities assessed: {summary[&#x27;activities_assessed&#x27;]}&quot;)
    print(f&quot;  Consultation required: {summary[&#x27;consultation_required&#x27;]}&quot;)

    print(&quot;\nRisk Summary:&quot;)
    risk_summary = report[&#x27;risk_summary&#x27;]
    print(f&quot;  Total risks: {risk_summary[&#x27;total_risks&#x27;]}&quot;)
    print(f&quot;  Critical: {risk_summary[&#x27;critical_risks&#x27;]}, High: {risk_summary[&#x27;high_risks&#x27;]}&quot;)
    print(f&quot;  Medium: {risk_summary[&#x27;medium_risks&#x27;]}, Low: {risk_summary[&#x27;low_risks&#x27;]}&quot;)

    print(&quot;\nKey Recommendations:&quot;)
    for i, rec in enumerate(report[&#x27;recommendations&#x27;][:3], 1):
        print(f&quot;  {i}. {rec}&quot;)

    print(&quot;\nNext Steps:&quot;)
    for i, step in enumerate(report[&#x27;next_steps&#x27;][:3], 1):
        print(f&quot;  {i}. {step}&quot;)
</code></pre>
</div>
<h2 id="gdpr-and-privacy-law-fundamentals">GDPR and Privacy Law Fundamentals<a class="headerlink" href="#gdpr-and-privacy-law-fundamentals" title="Permanent link">&para;</a></h2>
<p>The General Data Protection Regulation (GDPR) provides a comprehensive framework for data protection that influences privacy design worldwide.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from typing import Dict, List, Optional
from datetime import datetime, timedelta
from enum import Enum

class GDPRRights(Enum):
    ACCESS = &quot;access&quot;  # Right to access personal data
    RECTIFICATION = &quot;rectification&quot;  # Right to correct inaccurate data
    ERASURE = &quot;erasure&quot;  # Right to be forgotten
    RESTRICT_PROCESSING = &quot;restrict_processing&quot;  # Right to restrict processing
    DATA_PORTABILITY = &quot;data_portability&quot;  # Right to data portability
    OBJECT = &quot;object&quot;  # Right to object to processing
    WITHDRAW_CONSENT = &quot;withdraw_consent&quot;  # Right to withdraw consent

class RequestStatus(Enum):
    RECEIVED = &quot;received&quot;
    UNDER_REVIEW = &quot;under_review&quot;
    COMPLETED = &quot;completed&quot;
    REJECTED = &quot;rejected&quot;
    PARTIALLY_COMPLETED = &quot;partially_completed&quot;

class GDPRComplianceManager:
    def __init__(self):
        self.data_subject_requests = {}
        self.processing_records = {}
        self.consent_records = {}

        # Define response timeframes (GDPR requirements)
        self.response_timeframes = {
            GDPRRights.ACCESS: timedelta(days=30),
            GDPRRights.RECTIFICATION: timedelta(days=30),
            GDPRRights.ERASURE: timedelta(days=30),
            GDPRRights.RESTRICT_PROCESSING: timedelta(days=30),
            GDPRRights.DATA_PORTABILITY: timedelta(days=30),
            GDPRRights.OBJECT: timedelta(days=30),
            GDPRRights.WITHDRAW_CONSENT: timedelta(days=0)  # Immediate
        }

    def handle_data_subject_request(self, user_id: str, request_type: GDPRRights,
                                  details: str = &quot;&quot;, identity_verified: bool = False) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Handle data subject rights requests under GDPR&quot;&quot;&quot;

        request_id = f&quot;DSR_{datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)}_{user_id}&quot;

        if not identity_verified:
            return {
                &#x27;success&#x27;: False,
                &#x27;error&#x27;: &#x27;Identity verification required for data subject requests&#x27;,
                &#x27;next_steps&#x27;: &#x27;Please provide identity verification documents&#x27;
            }

        # Calculate response deadline
        response_deadline = datetime.now() + self.response_timeframes[request_type]

        request_record = {
            &#x27;request_id&#x27;: request_id,
            &#x27;user_id&#x27;: user_id,
            &#x27;request_type&#x27;: request_type.value,
            &#x27;details&#x27;: details,
            &#x27;received_date&#x27;: datetime.now(),
            &#x27;response_deadline&#x27;: response_deadline,
            &#x27;status&#x27;: RequestStatus.RECEIVED,
            &#x27;identity_verified&#x27;: identity_verified,
            &#x27;processing_log&#x27;: []
        }

        self.data_subject_requests[request_id] = request_record

        # Process the request based on type
        if request_type == GDPRRights.ACCESS:
            return self._process_access_request(request_record)
        elif request_type == GDPRRights.RECTIFICATION:
            return self._process_rectification_request(request_record)
        elif request_type == GDPRRights.ERASURE:
            return self._process_erasure_request(request_record)
        elif request_type == GDPRRights.DATA_PORTABILITY:
            return self._process_portability_request(request_record)
        elif request_type == GDPRRights.WITHDRAW_CONSENT:
            return self._process_consent_withdrawal(request_record)
        else:
            return self._process_generic_request(request_record)

    def _process_access_request(self, request_record: Dict[str, any]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Process subject access request (Article 15)&quot;&quot;&quot;

        user_id = request_record[&#x27;user_id&#x27;]

        # Simulate gathering user data from various systems
        collected_data = {
            &#x27;account_information&#x27;: {
                &#x27;user_id&#x27;: user_id,
                &#x27;registration_date&#x27;: &#x27;2023-09-01&#x27;,
                &#x27;last_login&#x27;: &#x27;2024-09-17&#x27;,
                &#x27;account_status&#x27;: &#x27;active&#x27;
            },
            &#x27;processing_purposes&#x27;: [
                &#x27;Account management&#x27;,
                &#x27;Service delivery&#x27;,
                &#x27;Security monitoring&#x27;
            ],
            &#x27;data_categories&#x27;: [
                &#x27;Identity data (name, email)&#x27;,
                &#x27;Usage data (login history, preferences)&#x27;,
                &#x27;Security data (IP addresses, device info)&#x27;
            ],
            &#x27;data_recipients&#x27;: [
                &#x27;Internal staff (teachers, administrators)&#x27;,
                &#x27;IT service providers&#x27;,
                &#x27;Security monitoring services&#x27;
            ],
            &#x27;retention_periods&#x27;: {
                &#x27;account_data&#x27;: &#x27;7 years after account closure&#x27;,
                &#x27;usage_data&#x27;: &#x27;1 year&#x27;,
                &#x27;security_logs&#x27;: &#x27;6 months&#x27;
            },
            &#x27;data_sources&#x27;: [
                &#x27;Direct collection (registration form)&#x27;,
                &#x27;Automated collection (system logs)&#x27;,
                &#x27;Third-party integration (single sign-on)&#x27;
            ]
        }

        # Update request status
        request_record[&#x27;status&#x27;] = RequestStatus.COMPLETED
        request_record[&#x27;completion_date&#x27;] = datetime.now()
        request_record[&#x27;response_data&#x27;] = collected_data

        # Log processing
        request_record[&#x27;processing_log&#x27;].append({
            &#x27;timestamp&#x27;: datetime.now().isoformat(),
            &#x27;action&#x27;: &#x27;Data compiled for access request&#x27;,
            &#x27;details&#x27;: f&quot;Collected data from {len(collected_data)} data categories&quot;
        })

        return {
            &#x27;success&#x27;: True,
            &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
            &#x27;status&#x27;: &#x27;completed&#x27;,
            &#x27;response_data&#x27;: collected_data,
            &#x27;completion_date&#x27;: request_record[&#x27;completion_date&#x27;].isoformat(),
            &#x27;delivery_method&#x27;: &#x27;secure_download_link&#x27;
        }

    def _process_erasure_request(self, request_record: Dict[str, any]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Process right to be forgotten request (Article 17)&quot;&quot;&quot;

        user_id = request_record[&#x27;user_id&#x27;]

        # Check if erasure is possible
        erasure_assessment = self._assess_erasure_eligibility(user_id)

        if not erasure_assessment[&#x27;eligible&#x27;]:
            request_record[&#x27;status&#x27;] = RequestStatus.REJECTED
            request_record[&#x27;rejection_reason&#x27;] = erasure_assessment[&#x27;reason&#x27;]

            return {
                &#x27;success&#x27;: False,
                &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
                &#x27;status&#x27;: &#x27;rejected&#x27;,
                &#x27;reason&#x27;: erasure_assessment[&#x27;reason&#x27;],
                &#x27;explanation&#x27;: erasure_assessment[&#x27;explanation&#x27;]
            }

        # Perform erasure
        erasure_results = {
            &#x27;account_data&#x27;: &#x27;deleted&#x27;,
            &#x27;usage_history&#x27;: &#x27;deleted&#x27;,
            &#x27;comments_posts&#x27;: &#x27;anonymized&#x27;,  # May need to retain for others
            &#x27;legal_records&#x27;: &#x27;retained&#x27;,     # Legal obligation
            &#x27;security_logs&#x27;: &#x27;anonymized&#x27;    # Security purposes
        }

        request_record[&#x27;status&#x27;] = RequestStatus.PARTIALLY_COMPLETED
        request_record[&#x27;completion_date&#x27;] = datetime.now()
        request_record[&#x27;erasure_results&#x27;] = erasure_results

        return {
            &#x27;success&#x27;: True,
            &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
            &#x27;status&#x27;: &#x27;partially_completed&#x27;,
            &#x27;erasure_results&#x27;: erasure_results,
            &#x27;explanation&#x27;: &#x27;Some data retained due to legal obligations or legitimate interests&#x27;
        }

    def _process_portability_request(self, request_record: Dict[str, any]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Process data portability request (Article 20)&quot;&quot;&quot;

        user_id = request_record[&#x27;user_id&#x27;]

        # Extract portable data (data provided by user or generated through use)
        portable_data = {
            &#x27;personal_information&#x27;: {
                &#x27;name&#x27;: &#x27;Student Name&#x27;,
                &#x27;email&#x27;: &#x27;student@example.com&#x27;,
                &#x27;preferences&#x27;: {
                    &#x27;language&#x27;: &#x27;en&#x27;,
                    &#x27;timezone&#x27;: &#x27;UTC&#x27;,
                    &#x27;notifications&#x27;: True
                }
            },
            &#x27;user_generated_content&#x27;: {
                &#x27;assignments&#x27;: [
                    {&#x27;title&#x27;: &#x27;Math Assignment 1&#x27;, &#x27;submitted_date&#x27;: &#x27;2024-01-15&#x27;, &#x27;score&#x27;: 85},
                    {&#x27;title&#x27;: &#x27;Science Project&#x27;, &#x27;submitted_date&#x27;: &#x27;2024-02-20&#x27;, &#x27;score&#x27;: 92}
                ],
                &#x27;forum_posts&#x27;: [
                    {&#x27;date&#x27;: &#x27;2024-03-01&#x27;, &#x27;content&#x27;: &#x27;Great lesson on quantum physics!&#x27;}
                ]
            },
            &#x27;usage_data&#x27;: {
                &#x27;course_completions&#x27;: [&#x27;Mathematics 101&#x27;, &#x27;Physics 201&#x27;],
                &#x27;login_history&#x27;: [&#x27;2024-09-01&#x27;, &#x27;2024-09-15&#x27;, &#x27;2024-09-17&#x27;],
                &#x27;feature_usage&#x27;: {
                    &#x27;assignments&#x27;: 45,
                    &#x27;forums&#x27;: 12,
                    &#x27;grades&#x27;: 38
                }
            }
        }

        # Generate portable format (JSON)
        import json
        portable_json = json.dumps(portable_data, indent=2, default=str)

        request_record[&#x27;status&#x27;] = RequestStatus.COMPLETED
        request_record[&#x27;completion_date&#x27;] = datetime.now()
        request_record[&#x27;portable_data&#x27;] = portable_data

        return {
            &#x27;success&#x27;: True,
            &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
            &#x27;status&#x27;: &#x27;completed&#x27;,
            &#x27;format&#x27;: &#x27;JSON&#x27;,
            &#x27;size_bytes&#x27;: len(portable_json.encode(&#x27;utf-8&#x27;)),
            &#x27;download_instructions&#x27;: &#x27;Data package will be available via secure link for 30 days&#x27;
        }

    def _process_consent_withdrawal(self, request_record: Dict[str, any]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Process consent withdrawal (Article 7)&quot;&quot;&quot;

        user_id = request_record[&#x27;user_id&#x27;]

        # Find all consent-based processing
        consent_processing = {
            &#x27;marketing_emails&#x27;: {&#x27;status&#x27;: &#x27;withdrawn&#x27;, &#x27;processing_stopped&#x27;: True},
            &#x27;analytics_tracking&#x27;: {&#x27;status&#x27;: &#x27;withdrawn&#x27;, &#x27;processing_stopped&#x27;: True},
            &#x27;personalization&#x27;: {&#x27;status&#x27;: &#x27;withdrawn&#x27;, &#x27;processing_stopped&#x27;: True}
        }

        # Immediate processing (no delay allowed)
        request_record[&#x27;status&#x27;] = RequestStatus.COMPLETED
        request_record[&#x27;completion_date&#x27;] = datetime.now()
        request_record[&#x27;processing_stopped&#x27;] = consent_processing

        return {
            &#x27;success&#x27;: True,
            &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
            &#x27;status&#x27;: &#x27;completed&#x27;,
            &#x27;processing_stopped&#x27;: list(consent_processing.keys()),
            &#x27;effective_immediately&#x27;: True,
            &#x27;data_retention&#x27;: &#x27;Consent-based data will be deleted within 30 days&#x27;
        }

    def _assess_erasure_eligibility(self, user_id: str) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Assess whether data can be erased under GDPR Article 17&quot;&quot;&quot;

        # Check grounds for retaining data
        retention_grounds = []

        # Check for legal obligations
        legal_obligations = self._check_legal_obligations(user_id)
        if legal_obligations:
            retention_grounds.extend(legal_obligations)

        # Check for legitimate interests
        legitimate_interests = self._check_legitimate_interests(user_id)
        if legitimate_interests:
            retention_grounds.extend(legitimate_interests)

        # Check for public interest
        public_interest = self._check_public_interest(user_id)
        if public_interest:
            retention_grounds.extend(public_interest)

        if retention_grounds:
            return {
                &#x27;eligible&#x27;: False,
                &#x27;reason&#x27;: &#x27;Data retention required&#x27;,
                &#x27;explanation&#x27;: f&quot;Data must be retained due to: {&#x27;, &#x27;.join(retention_grounds)}&quot;,
                &#x27;grounds&#x27;: retention_grounds
            }

        return {
            &#x27;eligible&#x27;: True,
            &#x27;reason&#x27;: &#x27;No grounds for retention&#x27;,
            &#x27;explanation&#x27;: &#x27;Data can be erased as requested&#x27;
        }

    def _check_legal_obligations(self, user_id: str) -&gt; List[str]:
        &quot;&quot;&quot;Check for legal obligations to retain data&quot;&quot;&quot;
        obligations = []

        # Example: Educational records retention
        obligations.append(&quot;Educational records retention (7 years)&quot;)

        # Example: Financial records
        obligations.append(&quot;Financial transaction records (tax law)&quot;)

        return obligations

    def _check_legitimate_interests(self, user_id: str) -&gt; List[str]:
        &quot;&quot;&quot;Check for legitimate interests in retaining data&quot;&quot;&quot;
        interests = []

        # Example: Fraud prevention
        interests.append(&quot;Fraud prevention and security&quot;)

        # Example: Academic integrity
        interests.append(&quot;Academic integrity enforcement&quot;)

        return interests

    def _check_public_interest(self, user_id: str) -&gt; List[str]:
        &quot;&quot;&quot;Check for public interest in retaining data&quot;&quot;&quot;
        # For educational institutions, limited public interest grounds
        return []

    def _process_generic_request(self, request_record: Dict[str, any]) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Process other types of requests&quot;&quot;&quot;

        request_record[&#x27;status&#x27;] = RequestStatus.UNDER_REVIEW
        request_record[&#x27;processing_log&#x27;].append({
            &#x27;timestamp&#x27;: datetime.now().isoformat(),
            &#x27;action&#x27;: &#x27;Request under review&#x27;,
            &#x27;details&#x27;: &#x27;Manual review required for this request type&#x27;
        })

        return {
            &#x27;success&#x27;: True,
            &#x27;request_id&#x27;: request_record[&#x27;request_id&#x27;],
            &#x27;status&#x27;: &#x27;under_review&#x27;,
            &#x27;estimated_completion&#x27;: (datetime.now() + timedelta(days=15)).isoformat(),
            &#x27;next_steps&#x27;: &#x27;Request is being reviewed by privacy team&#x27;
        }

    def generate_gdpr_compliance_report(self) -&gt; Dict[str, any]:
        &quot;&quot;&quot;Generate GDPR compliance status report&quot;&quot;&quot;

        total_requests = len(self.data_subject_requests)
        completed_requests = len([r for r in self.data_subject_requests.values() if r[&#x27;status&#x27;] == RequestStatus.COMPLETED])

        # Calculate response times
        response_times = []
        for request in self.data_subject_requests.values():
            if request[&#x27;status&#x27;] == RequestStatus.COMPLETED:
                response_time = (request[&#x27;completion_date&#x27;] - request[&#x27;received_date&#x27;]).days
                response_times.append(response_time)

        avg_response_time = sum(response_times) / len(response_times) if response_times else 0

        # Check for overdue requests
        overdue_requests = []
        for request in self.data_subject_requests.values():
            if (request[&#x27;status&#x27;] not in [RequestStatus.COMPLETED, RequestStatus.REJECTED] and 
                datetime.now() &gt; request[&#x27;response_deadline&#x27;]):
                overdue_requests.append(request[&#x27;request_id&#x27;])

        return {
            &#x27;report_date&#x27;: datetime.now().isoformat(),
            &#x27;request_statistics&#x27;: {
                &#x27;total_requests&#x27;: total_requests,
                &#x27;completed_requests&#x27;: completed_requests,
                &#x27;completion_rate&#x27;: (completed_requests / total_requests * 100) if total_requests &gt; 0 else 0,
                &#x27;average_response_days&#x27;: round(avg_response_time, 1),
                &#x27;overdue_requests&#x27;: len(overdue_requests)
            },
            &#x27;request_types&#x27;: {
                request_type.value: len([r for r in self.data_subject_requests.values() 
                                       if r[&#x27;request_type&#x27;] == request_type.value])
                for request_type in GDPRRights
            },
            &#x27;compliance_status&#x27;: {
                &#x27;gdpr_compliant&#x27;: len(overdue_requests) == 0,
                &#x27;areas_of_concern&#x27;: overdue_requests,
                &#x27;recommendations&#x27;: self._generate_compliance_recommendations(overdue_requests, avg_response_time)
            }
        }

    def _generate_compliance_recommendations(self, overdue_requests: List[str], 
                                           avg_response_time: float) -&gt; List[str]:
        &quot;&quot;&quot;Generate recommendations for improving GDPR compliance&quot;&quot;&quot;

        recommendations = []

        if overdue_requests:
            recommendations.append(&quot;Address overdue data subject requests immediately&quot;)

        if avg_response_time &gt; 25:  # Close to 30-day limit
            recommendations.append(&quot;Improve response time for data subject requests&quot;)

        recommendations.append(&quot;Regular staff training on GDPR procedures&quot;)
        recommendations.append(&quot;Automated monitoring of request deadlines&quot;)
        recommendations.append(&quot;Regular privacy impact assessments for new projects&quot;)

        return recommendations

# Demonstration of GDPR compliance
def demonstrate_gdpr_compliance():
    &quot;&quot;&quot;Demonstrate GDPR compliance management&quot;&quot;&quot;

    print(&quot;=== GDPR Compliance Demo ===&quot;)

    gdpr_manager = GDPRComplianceManager()

    # Simulate various data subject requests
    print(&quot;1. Processing data subject requests...&quot;)

    test_requests = [
        (&quot;user_001&quot;, GDPRRights.ACCESS, &quot;Request copy of all my personal data&quot;),
        (&quot;user_002&quot;, GDPRRights.ERASURE, &quot;Please delete my account and all associated data&quot;),
        (&quot;user_003&quot;, GDPRRights.DATA_PORTABILITY, &quot;Export my data to transfer to another service&quot;),
        (&quot;user_004&quot;, GDPRRights.WITHDRAW_CONSENT, &quot;Withdraw consent for marketing emails&quot;)
    ]

    for user_id, request_type, details in test_requests:
        result = gdpr_manager.handle_data_subject_request(
            user_id, request_type, details, identity_verified=True
        )

        status_icon = &quot;✅&quot; if result[&#x27;success&#x27;] else &quot;❌&quot;
        print(f&quot;  {status_icon} {request_type.value} for {user_id}: {result.get(&#x27;status&#x27;, &#x27;failed&#x27;)}&quot;)

        if not result[&#x27;success&#x27;]:
            print(f&quot;    Error: {result.get(&#x27;error&#x27;, &#x27;Unknown error&#x27;)}&quot;)

    # Generate compliance report
    print(&quot;\n2. GDPR compliance report...&quot;)

    compliance_report = gdpr_manager.generate_gdpr_compliance_report()

    print(&quot;Request Statistics:&quot;)
    stats = compliance_report[&#x27;request_statistics&#x27;]
    print(f&quot;  Total requests: {stats[&#x27;total_requests&#x27;]}&quot;)
    print(f&quot;  Completion rate: {stats[&#x27;completion_rate&#x27;]:.1f}%&quot;)
    print(f&quot;  Average response time: {stats[&#x27;average_response_days&#x27;]} days&quot;)
    print(f&quot;  Overdue requests: {stats[&#x27;overdue_requests&#x27;]}&quot;)

    print(&quot;\nRequest Types:&quot;)
    for request_type, count in compliance_report[&#x27;request_types&#x27;].items():
        if count &gt; 0:
            print(f&quot;  {request_type}: {count}&quot;)

    compliance_status = compliance_report[&#x27;compliance_status&#x27;]
    compliance_icon = &quot;✅&quot; if compliance_status[&#x27;gdpr_compliant&#x27;] else &quot;⚠️&quot;
    print(f&quot;\nGDPR Compliant: {compliance_icon} {compliance_status[&#x27;gdpr_compliant&#x27;]}&quot;)

    if compliance_status[&#x27;recommendations&#x27;]:
        print(&quot;\nRecommendations:&quot;)
        for i, rec in enumerate(compliance_status[&#x27;recommendations&#x27;][:3], 1):
            print(f&quot;  {i}. {rec}&quot;)
</code></pre>
</div>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p><strong>Privacy by Design creates sustainable, trustworthy systems through proactive privacy protection:</strong></p>
<p><strong>Data Minimization:</strong></p>
<ul>
<li>
<p><strong>Collect only necessary data</strong> for specified purposes</p>
</li>
<li>
<p><strong>Reject excessive data collection</strong> during system design</p>
</li>
<li>
<p><strong>Categorize data by sensitivity</strong> and apply appropriate protections</p>
</li>
<li>
<p><strong>Document collection rationale</strong> for transparency and compliance</p>
</li>
</ul>
<p><strong>Consent Management:</strong></p>
<ul>
<li>
<p><strong>Obtain explicit consent</strong> for non-essential processing</p>
</li>
<li>
<p><strong>Provide clear information</strong> about data use and rights</p>
</li>
<li>
<p><strong>Enable easy consent withdrawal</strong> without service penalties</p>
</li>
<li>
<p><strong>Maintain detailed consent records</strong> for accountability</p>
</li>
</ul>
<p><strong>Purpose Limitation and Retention:</strong></p>
<ul>
<li>
<p><strong>Use data only for declared purposes</strong> to prevent scope creep</p>
</li>
<li>
<p><strong>Implement automated deletion</strong> based on retention policies</p>
</li>
<li>
<p><strong>Regular review and cleanup</strong> of unnecessary data</p>
</li>
<li>
<p><strong>Legal basis assessment</strong> for all processing activities</p>
</li>
</ul>
<p><strong>Privacy Impact Assessments:</strong></p>
<ul>
<li>
<p><strong>Systematic privacy risk evaluation</strong> for new projects</p>
</li>
<li>
<p><strong>Early identification and mitigation</strong> of privacy risks</p>
</li>
<li>
<p><strong>Documentation of design decisions</strong> and their privacy implications</p>
</li>
<li>
<p><strong>Stakeholder consultation</strong> when high risks are identified</p>
</li>
</ul>
<p><strong>GDPR Compliance:</strong></p>
<ul>
<li>
<p><strong>Robust data subject rights procedures</strong> with defined response times</p>
</li>
<li>
<p><strong>Clear legal basis</strong> for all processing activities</p>
</li>
<li>
<p><strong>Comprehensive documentation</strong> of processing activities</p>
</li>
<li>
<p><strong>Regular compliance monitoring</strong> and improvement</p>
</li>
</ul>
<p><strong>Implementation best practices:</strong></p>
<ul>
<li>
<p><strong>Privacy by default</strong>: Most privacy-friendly settings as standard</p>
</li>
<li>
<p><strong>Technical and organizational measures</strong>: Both code and procedures matter</p>
</li>
<li>
<p><strong>Regular training</strong>: Keep staff updated on privacy requirements</p>
</li>
<li>
<p><strong>Continuous improvement</strong>: Regular review and enhancement of privacy protections</p>
</li>
</ul>
<p>Understanding and implementing Privacy by Design principles creates software systems that respect user privacy, comply with legal requirements, and build lasting trust with users while maintaining functional excellence.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 15, 2025 07:03:58 UTC">October 15, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 – <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>