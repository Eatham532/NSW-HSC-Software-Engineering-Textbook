
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-01-Input-Validation-and-Sanitization/">
      
      
        <link rel="prev" href="../../Chapter-15-Core-Security-Principles/15-02-Cryptography-and-Data-Protection/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Content - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-161-input-validation-sanitization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> – content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Secure Software Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-14-Security-Foundations/14-01-The-Business-Case-for-Security/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 14 — Security Foundations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-15-Core-Security-Principles/15-01-Security-Fundamentals-CIA-Triad-and-AAA/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 15 — Core Security Principles
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 16 — Input Security and Data Protection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 16 — Input Security and Data Protection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1" id="__nav_3_2_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    16.1 Input Validation and Sanitization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            16.1 Input Validation and Sanitization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-input-validation-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Input Validation Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerable-code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Code Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-implementation-with-parameterized-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Implementation with Parameterized Queries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-site-scripting-xss-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Site Scripting (XSS) Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Site Scripting (XSS) Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-xss-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Types of XSS Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-input-sanitization-and-output-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Input Sanitization and Output Encoding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-validation-strategies-whitelist-vs-blacklist" class="md-nav__link">
    <span class="md-ellipsis">
      Input Validation Strategies: Whitelist vs Blacklist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Validation Strategies: Whitelist vs Blacklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whitelist-approach-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Whitelist Approach (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blacklist-approach-use-with-caution" class="md-nav__link">
    <span class="md-ellipsis">
      Blacklist Approach (Use with Caution)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#safe-error-message-design" class="md-nav__link">
    <span class="md-ellipsis">
      Safe Error Message Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-upload-security" class="md-nav__link">
    <span class="md-ellipsis">
      File Upload Security
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../16-02-Privacy-by-Design/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    16.2 Privacy by Design
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-17-System-Security-and-APIs/17-01-Secure-API-Design/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 17 — System Security and APIs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-18-Security-Testing-and-Vulnerabilities/18-01-Security-Testing-Fundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 18 — Security Testing & Vulnerabilities
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-19-Security-in-Context/19-01-Security-in-Development-Teams/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 19 — Security in Context
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareAutomation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-input-validation-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Input Validation Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerable-code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerable Code Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-implementation-with-parameterized-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Implementation with Parameterized Queries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-site-scripting-xss-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Site Scripting (XSS) Prevention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Site Scripting (XSS) Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-xss-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Types of XSS Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-input-sanitization-and-output-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Input Sanitization and Output Encoding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-validation-strategies-whitelist-vs-blacklist" class="md-nav__link">
    <span class="md-ellipsis">
      Input Validation Strategies: Whitelist vs Blacklist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Validation Strategies: Whitelist vs Blacklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whitelist-approach-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Whitelist Approach (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blacklist-approach-use-with-caution" class="md-nav__link">
    <span class="md-ellipsis">
      Blacklist Approach (Use with Caution)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#safe-error-message-design" class="md-nav__link">
    <span class="md-ellipsis">
      Safe Error Message Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-upload-security" class="md-nav__link">
    <span class="md-ellipsis">
      File Upload Security
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-01-Input-Validation-and-Sanitization/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/SecureSoftwareArchitecture/Chapter-16-Input-Security-and-Data-Protection/16-01-Input-Validation-and-Sanitization/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="section-161-input-validation-sanitization">Section 16.1: Input Validation &amp; Sanitization<a class="headerlink" href="#section-161-input-validation-sanitization" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>By the end of this section, you will be able to:</p>
<ul>
<li>
<p><strong>Prevent SQL injection attacks</strong> through proper input validation and parameterized queries</p>
</li>
<li>
<p><strong>Mitigate XSS (Cross-Site Scripting)</strong> vulnerabilities with input sanitization and output encoding</p>
</li>
<li>
<p><strong>Apply input validation strategies</strong> using whitelist and blacklist approaches effectively</p>
</li>
<li>
<p><strong>Design safe error messages</strong> that don&rsquo;t leak sensitive system information</p>
</li>
<li>
<p><strong>Implement secure file upload</strong> functionality with proper validation and restrictions</p>
</li>
</ul>
<h2 id="why-input-validation-matters">Why Input Validation Matters<a class="headerlink" href="#why-input-validation-matters" title="Permanent link">&para;</a></h2>
<p>Input validation is the first line of defense against many of the most dangerous web application vulnerabilities. According to the OWASP Top 10, injection attacks consistently rank as the #1 security risk.</p>
<p><strong>Without proper input validation:</strong></p>
<ul>
<li>
<p>Attackers can inject malicious SQL commands to access or modify database data</p>
</li>
<li>
<p>Cross-site scripting attacks can steal user sessions and execute malicious scripts</p>
</li>
<li>
<p>File uploads can introduce malware or allow system compromise</p>
</li>
<li>
<p>Data corruption can occur from malformed input</p>
</li>
<li>
<p>System resources can be exhausted through malicious input</p>
</li>
</ul>
<h2 id="sql-injection-prevention">SQL Injection Prevention<a class="headerlink" href="#sql-injection-prevention" title="Permanent link">&para;</a></h2>
<p>SQL injection occurs when user input is directly concatenated into SQL queries, allowing attackers to inject malicious SQL commands.</p>
<h3 id="vulnerable-code-example">Vulnerable Code Example<a class="headerlink" href="#vulnerable-code-example" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># VULNERABLE: Never do this!</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user_vulnerable</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Example of vulnerable SQL injection code - DO NOT USE&quot;&quot;&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;users.db&#39;</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Dangerous: Direct string concatenation</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE username = &#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password = &#39;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># This would reveal the vulnerability</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c1"># How an attacker could exploit this:</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="c1"># username: admin&#39; OR &#39;1&#39;=&#39;1&#39; --</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c1"># This creates the query: SELECT * FROM users WHERE username = &#39;admin&#39; OR &#39;1&#39;=&#39;1&#39; --&#39; AND password = &#39;...&#39;</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c1"># The -- comments out the password check, bypassing authentication</span>
</span></code></pre></div>
<h3 id="secure-implementation-with-parameterized-queries">Secure Implementation with Parameterized Queries<a class="headerlink" href="#secure-implementation-with-parameterized-queries" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import sqlite3
import hashlib
import secrets
from typing import Optional, Dict, Any

class SecureDatabaseManager:
    def __init__(self, db_path: str = &quot;secure_users.db&quot;):
        self.db_path = db_path
        self.setup_database()

    def setup_database(self):
        &quot;&quot;&quot;Initialize database with secure schema&quot;&quot;&quot;
        conn = sqlite3.connect(self.db_path)
        cursor = conn.cursor()

        # Create users table with proper constraints
        cursor.execute(&#x27;&#x27;&#x27;
            CREATE TABLE IF NOT EXISTS users (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                username TEXT UNIQUE NOT NULL,
                email TEXT UNIQUE NOT NULL,
                password_hash TEXT NOT NULL,
                salt TEXT NOT NULL,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                last_login TIMESTAMP,
                failed_login_attempts INTEGER DEFAULT 0,
                account_locked BOOLEAN DEFAULT FALSE
            )
        &#x27;&#x27;&#x27;)

        # Create audit log table
        cursor.execute(&#x27;&#x27;&#x27;
            CREATE TABLE IF NOT EXISTS audit_log (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER,
                action TEXT NOT NULL,
                ip_address TEXT,
                timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                success BOOLEAN,
                details TEXT
            )
        &#x27;&#x27;&#x27;)

        conn.commit()
        conn.close()

    def authenticate_user(self, username: str, password: str, ip_address: str = &quot;unknown&quot;) -&gt; Optional[Dict[str, Any]]:
        &quot;&quot;&quot;Securely authenticate user with parameterized queries&quot;&quot;&quot;

        if not self._validate_username(username) or not self._validate_password(password):
            self._log_authentication_attempt(None, &quot;authentication&quot;, ip_address, False, &quot;Invalid input format&quot;)
            return None

        conn = sqlite3.connect(self.db_path)
        cursor = conn.cursor()

        try:
            # Use parameterized query to prevent SQL injection
            cursor.execute(&#x27;&#x27;&#x27;
                SELECT id, username, email, password_hash, salt, account_locked, failed_login_attempts
                FROM users 
                WHERE username = ? AND account_locked = FALSE
            &#x27;&#x27;&#x27;, (username,))

            user_data = cursor.fetchone()

            if not user_data:
                self._log_authentication_attempt(None, &quot;authentication&quot;, ip_address, False, &quot;User not found or locked&quot;)
                return None

            user_id, username, email, password_hash, salt, account_locked, failed_attempts = user_data

            # Verify password
            provided_hash = self._hash_password(password, salt)

            if secrets.compare_digest(provided_hash, password_hash):
                # Successful authentication
                cursor.execute(&#x27;&#x27;&#x27;
                    UPDATE users 
                    SET last_login = CURRENT_TIMESTAMP, failed_login_attempts = 0
                    WHERE id = ?
                &#x27;&#x27;&#x27;, (user_id,))

                self._log_authentication_attempt(user_id, &quot;authentication&quot;, ip_address, True, &quot;Successful login&quot;)

                conn.commit()

                return {
                    &#x27;id&#x27;: user_id,
                    &#x27;username&#x27;: username,
                    &#x27;email&#x27;: email,
                    &#x27;authenticated&#x27;: True
                }
            else:
                # Failed authentication - increment failed attempts
                new_failed_attempts = failed_attempts + 1
                account_locked = new_failed_attempts &gt;= 5

                cursor.execute(&#x27;&#x27;&#x27;
                    UPDATE users 
                    SET failed_login_attempts = ?, account_locked = ?
                    WHERE id = ?
                &#x27;&#x27;&#x27;, (new_failed_attempts, account_locked, user_id))

                self._log_authentication_attempt(user_id, &quot;authentication&quot;, ip_address, False, 
                                               f&quot;Failed password attempt {new_failed_attempts}&quot;)

                conn.commit()
                return None

        except sqlite3.Error as e:
            self._log_authentication_attempt(None, &quot;authentication&quot;, ip_address, False, f&quot;Database error: {str(e)}&quot;)
            return None
        finally:
            conn.close()

    def create_user(self, username: str, email: str, password: str) -&gt; bool:
        &quot;&quot;&quot;Securely create new user with input validation&quot;&quot;&quot;

        # Validate all inputs
        validation_errors = []

        if not self._validate_username(username):
            validation_errors.append(&quot;Invalid username format&quot;)

        if not self._validate_email(email):
            validation_errors.append(&quot;Invalid email format&quot;)

        if not self._validate_password_strength(password):
            validation_errors.append(&quot;Password does not meet security requirements&quot;)

        if validation_errors:
            return False, validation_errors

        # Generate salt and hash password
        salt = secrets.token_hex(32)
        password_hash = self._hash_password(password, salt)

        conn = sqlite3.connect(self.db_path)
        cursor = conn.cursor()

        try:
            # Use parameterized query to safely insert user
            cursor.execute(&#x27;&#x27;&#x27;
                INSERT INTO users (username, email, password_hash, salt)
                VALUES (?, ?, ?, ?)
            &#x27;&#x27;&#x27;, (username, email, password_hash, salt))

            user_id = cursor.lastrowid

            self._log_authentication_attempt(user_id, &quot;user_creation&quot;, &quot;system&quot;, True, &quot;User created successfully&quot;)

            conn.commit()
            return True, &quot;User created successfully&quot;

        except sqlite3.IntegrityError as e:
            if &quot;username&quot; in str(e):
                return False, [&quot;Username already exists&quot;]
            elif &quot;email&quot; in str(e):
                return False, [&quot;Email already registered&quot;]
            else:
                return False, [&quot;User creation failed&quot;]
        except sqlite3.Error:
            return False, [&quot;Database error occurred&quot;]
        finally:
            conn.close()

    def search_users(self, search_term: str, search_type: str = &quot;username&quot;) -&gt; list:
        &quot;&quot;&quot;Securely search users with parameterized queries&quot;&quot;&quot;

        if not self._validate_search_input(search_term, search_type):
            return []

        conn = sqlite3.connect(self.db_path)
        cursor = conn.cursor()

        try:
            if search_type == &quot;username&quot;:
                # Use LIKE with parameterized query for safe search
                cursor.execute(&#x27;&#x27;&#x27;
                    SELECT id, username, email, created_at
                    FROM users
                    WHERE username LIKE ? AND account_locked = FALSE
                    LIMIT 50
                &#x27;&#x27;&#x27;, (f&quot;%{search_term}%&quot;,))

            elif search_type == &quot;email&quot;:
                cursor.execute(&#x27;&#x27;&#x27;
                    SELECT id, username, email, created_at
                    FROM users
                    WHERE email LIKE ? AND account_locked = FALSE
                    LIMIT 50
                &#x27;&#x27;&#x27;, (f&quot;%{search_term}%&quot;,))

            results = cursor.fetchall()

            return [
                {
                    &#x27;id&#x27;: row[0],
                    &#x27;username&#x27;: row[1],
                    &#x27;email&#x27;: row[2],
                    &#x27;created_at&#x27;: row[3]
                }
                for row in results
            ]

        except sqlite3.Error:
            return []
        finally:
            conn.close()

    def _validate_username(self, username: str) -&gt; bool:
        &quot;&quot;&quot;Validate username format&quot;&quot;&quot;
        if not username or len(username) &lt; 3 or len(username) &gt; 50:
            return False

        # Only allow alphanumeric characters and underscores
        import re
        return bool(re.match(r&#x27;^[a-zA-Z0-9_]+$&#x27;, username))

    def _validate_email(self, email: str) -&gt; bool:
        &quot;&quot;&quot;Validate email format&quot;&quot;&quot;
        if not email or len(email) &gt; 254:
            return False

        import re
        email_pattern = r&#x27;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#x27;
        return bool(re.match(email_pattern, email))

    def _validate_password(self, password: str) -&gt; bool:
        &quot;&quot;&quot;Basic password validation&quot;&quot;&quot;
        return password and len(password) &lt;= 128  # Prevent DoS through large passwords

    def _validate_password_strength(self, password: str) -&gt; bool:
        &quot;&quot;&quot;Validate password meets security requirements&quot;&quot;&quot;
        if not password or len(password) &lt; 8 or len(password) &gt; 128:
            return False

        # Check for required character types
        has_upper = any(c.isupper() for c in password)
        has_lower = any(c.islower() for c in password)
        has_digit = any(c.isdigit() for c in password)
        has_special = any(c in &quot;!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?&quot; for c in password)

        return has_upper and has_lower and has_digit and has_special

    def _validate_search_input(self, search_term: str, search_type: str) -&gt; bool:
        &quot;&quot;&quot;Validate search parameters&quot;&quot;&quot;
        if not search_term or len(search_term) &gt; 100:
            return False

        if search_type not in [&quot;username&quot;, &quot;email&quot;]:
            return False

        # Prevent injection through search terms
        dangerous_chars = [&quot;&#x27;&quot;, &#x27;&quot;&#x27;, &quot;;&quot;, &quot;--&quot;, &quot;/*&quot;, &quot;*/&quot;, &quot;xp_&quot;, &quot;sp_&quot;]
        search_lower = search_term.lower()

        return not any(dangerous in search_lower for dangerous in dangerous_chars)

    def _hash_password(self, password: str, salt: str) -&gt; str:
        &quot;&quot;&quot;Hash password with salt&quot;&quot;&quot;
        return hashlib.pbkdf2_hmac(&#x27;sha256&#x27;, password.encode(), salt.encode(), 100000).hex()

    def _log_authentication_attempt(self, user_id: Optional[int], action: str, 
                                  ip_address: str, success: bool, details: str):
        &quot;&quot;&quot;Log authentication attempts for security monitoring&quot;&quot;&quot;
        conn = sqlite3.connect(self.db_path)
        cursor = conn.cursor()

        try:
            cursor.execute(&#x27;&#x27;&#x27;
                INSERT INTO audit_log (user_id, action, ip_address, success, details)
                VALUES (?, ?, ?, ?, ?)
            &#x27;&#x27;&#x27;, (user_id, action, ip_address, success, details))

            conn.commit()
        except sqlite3.Error:
            pass  # Don&#x27;t let logging errors affect main functionality
        finally:
            conn.close()

# Demonstration of SQL injection protection
def demonstrate_sql_injection_protection():
    &quot;&quot;&quot;Demonstrate secure database operations&quot;&quot;&quot;

    print(&quot;=== SQL Injection Protection Demo ===&quot;)

    db_manager = SecureDatabaseManager()

    # Create test users
    test_users = [
        (&quot;admin&quot;, &quot;admin@school.edu&quot;, &quot;SecurePassword123!&quot;),
        (&quot;student1&quot;, &quot;student1@school.edu&quot;, &quot;MyPassword456@&quot;),
        (&quot;teacher&quot;, &quot;teacher@school.edu&quot;, &quot;TeachPass789#&quot;)
    ]

    print(&quot;Creating test users...&quot;)
    for username, email, password in test_users:
        success, message = db_manager.create_user(username, email, password)
        print(f&quot;  {username}: {message}&quot;)

    print(&quot;\n=== Testing Legitimate Authentication ===&quot;)

    # Test legitimate login
    user = db_manager.authenticate_user(&quot;admin&quot;, &quot;SecurePassword123!&quot;, &quot;192.168.1.100&quot;)
    if user:
        print(f&quot;✅ Successful login: {user[&#x27;username&#x27;]}&quot;)
    else:
        print(&quot;❌ Authentication failed&quot;)

    print(&quot;\n=== Testing SQL Injection Attempts ===&quot;)

    # Common SQL injection attempts that would fail
    injection_attempts = [
        (&quot;admin&#x27; OR &#x27;1&#x27;=&#x27;1&#x27; --&quot;, &quot;anything&quot;),
        (&quot;admin&#x27;; DROP TABLE users; --&quot;, &quot;password&quot;),
        (&quot;&#x27; UNION SELECT * FROM users --&quot;, &quot;test&quot;),
        (&quot;admin&#x27; OR 1=1 #&quot;, &quot;password&quot;)
    ]

    for malicious_username, password in injection_attempts:
        print(f&quot;Attempting injection: {malicious_username}&quot;)
        user = db_manager.authenticate_user(malicious_username, password, &quot;192.168.1.200&quot;)

        if user:
            print(&quot;  ❌ SECURITY BREACH: Injection successful!&quot;)
        else:
            print(&quot;  ✅ Injection blocked by parameterized queries&quot;)

    print(&quot;\n=== Testing Secure Search ===&quot;)

    # Test search functionality
    search_results = db_manager.search_users(&quot;admin&quot;, &quot;username&quot;)
    print(f&quot;Search results for &#x27;admin&#x27;: {len(search_results)} users found&quot;)

    # Test search with potential injection
    malicious_search = &quot;&#x27;; DROP TABLE users; --&quot;
    search_results = db_manager.search_users(malicious_search, &quot;username&quot;)
    print(f&quot;Malicious search results: {len(search_results)} users found (should be 0)&quot;)
</code></pre>
</div>
<h2 id="cross-site-scripting-xss-prevention">Cross-Site Scripting (XSS) Prevention<a class="headerlink" href="#cross-site-scripting-xss-prevention" title="Permanent link">&para;</a></h2>
<p>XSS attacks inject malicious scripts into web applications that execute in other users&rsquo; browsers, potentially stealing sessions, credentials, or personal data.</p>
<h3 id="types-of-xss-attacks">Types of XSS Attacks<a class="headerlink" href="#types-of-xss-attacks" title="Permanent link">&para;</a></h3>
<p><strong>Stored XSS</strong>: Malicious script stored in database and executed when data is displayed
<strong>Reflected XSS</strong>: Malicious script reflected back from server in response
<strong>DOM-based XSS</strong>: Client-side script modifies page DOM in unsafe way</p>
<h3 id="secure-input-sanitization-and-output-encoding">Secure Input Sanitization and Output Encoding<a class="headerlink" href="#secure-input-sanitization-and-output-encoding" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import html
import re
import bleach
from urllib.parse import quote, unquote
from typing import Dict, List, Any, Optional

class XSSProtectionManager:
    def __init__(self):
        # Define allowed HTML tags and attributes for rich content
        self.allowed_tags = [
            &#x27;p&#x27;, &#x27;br&#x27;, &#x27;strong&#x27;, &#x27;em&#x27;, &#x27;u&#x27;, &#x27;ol&#x27;, &#x27;ul&#x27;, &#x27;li&#x27;, 
            &#x27;h1&#x27;, &#x27;h2&#x27;, &#x27;h3&#x27;, &#x27;h4&#x27;, &#x27;h5&#x27;, &#x27;h6&#x27;, &#x27;blockquote&#x27;
        ]

        self.allowed_attributes = {
            &#x27;*&#x27;: [&#x27;class&#x27;],  # Allow class attribute on all tags
            &#x27;a&#x27;: [&#x27;href&#x27;, &#x27;title&#x27;],  # Allow href and title on links
            &#x27;img&#x27;: [&#x27;src&#x27;, &#x27;alt&#x27;, &#x27;width&#x27;, &#x27;height&#x27;]  # Allow specific attributes on images
        }

        # Protocols allowed in links
        self.allowed_protocols = [&#x27;http&#x27;, &#x27;https&#x27;, &#x27;mailto&#x27;]

    def sanitize_html_input(self, user_input: str, allow_html: bool = False) -&gt; str:
        &quot;&quot;&quot;Sanitize HTML input to prevent XSS attacks&quot;&quot;&quot;

        if not user_input:
            return &quot;&quot;

        if not allow_html:
            # For plain text input, escape all HTML
            return html.escape(user_input)

        # For rich text input, use bleach to allow safe HTML only
        cleaned = bleach.clean(
            user_input,
            tags=self.allowed_tags,
            attributes=self.allowed_attributes,
            protocols=self.allowed_protocols,
            strip=True  # Remove disallowed tags entirely
        )

        return cleaned

    def sanitize_url_parameter(self, param_value: str) -&gt; str:
        &quot;&quot;&quot;Sanitize URL parameters to prevent XSS through URL manipulation&quot;&quot;&quot;

        if not param_value:
            return &quot;&quot;

        # URL decode first to catch double-encoded attacks
        try:
            decoded = unquote(param_value)
        except:
            decoded = param_value

        # Check for common XSS patterns
        dangerous_patterns = [
            r&#x27;&lt;script[^&gt;]*&gt;.*?&lt;/script&gt;&#x27;,
            r&#x27;javascript:&#x27;,
            r&#x27;vbscript:&#x27;,
            r&#x27;onload\s*=&#x27;,
            r&#x27;onerror\s*=&#x27;,
            r&#x27;onclick\s*=&#x27;,
            r&#x27;onmouseover\s*=&#x27;,
            r&#x27;&lt;iframe[^&gt;]*&gt;&#x27;,
            r&#x27;&lt;object[^&gt;]*&gt;&#x27;,
            r&#x27;&lt;embed[^&gt;]*&gt;&#x27;
        ]

        for pattern in dangerous_patterns:
            if re.search(pattern, decoded, re.IGNORECASE):
                return &quot;&quot;  # Reject the entire parameter if dangerous content found

        # Escape HTML entities
        sanitized = html.escape(decoded)

        # Limit length to prevent DoS
        return sanitized[:1000]

    def create_safe_html_output(self, content: Dict[str, Any], context: str = &quot;general&quot;) -&gt; str:
        &quot;&quot;&quot;Create safe HTML output with proper encoding based on context&quot;&quot;&quot;

        if context == &quot;html_content&quot;:
            # For HTML content context
            return self.sanitize_html_input(str(content.get(&#x27;html&#x27;, &#x27;&#x27;)), allow_html=True)

        elif context == &quot;html_attribute&quot;:
            # For HTML attribute context (like title, alt text)
            value = str(content.get(&#x27;text&#x27;, &#x27;&#x27;))
            # Escape quotes and HTML entities
            return html.escape(value, quote=True)

        elif context == &quot;javascript_string&quot;:
            # For JavaScript string context
            value = str(content.get(&#x27;text&#x27;, &#x27;&#x27;))
            # Escape for JavaScript context
            escaped = value.replace(&#x27;\\&#x27;, &#x27;\\\\&#x27;).replace(&quot;&#x27;&quot;, &quot;\\&#x27;&quot;).replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;)
            escaped = escaped.replace(&#x27;\n&#x27;, &#x27;\\n&#x27;).replace(&#x27;\r&#x27;, &#x27;\\r&#x27;).replace(&#x27;\t&#x27;, &#x27;\\t&#x27;)
            return escaped

        elif context == &quot;css_value&quot;:
            # For CSS value context
            value = str(content.get(&#x27;text&#x27;, &#x27;&#x27;))
            # Only allow alphanumeric and safe CSS characters
            safe_css = re.sub(r&#x27;[^a-zA-Z0-9\-_\s#.]&#x27;, &#x27;&#x27;, value)
            return safe_css[:100]  # Limit length

        else:
            # Default: plain text context
            return html.escape(str(content.get(&#x27;text&#x27;, &#x27;&#x27;)))

    def validate_and_sanitize_form_data(self, form_data: Dict[str, str]) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Validate and sanitize form data comprehensively&quot;&quot;&quot;

        sanitized_data = {}
        validation_errors = []

        for field_name, field_value in form_data.items():

            if field_name == &quot;username&quot;:
                sanitized_value = self._sanitize_username(field_value)
                if not sanitized_value:
                    validation_errors.append(f&quot;Invalid username: {field_name}&quot;)
                else:
                    sanitized_data[field_name] = sanitized_value

            elif field_name == &quot;email&quot;:
                sanitized_value = self._sanitize_email(field_value)
                if not sanitized_value:
                    validation_errors.append(f&quot;Invalid email: {field_name}&quot;)
                else:
                    sanitized_data[field_name] = sanitized_value

            elif field_name == &quot;password&quot;:
                # Don&#x27;t log or store raw passwords
                if self._validate_password_format(field_value):
                    sanitized_data[field_name] = field_value  # Keep original for hashing
                else:
                    validation_errors.append(&quot;Password does not meet requirements&quot;)

            elif field_name in [&quot;comment&quot;, &quot;description&quot;, &quot;bio&quot;]:
                # Rich text fields - allow some HTML
                sanitized_value = self.sanitize_html_input(field_value, allow_html=True)
                sanitized_data[field_name] = sanitized_value

            elif field_name == &quot;website_url&quot;:
                sanitized_value = self._sanitize_url(field_value)
                if field_value and not sanitized_value:
                    validation_errors.append(&quot;Invalid website URL&quot;)
                else:
                    sanitized_data[field_name] = sanitized_value

            else:
                # Default: treat as plain text
                sanitized_data[field_name] = self.sanitize_html_input(field_value, allow_html=False)

        return {
            &#x27;data&#x27;: sanitized_data,
            &#x27;errors&#x27;: validation_errors,
            &#x27;is_valid&#x27;: len(validation_errors) == 0
        }

    def _sanitize_username(self, username: str) -&gt; str:
        &quot;&quot;&quot;Sanitize username input&quot;&quot;&quot;
        if not username:
            return &quot;&quot;

        # Remove HTML and limit to alphanumeric plus underscores
        cleaned = html.escape(username.strip())

        # Only allow safe characters
        safe_username = re.sub(r&#x27;[^a-zA-Z0-9_]&#x27;, &#x27;&#x27;, cleaned)

        # Length limits
        if len(safe_username) &lt; 3 or len(safe_username) &gt; 50:
            return &quot;&quot;

        return safe_username

    def _sanitize_email(self, email: str) -&gt; str:
        &quot;&quot;&quot;Sanitize email input&quot;&quot;&quot;
        if not email:
            return &quot;&quot;

        # Basic email validation and sanitization
        cleaned = html.escape(email.strip().lower())

        # Simple email regex validation
        email_pattern = r&#x27;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#x27;

        if re.match(email_pattern, cleaned) and len(cleaned) &lt;= 254:
            return cleaned

        return &quot;&quot;

    def _sanitize_url(self, url: str) -&gt; str:
        &quot;&quot;&quot;Sanitize URL input&quot;&quot;&quot;
        if not url:
            return &quot;&quot;

        cleaned = url.strip()

        # Ensure URL starts with safe protocol
        if not cleaned.startswith((&#x27;http://&#x27;, &#x27;https://&#x27;)):
            cleaned = &#x27;https://&#x27; + cleaned

        # Basic URL validation
        url_pattern = r&#x27;^https?://[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}([/\w.-]*)*/?$&#x27;

        if re.match(url_pattern, cleaned) and len(cleaned) &lt;= 2000:
            return cleaned

        return &quot;&quot;

    def _validate_password_format(self, password: str) -&gt; bool:
        &quot;&quot;&quot;Validate password format without logging content&quot;&quot;&quot;
        if not password:
            return False

        # Length check
        if len(password) &lt; 8 or len(password) &gt; 128:
            return False

        # Check for required character types
        has_upper = any(c.isupper() for c in password)
        has_lower = any(c.islower() for c in password)
        has_digit = any(c.isdigit() for c in password)
        has_special = any(c in &quot;!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?&quot; for c in password)

        return has_upper and has_lower and has_digit and has_special

# Demonstration of XSS protection
def demonstrate_xss_protection():
    &quot;&quot;&quot;Demonstrate XSS protection techniques&quot;&quot;&quot;

    print(&quot;=== XSS Protection Demo ===&quot;)

    xss_manager = XSSProtectionManager()

    # Test various XSS attack vectors
    malicious_inputs = [
        &quot;&lt;script&gt;alert(&#x27;XSS Attack!&#x27;);&lt;/script&gt;&quot;,
        &quot;&lt;img src=&#x27;x&#x27; onerror=&#x27;alert(\&quot;XSS\&quot;)&#x27;&gt;&quot;,
        &quot;javascript:alert(&#x27;XSS&#x27;)&quot;,
        &quot;&lt;iframe src=&#x27;javascript:alert(\&quot;XSS\&quot;)&#x27;&gt;&lt;/iframe&gt;&quot;,
        &quot;&lt;svg onload=&#x27;alert(\&quot;XSS\&quot;)&#x27;&gt;&quot;,
        &quot;Hello &lt;script&gt;document.cookie&lt;/script&gt; World&quot;,
        &quot;&lt;a href=&#x27;javascript:alert(\&quot;XSS\&quot;)&#x27;&gt;Click me&lt;/a&gt;&quot;,
        &quot;&lt;div onclick=&#x27;alert(\&quot;XSS\&quot;)&#x27;&gt;Clickable content&lt;/div&gt;&quot;
    ]

    print(&quot;Testing malicious inputs (plain text context):&quot;)
    for malicious_input in malicious_inputs:
        sanitized = xss_manager.sanitize_html_input(malicious_input, allow_html=False)
        print(f&quot;Input:  {malicious_input}&quot;)
        print(f&quot;Output: {sanitized}&quot;)
        print(f&quot;Safe:   {&#x27;✅&#x27; if &#x27;&lt;script&#x27; not in sanitized and &#x27;javascript:&#x27; not in sanitized else &#x27;❌&#x27;}&quot;)
        print()

    print(&quot;=== Testing Rich Text Sanitization ===&quot;)

    rich_text_inputs = [
        &quot;&lt;p&gt;This is &lt;strong&gt;safe&lt;/strong&gt; HTML content.&lt;/p&gt;&quot;,
        &quot;&lt;p&gt;This has a &lt;script&gt;alert(&#x27;bad&#x27;)&lt;/script&gt; script tag.&lt;/p&gt;&quot;,
        &quot;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;Paragraph with &lt;em&gt;emphasis&lt;/em&gt;&lt;/p&gt;&quot;,
        &quot;&lt;a href=&#x27;https://safe.com&#x27;&gt;Safe link&lt;/a&gt;&quot;,
        &quot;&lt;a href=&#x27;javascript:alert(\&quot;bad\&quot;)&#x27;&gt;Dangerous link&lt;/a&gt;&quot;,
        &quot;&lt;img src=&#x27;image.jpg&#x27; alt=&#x27;Safe image&#x27;&gt;&quot;,
        &quot;&lt;img src=&#x27;x&#x27; onerror=&#x27;alert(\&quot;bad\&quot;)&#x27; alt=&#x27;Dangerous image&#x27;&gt;&quot;
    ]

    for rich_input in rich_text_inputs:
        sanitized = xss_manager.sanitize_html_input(rich_input, allow_html=True)
        print(f&quot;Input:  {rich_input}&quot;)
        print(f&quot;Output: {sanitized}&quot;)
        print()

    print(&quot;=== Testing Form Data Validation ===&quot;)

    # Test form data with mixed content
    test_form_data = {
        &quot;username&quot;: &quot;student&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;123&quot;,
        &quot;email&quot;: &quot;test@example.com&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;,
        &quot;password&quot;: &quot;SecurePass123!&quot;,
        &quot;bio&quot;: &quot;&lt;p&gt;I&#x27;m a student at &lt;strong&gt;Example School&lt;/strong&gt;.&lt;/p&gt;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;,
        &quot;website_url&quot;: &quot;https://mystudentblog.com&quot;,
        &quot;comment&quot;: &quot;This is my comment with &lt;em&gt;emphasis&lt;/em&gt; and &lt;script&gt;bad content&lt;/script&gt;&quot;
    }

    validation_result = xss_manager.validate_and_sanitize_form_data(test_form_data)

    print(&quot;Form validation results:&quot;)
    print(f&quot;Valid: {validation_result[&#x27;is_valid&#x27;]}&quot;)
    print(f&quot;Errors: {validation_result[&#x27;errors&#x27;]}&quot;)

    print(&quot;\nSanitized data:&quot;)
    for field, value in validation_result[&#x27;data&#x27;].items():
        if field != &#x27;password&#x27;:  # Don&#x27;t display password
            print(f&quot;  {field}: {value}&quot;)
</code></pre>
</div>
<h2 id="input-validation-strategies-whitelist-vs-blacklist">Input Validation Strategies: Whitelist vs Blacklist<a class="headerlink" href="#input-validation-strategies-whitelist-vs-blacklist" title="Permanent link">&para;</a></h2>
<p>Understanding when and how to use whitelist (allow-list) and blacklist (deny-list) approaches is crucial for effective input validation.</p>
<h3 id="whitelist-approach-recommended">Whitelist Approach (Recommended)<a class="headerlink" href="#whitelist-approach-recommended" title="Permanent link">&para;</a></h3>
<p><strong>Whitelist validation</strong> explicitly defines what input is allowed, rejecting everything else.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>
<p>More secure by default</p>
</li>
<li>
<p>Easier to maintain comprehensive security</p>
</li>
<li>
<p>Prevents unknown attack vectors</p>
</li>
<li>
<p>Clear specification of expected input</p>
</li>
</ul>
<p><strong>Use whitelist for:</strong></p>
<ul>
<li>
<p>User registration forms</p>
</li>
<li>
<p>Configuration settings</p>
</li>
<li>
<p>File type uploads</p>
</li>
<li>
<p>API parameters with known formats</p>
</li>
</ul>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import re
from typing import List, Dict, Any, Optional
from enum import Enum

class ValidationResult(Enum):
    VALID = &quot;valid&quot;
    INVALID_FORMAT = &quot;invalid_format&quot;
    INVALID_LENGTH = &quot;invalid_length&quot;
    INVALID_CHARACTERS = &quot;invalid_characters&quot;
    MISSING_REQUIRED = &quot;missing_required&quot;

class WhitelistValidator:
    def __init__(self):
        # Define allowed patterns for different input types
        self.validation_patterns = {
            &#x27;username&#x27;: r&#x27;^[a-zA-Z0-9_]{3,50}$&#x27;,
            &#x27;email&#x27;: r&#x27;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#x27;,
            &#x27;phone&#x27;: r&#x27;^\+?[1-9]\d{1,14}$&#x27;,  # International format
            &#x27;postal_code&#x27;: r&#x27;^[A-Z0-9]{3,10}$&#x27;,
            &#x27;student_id&#x27;: r&#x27;^S[0-9]{6}$&#x27;,  # School-specific format
            &#x27;course_code&#x27;: r&#x27;^[A-Z]{2,4}[0-9]{3,4}$&#x27;
        }

        # Define allowed values for specific fields
        self.allowed_values = {
            &#x27;grade_level&#x27;: [&#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;10&#x27;, &#x27;11&#x27;, &#x27;12&#x27;],
            &#x27;subject&#x27;: [&#x27;Mathematics&#x27;, &#x27;English&#x27;, &#x27;Science&#x27;, &#x27;History&#x27;, &#x27;Art&#x27;, &#x27;PE&#x27;],
            &#x27;user_role&#x27;: [&#x27;student&#x27;, &#x27;teacher&#x27;, &#x27;admin&#x27;, &#x27;parent&#x27;],
            &#x27;file_extension&#x27;: [&#x27;.pdf&#x27;, &#x27;.doc&#x27;, &#x27;.docx&#x27;, &#x27;.txt&#x27;, &#x27;.jpg&#x27;, &#x27;.png&#x27;],
            &#x27;country_code&#x27;: [&#x27;AU&#x27;, &#x27;US&#x27;, &#x27;UK&#x27;, &#x27;CA&#x27;, &#x27;NZ&#x27;, &#x27;SG&#x27;]
        }

        # Define length limits
        self.length_limits = {
            &#x27;username&#x27;: (3, 50),
            &#x27;password&#x27;: (8, 128),
            &#x27;email&#x27;: (5, 254),
            &#x27;first_name&#x27;: (1, 50),
            &#x27;last_name&#x27;: (1, 50),
            &#x27;comment&#x27;: (1, 1000),
            &#x27;description&#x27;: (1, 2000)
        }

    def validate_field(self, field_name: str, value: str, required: bool = True) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Validate a field using whitelist approach&quot;&quot;&quot;

        result = {
            &#x27;field&#x27;: field_name,
            &#x27;value&#x27;: value,
            &#x27;is_valid&#x27;: False,
            &#x27;error&#x27;: None,
            &#x27;sanitized_value&#x27;: None
        }

        # Check if field is required
        if required and (not value or value.strip() == &quot;&quot;):
            result[&#x27;error&#x27;] = ValidationResult.MISSING_REQUIRED
            return result

        # If not required and empty, consider valid
        if not required and (not value or value.strip() == &quot;&quot;):
            result[&#x27;is_valid&#x27;] = True
            result[&#x27;sanitized_value&#x27;] = &quot;&quot;
            return result

        # Trim whitespace
        sanitized = value.strip()

        # Check length limits
        if field_name in self.length_limits:
            min_len, max_len = self.length_limits[field_name]
            if len(sanitized) &lt; min_len or len(sanitized) &gt; max_len:
                result[&#x27;error&#x27;] = ValidationResult.INVALID_LENGTH
                return result

        # Check against allowed values (exact match)
        if field_name in self.allowed_values:
            if sanitized not in self.allowed_values[field_name]:
                result[&#x27;error&#x27;] = ValidationResult.INVALID_FORMAT
                return result

        # Check against regex patterns
        elif field_name in self.validation_patterns:
            pattern = self.validation_patterns[field_name]
            if not re.match(pattern, sanitized):
                result[&#x27;error&#x27;] = ValidationResult.INVALID_FORMAT
                return result

        # Special validation for complex fields
        elif field_name == &#x27;password&#x27;:
            if not self._validate_password_complexity(sanitized):
                result[&#x27;error&#x27;] = ValidationResult.INVALID_FORMAT
                return result

        elif field_name == &#x27;date_of_birth&#x27;:
            if not self._validate_date_format(sanitized):
                result[&#x27;error&#x27;] = ValidationResult.INVALID_FORMAT
                return result

        else:
            # Default: allow alphanumeric and basic punctuation only
            if not re.match(r&#x27;^[a-zA-Z0-9\s\-_.@!?]+$&#x27;, sanitized):
                result[&#x27;error&#x27;] = ValidationResult.INVALID_CHARACTERS
                return result

        # If we reach here, validation passed
        result[&#x27;is_valid&#x27;] = True
        result[&#x27;sanitized_value&#x27;] = sanitized

        return result

    def validate_form(self, form_data: Dict[str, str], 
                     required_fields: List[str] = None) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Validate entire form using whitelist approach&quot;&quot;&quot;

        if required_fields is None:
            required_fields = []

        validation_results = {}
        sanitized_data = {}
        errors = []

        # Validate each field
        for field_name, field_value in form_data.items():
            is_required = field_name in required_fields

            validation_result = self.validate_field(field_name, field_value, is_required)
            validation_results[field_name] = validation_result

            if validation_result[&#x27;is_valid&#x27;]:
                sanitized_data[field_name] = validation_result[&#x27;sanitized_value&#x27;]
            else:
                errors.append({
                    &#x27;field&#x27;: field_name,
                    &#x27;error&#x27;: validation_result[&#x27;error&#x27;].value,
                    &#x27;message&#x27;: self._get_error_message(field_name, validation_result[&#x27;error&#x27;])
                })

        # Check for required fields that weren&#x27;t provided
        for required_field in required_fields:
            if required_field not in form_data:
                errors.append({
                    &#x27;field&#x27;: required_field,
                    &#x27;error&#x27;: ValidationResult.MISSING_REQUIRED.value,
                    &#x27;message&#x27;: f&quot;{required_field} is required&quot;
                })

        return {
            &#x27;is_valid&#x27;: len(errors) == 0,
            &#x27;sanitized_data&#x27;: sanitized_data,
            &#x27;errors&#x27;: errors,
            &#x27;field_results&#x27;: validation_results
        }

    def _validate_password_complexity(self, password: str) -&gt; bool:
        &quot;&quot;&quot;Validate password meets complexity requirements&quot;&quot;&quot;
        if len(password) &lt; 8 or len(password) &gt; 128:
            return False

        # Check for required character types
        has_upper = any(c.isupper() for c in password)
        has_lower = any(c.islower() for c in password)
        has_digit = any(c.isdigit() for c in password)
        has_special = any(c in &quot;!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?&quot; for c in password)

        return has_upper and has_lower and has_digit and has_special

    def _validate_date_format(self, date_string: str) -&gt; bool:
        &quot;&quot;&quot;Validate date is in YYYY-MM-DD format and valid&quot;&quot;&quot;
        try:
            from datetime import datetime
            datetime.strptime(date_string, &#x27;%Y-%m-%d&#x27;)
            return True
        except ValueError:
            return False

    def _get_error_message(self, field_name: str, error_type: ValidationResult) -&gt; str:
        &quot;&quot;&quot;Get user-friendly error message&quot;&quot;&quot;

        messages = {
            ValidationResult.MISSING_REQUIRED: f&quot;{field_name} is required&quot;,
            ValidationResult.INVALID_FORMAT: f&quot;{field_name} format is invalid&quot;,
            ValidationResult.INVALID_LENGTH: f&quot;{field_name} length is invalid&quot;,
            ValidationResult.INVALID_CHARACTERS: f&quot;{field_name} contains invalid characters&quot;
        }

        return messages.get(error_type, f&quot;{field_name} is invalid&quot;)

# Example usage of whitelist validation
def demonstrate_whitelist_validation():
    &quot;&quot;&quot;Demonstrate whitelist validation approach&quot;&quot;&quot;

    print(&quot;=== Whitelist Validation Demo ===&quot;)

    validator = WhitelistValidator()

    # Test form data with various inputs
    test_form_data = {
        &#x27;username&#x27;: &#x27;student123&#x27;,
        &#x27;email&#x27;: &#x27;student@school.edu&#x27;,
        &#x27;grade_level&#x27;: &#x27;11&#x27;,
        &#x27;password&#x27;: &#x27;SecurePass123!&#x27;,
        &#x27;first_name&#x27;: &#x27;Alice&#x27;,
        &#x27;last_name&#x27;: &#x27;Johnson&#x27;,
        &#x27;student_id&#x27;: &#x27;S123456&#x27;,
        &#x27;course_code&#x27;: &#x27;MATH1001&#x27;
    }

    required_fields = [&#x27;username&#x27;, &#x27;email&#x27;, &#x27;password&#x27;, &#x27;first_name&#x27;, &#x27;last_name&#x27;]

    # Validate form
    validation_result = validator.validate_form(test_form_data, required_fields)

    print(f&quot;Form is valid: {validation_result[&#x27;is_valid&#x27;]}&quot;)

    if validation_result[&#x27;errors&#x27;]:
        print(&quot;Validation errors:&quot;)
        for error in validation_result[&#x27;errors&#x27;]:
            print(f&quot;  {error[&#x27;field&#x27;]}: {error[&#x27;message&#x27;]}&quot;)

    print(&quot;\nSanitized data:&quot;)
    for field, value in validation_result[&#x27;sanitized_data&#x27;].items():
        if field != &#x27;password&#x27;:  # Don&#x27;t display password
            print(f&quot;  {field}: {value}&quot;)

    print(&quot;\n=== Testing Invalid Inputs ===&quot;)

    # Test invalid inputs
    invalid_inputs = {
        &#x27;username&#x27;: &#x27;user@#$%&#x27;,  # Invalid characters
        &#x27;email&#x27;: &#x27;invalid-email&#x27;,  # Invalid format
        &#x27;grade_level&#x27;: &#x27;13&#x27;,  # Not in allowed values
        &#x27;student_id&#x27;: &#x27;123456&#x27;,  # Wrong format
        &#x27;password&#x27;: &#x27;weak&#x27;  # Too simple
    }

    for field, invalid_value in invalid_inputs.items():
        result = validator.validate_field(field, invalid_value)
        print(f&quot;{field}: &#x27;{invalid_value}&#x27; -&gt; {result[&#x27;error&#x27;].value if result[&#x27;error&#x27;] else &#x27;VALID&#x27;}&quot;)
</code></pre>
</div>
<h3 id="blacklist-approach-use-with-caution">Blacklist Approach (Use with Caution)<a class="headerlink" href="#blacklist-approach-use-with-caution" title="Permanent link">&para;</a></h3>
<p><strong>Blacklist validation</strong> defines what input is forbidden, allowing everything else.</p>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>
<p>Difficult to anticipate all attack vectors</p>
</li>
<li>
<p>New threats bypass existing blacklists</p>
</li>
<li>
<p>Often leads to incomplete protection</p>
</li>
<li>
<p>Harder to maintain comprehensive security</p>
</li>
</ul>
<p><strong>Use blacklist only for:</strong></p>
<ul>
<li>
<p>Content filtering (profanity, spam)</p>
</li>
<li>
<p>Basic malware detection</p>
</li>
<li>
<p>Supplementary protection alongside whitelists</p>
</li>
</ul>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">class BlacklistValidator:
    def __init__(self):
        # Define dangerous patterns to block
        self.dangerous_patterns = [
            # SQL injection patterns
            r&#x27;union\s+select&#x27;,
            r&#x27;drop\s+table&#x27;,
            r&#x27;delete\s+from&#x27;,
            r&#x27;insert\s+into&#x27;,
            r&#x27;update\s+.*set&#x27;,
            r&#x27;exec\s*\(&#x27;,
            r&#x27;script\s*&gt;&#x27;,

            # XSS patterns
            r&#x27;&lt;script[^&gt;]*&gt;&#x27;,
            r&#x27;javascript:&#x27;,
            r&#x27;vbscript:&#x27;,
            r&#x27;onload\s*=&#x27;,
            r&#x27;onerror\s*=&#x27;,
            r&#x27;onclick\s*=&#x27;,

            # File system attacks
            r&#x27;\.\./&#x27;,
            r&#x27;\.\.\/&#x27;,
            r&#x27;/etc/passwd&#x27;,
            r&#x27;/windows/system32&#x27;,

            # Command injection
            r&#x27;;\s*rm\s+&#x27;,
            r&#x27;;\s*del\s+&#x27;,
            r&#x27;&amp;&amp;\s*rm\s+&#x27;,
            r&#x27;\|\s*nc\s+&#x27;
        ]

        # Blocked words for content filtering
        self.blocked_words = [
            &#x27;password&#x27;, &#x27;admin&#x27;, &#x27;root&#x27;, &#x27;system&#x27;,
            &#x27;confidential&#x27;, &#x27;secret&#x27;, &#x27;private&#x27;
        ]

    def check_dangerous_patterns(self, input_text: str) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Check input against blacklist patterns&quot;&quot;&quot;

        if not input_text:
            return {&#x27;is_safe&#x27;: True, &#x27;threats_found&#x27;: []}

        input_lower = input_text.lower()
        threats_found = []

        # Check against dangerous patterns
        for pattern in self.dangerous_patterns:
            if re.search(pattern, input_lower, re.IGNORECASE):
                threats_found.append({
                    &#x27;type&#x27;: &#x27;dangerous_pattern&#x27;,
                    &#x27;pattern&#x27;: pattern,
                    &#x27;location&#x27;: &#x27;input_text&#x27;
                })

        # Check for blocked words in non-password fields
        for word in self.blocked_words:
            if word in input_lower:
                threats_found.append({
                    &#x27;type&#x27;: &#x27;blocked_word&#x27;,
                    &#x27;word&#x27;: word,
                    &#x27;location&#x27;: &#x27;input_text&#x27;
                })

        return {
            &#x27;is_safe&#x27;: len(threats_found) == 0,
            &#x27;threats_found&#x27;: threats_found,
            &#x27;threat_count&#x27;: len(threats_found)
        }

# Demonstrate why blacklist alone is insufficient
def demonstrate_blacklist_limitations():
    &quot;&quot;&quot;Show limitations of blacklist-only validation&quot;&quot;&quot;

    print(&quot;=== Blacklist Validation Limitations ===&quot;)

    blacklist_validator = BlacklistValidator()

    # These attacks might bypass a simple blacklist
    evasion_attempts = [
        &quot;uni/**/on sel/**/ect&quot;,  # SQL injection with comments
        &quot;ScRiPt&gt;&quot;,  # Case variation
        &quot;java&amp;#115;cript:&quot;,  # HTML entity encoding
        &quot;j%61vascript:&quot;,  # URL encoding
        &quot;%3Cscript%3E&quot;,  # URL encoded script tag
        &quot;&#x27; OR &#x27;1&#x27;=&#x27;1&#x27; --&quot;,  # Basic SQL injection
        &quot;&lt;img src=x onerror=alert(1)&gt;&quot;,  # XSS without &#x27;script&#x27;
        &quot;eval(String.fromCharCode(97,108,101,114,116,40,49,41))&quot;  # Obfuscated JavaScript
    ]

    print(&quot;Testing evasion attempts against blacklist:&quot;)
    for attempt in evasion_attempts:
        result = blacklist_validator.check_dangerous_patterns(attempt)
        status = &quot;🛡️ BLOCKED&quot; if not result[&#x27;is_safe&#x27;] else &quot;⚠️ BYPASSED&quot;
        print(f&quot;{status}: {attempt}&quot;)
        if result[&#x27;threats_found&#x27;]:
            for threat in result[&#x27;threats_found&#x27;]:
                print(f&quot;  Detected: {threat[&#x27;type&#x27;]} - {threat.get(&#x27;pattern&#x27;, threat.get(&#x27;word&#x27;))}&quot;)
        print()
</code></pre>
</div>
<h2 id="safe-error-message-design">Safe Error Message Design<a class="headerlink" href="#safe-error-message-design" title="Permanent link">&para;</a></h2>
<p>Error messages must be informative for legitimate users while avoiding information disclosure to attackers.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">from datetime import datetime
import logging
from typing import Dict, Any

class SafeErrorHandler:
    def __init__(self):
        # Setup logging for security events
        logging.basicConfig(
            level=logging.INFO,
            format=&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;,
            handlers=[
                logging.FileHandler(&#x27;security.log&#x27;),
                logging.StreamHandler()
            ]
        )
        self.logger = logging.getLogger(&#x27;SecurityHandler&#x27;)

    def handle_authentication_error(self, username: str, ip_address: str, 
                                  error_details: str) -&gt; str:
        &quot;&quot;&quot;Handle authentication errors safely&quot;&quot;&quot;

        # Log detailed information for security monitoring
        self.logger.warning(
            f&quot;Authentication failed - IP: {ip_address}, &quot;
            f&quot;Username: {username}, Details: {error_details}&quot;
        )

        # Return generic message to user (don&#x27;t reveal specific failure reason)
        return &quot;Invalid username or password. Please try again.&quot;

    def handle_validation_error(self, field_name: str, error_type: str, 
                              user_input: str, ip_address: str) -&gt; str:
        &quot;&quot;&quot;Handle validation errors safely&quot;&quot;&quot;

        # Log for monitoring (be careful with sensitive data)
        safe_input = user_input[:50] + &quot;...&quot; if len(user_input) &gt; 50 else user_input

        self.logger.info(
            f&quot;Validation error - Field: {field_name}, Type: {error_type}, &quot;
            f&quot;IP: {ip_address}, Input: {safe_input}&quot;
        )

        # Return safe, helpful message to user
        safe_messages = {
            &#x27;invalid_format&#x27;: f&quot;{field_name} format is incorrect. Please check and try again.&quot;,
            &#x27;invalid_length&#x27;: f&quot;{field_name} must be the correct length.&quot;,
            &#x27;missing_required&#x27;: f&quot;{field_name} is required.&quot;,
            &#x27;invalid_characters&#x27;: f&quot;{field_name} contains invalid characters.&quot;
        }

        return safe_messages.get(error_type, f&quot;{field_name} is invalid.&quot;)

    def handle_database_error(self, operation: str, ip_address: str, 
                            error_details: str) -&gt; str:
        &quot;&quot;&quot;Handle database errors safely&quot;&quot;&quot;

        # Log detailed error for administrators
        self.logger.error(
            f&quot;Database error - Operation: {operation}, IP: {ip_address}, &quot;
            f&quot;Error: {error_details}&quot;
        )

        # Return generic message to user (don&#x27;t reveal database structure)
        return &quot;A temporary error occurred. Please try again later.&quot;

    def handle_file_upload_error(self, filename: str, error_type: str, 
                               ip_address: str) -&gt; str:
        &quot;&quot;&quot;Handle file upload errors safely&quot;&quot;&quot;

        self.logger.warning(
            f&quot;File upload error - File: {filename}, Type: {error_type}, &quot;
            f&quot;IP: {ip_address}&quot;
        )

        safe_messages = {
            &#x27;invalid_type&#x27;: &quot;File type not allowed. Please upload a valid file.&quot;,
            &#x27;too_large&#x27;: &quot;File is too large. Maximum size is 10MB.&quot;,
            &#x27;virus_detected&#x27;: &quot;File upload blocked for security reasons.&quot;,
            &#x27;invalid_name&#x27;: &quot;Invalid file name. Please rename and try again.&quot;
        }

        return safe_messages.get(error_type, &quot;File upload failed.&quot;)

    def handle_rate_limit_error(self, ip_address: str, endpoint: str) -&gt; str:
        &quot;&quot;&quot;Handle rate limiting errors&quot;&quot;&quot;

        self.logger.warning(
            f&quot;Rate limit exceeded - IP: {ip_address}, Endpoint: {endpoint}&quot;
        )

        return &quot;Too many requests. Please wait before trying again.&quot;
</code></pre>
</div>
<h2 id="file-upload-security">File Upload Security<a class="headerlink" href="#file-upload-security" title="Permanent link">&para;</a></h2>
<p>File uploads are a common attack vector that require comprehensive security measures.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python">import os
import magic
import hashlib
from pathlib import Path
from typing import List, Dict, Any, Optional

class SecureFileUploadManager:
    def __init__(self, upload_directory: str = &quot;uploads&quot;):
        self.upload_directory = Path(upload_directory)
        self.upload_directory.mkdir(exist_ok=True, mode=0o755)

        # Configure allowed file types
        self.allowed_extensions = {
            &#x27;.pdf&#x27;, &#x27;.doc&#x27;, &#x27;.docx&#x27;, &#x27;.txt&#x27;, &#x27;.rtf&#x27;,  # Documents
            &#x27;.jpg&#x27;, &#x27;.jpeg&#x27;, &#x27;.png&#x27;, &#x27;.gif&#x27;, &#x27;.bmp&#x27;,  # Images
            &#x27;.zip&#x27;, &#x27;.rar&#x27;, &#x27;.7z&#x27;  # Archives (with caution)
        }

        # MIME type validation
        self.allowed_mime_types = {
            &#x27;application/pdf&#x27;,
            &#x27;application/msword&#x27;,
            &#x27;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#x27;,
            &#x27;text/plain&#x27;,
            &#x27;text/rtf&#x27;,
            &#x27;image/jpeg&#x27;,
            &#x27;image/png&#x27;,
            &#x27;image/gif&#x27;,
            &#x27;image/bmp&#x27;,
            &#x27;application/zip&#x27;,
            &#x27;application/x-rar-compressed&#x27;,
            &#x27;application/x-7z-compressed&#x27;
        }

        # Size limits (in bytes)
        self.max_file_size = 10 * 1024 * 1024  # 10MB
        self.max_total_size = 100 * 1024 * 1024  # 100MB per session

        # File name restrictions
        self.forbidden_names = {
            &#x27;con&#x27;, &#x27;prn&#x27;, &#x27;aux&#x27;, &#x27;nul&#x27;,  # Windows reserved names
            &#x27;com1&#x27;, &#x27;com2&#x27;, &#x27;com3&#x27;, &#x27;com4&#x27;, &#x27;com5&#x27;, &#x27;com6&#x27;, &#x27;com7&#x27;, &#x27;com8&#x27;, &#x27;com9&#x27;,
            &#x27;lpt1&#x27;, &#x27;lpt2&#x27;, &#x27;lpt3&#x27;, &#x27;lpt4&#x27;, &#x27;lpt5&#x27;, &#x27;lpt6&#x27;, &#x27;lpt7&#x27;, &#x27;lpt8&#x27;, &#x27;lpt9&#x27;
        }

    def validate_file_upload(self, file_data: bytes, filename: str, 
                           user_id: str) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Comprehensively validate file upload&quot;&quot;&quot;

        result = {
            &#x27;is_valid&#x27;: False,
            &#x27;errors&#x27;: [],
            &#x27;safe_filename&#x27;: None,
            &#x27;file_hash&#x27;: None,
            &#x27;detected_type&#x27;: None
        }

        # 1. Validate filename
        filename_validation = self._validate_filename(filename)
        if not filename_validation[&#x27;is_valid&#x27;]:
            result[&#x27;errors&#x27;].extend(filename_validation[&#x27;errors&#x27;])
            return result

        result[&#x27;safe_filename&#x27;] = filename_validation[&#x27;safe_filename&#x27;]

        # 2. Validate file size
        if len(file_data) == 0:
            result[&#x27;errors&#x27;].append(&quot;File is empty&quot;)
            return result

        if len(file_data) &gt; self.max_file_size:
            result[&#x27;errors&#x27;].append(f&quot;File too large. Maximum size: {self.max_file_size // 1024 // 1024}MB&quot;)
            return result

        # 3. Validate file content and type
        content_validation = self._validate_file_content(file_data, filename)
        if not content_validation[&#x27;is_valid&#x27;]:
            result[&#x27;errors&#x27;].extend(content_validation[&#x27;errors&#x27;])
            return result

        result[&#x27;detected_type&#x27;] = content_validation[&#x27;detected_type&#x27;]

        # 4. Generate file hash for deduplication and integrity
        file_hash = hashlib.sha256(file_data).hexdigest()
        result[&#x27;file_hash&#x27;] = file_hash

        # 5. Check for existing file
        if self._file_exists(file_hash):
            result[&#x27;errors&#x27;].append(&quot;File already exists&quot;)
            return result

        # 6. Virus scan (placeholder - integrate with actual antivirus)
        virus_scan_result = self._scan_for_viruses(file_data)
        if not virus_scan_result[&#x27;is_clean&#x27;]:
            result[&#x27;errors&#x27;].append(&quot;File failed security scan&quot;)
            return result

        # If we reach here, file is valid
        result[&#x27;is_valid&#x27;] = True
        return result

    def save_file_securely(self, file_data: bytes, validation_result: Dict[str, Any], 
                          user_id: str) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Save validated file securely&quot;&quot;&quot;

        if not validation_result[&#x27;is_valid&#x27;]:
            return {&#x27;success&#x27;: False, &#x27;error&#x27;: &#x27;File validation failed&#x27;}

        safe_filename = validation_result[&#x27;safe_filename&#x27;]
        file_hash = validation_result[&#x27;file_hash&#x27;]

        # Create user-specific directory
        user_dir = self.upload_directory / user_id
        user_dir.mkdir(exist_ok=True, mode=0o755)

        # Generate unique filename to prevent conflicts
        timestamp = datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)
        unique_filename = f&quot;{timestamp}_{file_hash[:8]}_{safe_filename}&quot;

        file_path = user_dir / unique_filename

        try:
            # Write file with restricted permissions
            with open(file_path, &#x27;wb&#x27;) as f:
                f.write(file_data)

            # Set restrictive permissions
            os.chmod(file_path, 0o644)  # Read/write for owner, read for group

            # Store file metadata
            metadata = {
                &#x27;original_filename&#x27;: safe_filename,
                &#x27;stored_filename&#x27;: unique_filename,
                &#x27;file_hash&#x27;: file_hash,
                &#x27;file_size&#x27;: len(file_data),
                &#x27;mime_type&#x27;: validation_result[&#x27;detected_type&#x27;],
                &#x27;upload_time&#x27;: datetime.now().isoformat(),
                &#x27;user_id&#x27;: user_id,
                &#x27;file_path&#x27;: str(file_path)
            }

            return {
                &#x27;success&#x27;: True,
                &#x27;file_id&#x27;: file_hash,
                &#x27;metadata&#x27;: metadata
            }

        except Exception as e:
            return {&#x27;success&#x27;: False, &#x27;error&#x27;: f&#x27;Failed to save file: {str(e)}&#x27;}

    def _validate_filename(self, filename: str) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Validate and sanitize filename&quot;&quot;&quot;

        result = {&#x27;is_valid&#x27;: False, &#x27;errors&#x27;: [], &#x27;safe_filename&#x27;: None}

        if not filename:
            result[&#x27;errors&#x27;].append(&quot;Filename is required&quot;)
            return result

        # Check length
        if len(filename) &gt; 255:
            result[&#x27;errors&#x27;].append(&quot;Filename too long&quot;)
            return result

        # Extract extension
        file_path = Path(filename)
        extension = file_path.suffix.lower()

        # Check extension
        if extension not in self.allowed_extensions:
            result[&#x27;errors&#x27;].append(f&quot;File type &#x27;{extension}&#x27; not allowed&quot;)
            return result

        # Check forbidden names
        name_without_ext = file_path.stem.lower()
        if name_without_ext in self.forbidden_names:
            result[&#x27;errors&#x27;].append(&quot;Reserved filename not allowed&quot;)
            return result

        # Sanitize filename
        import re
        # Remove dangerous characters
        safe_name = re.sub(r&#x27;[&lt;&gt;:&quot;/\\|?*]&#x27;, &#x27;&#x27;, file_path.stem)
        safe_name = re.sub(r&#x27;[\x00-\x1f]&#x27;, &#x27;&#x27;, safe_name)  # Remove control characters
        safe_name = safe_name.strip(&#x27;. &#x27;)  # Remove leading/trailing dots and spaces

        if not safe_name:
            result[&#x27;errors&#x27;].append(&quot;Invalid filename&quot;)
            return result

        # Reconstruct safe filename
        safe_filename = safe_name + extension

        result[&#x27;is_valid&#x27;] = True
        result[&#x27;safe_filename&#x27;] = safe_filename
        return result

    def _validate_file_content(self, file_data: bytes, filename: str) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Validate file content matches declared type&quot;&quot;&quot;

        result = {&#x27;is_valid&#x27;: False, &#x27;errors&#x27;: [], &#x27;detected_type&#x27;: None}

        try:
            # Detect actual MIME type from content
            detected_mime = magic.from_buffer(file_data, mime=True)
            result[&#x27;detected_type&#x27;] = detected_mime

            # Check if detected type is allowed
            if detected_mime not in self.allowed_mime_types:
                result[&#x27;errors&#x27;].append(f&quot;File content type &#x27;{detected_mime}&#x27; not allowed&quot;)
                return result

            # Verify extension matches content
            file_path = Path(filename)
            extension = file_path.suffix.lower()

            # Basic extension-to-MIME validation
            extension_mime_map = {
                &#x27;.pdf&#x27;: &#x27;application/pdf&#x27;,
                &#x27;.doc&#x27;: &#x27;application/msword&#x27;,
                &#x27;.docx&#x27;: &#x27;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#x27;,
                &#x27;.txt&#x27;: &#x27;text/plain&#x27;,
                &#x27;.jpg&#x27;: &#x27;image/jpeg&#x27;,
                &#x27;.jpeg&#x27;: &#x27;image/jpeg&#x27;,
                &#x27;.png&#x27;: &#x27;image/png&#x27;,
                &#x27;.gif&#x27;: &#x27;image/gif&#x27;
            }

            expected_mime = extension_mime_map.get(extension)
            if expected_mime and expected_mime != detected_mime:
                result[&#x27;errors&#x27;].append(&quot;File extension doesn&#x27;t match content type&quot;)
                return result

            result[&#x27;is_valid&#x27;] = True
            return result

        except Exception as e:
            result[&#x27;errors&#x27;].append(f&quot;Could not analyze file content: {str(e)}&quot;)
            return result

    def _file_exists(self, file_hash: str) -&gt; bool:
        &quot;&quot;&quot;Check if file with same hash already exists&quot;&quot;&quot;
        # In production, check database or file index
        # For demo, just return False
        return False

    def _scan_for_viruses(self, file_data: bytes) -&gt; Dict[str, Any]:
        &quot;&quot;&quot;Basic virus scanning (integrate with real antivirus)&quot;&quot;&quot;

        # Simple heuristic checks
        suspicious_patterns = [
            b&#x27;&lt;script&#x27;,
            b&#x27;javascript:&#x27;,
            b&#x27;vbscript:&#x27;,
            b&#x27;eval(&#x27;,
            b&#x27;document.cookie&#x27;,
            b&#x27;window.location&#x27;
        ]

        file_lower = file_data.lower()

        for pattern in suspicious_patterns:
            if pattern in file_lower:
                return {&#x27;is_clean&#x27;: False, &#x27;threat&#x27;: &#x27;Suspicious content detected&#x27;}

        # In production, integrate with ClamAV or similar
        return {&#x27;is_clean&#x27;: True}

# Demonstration of secure file upload
def demonstrate_secure_file_upload():
    &quot;&quot;&quot;Demonstrate secure file upload handling&quot;&quot;&quot;

    print(&quot;=== Secure File Upload Demo ===&quot;)

    upload_manager = SecureFileUploadManager()

    # Simulate file upload tests
    test_files = [
        {
            &#x27;filename&#x27;: &#x27;document.pdf&#x27;,
            &#x27;content&#x27;: b&#x27;%PDF-1.4\n1 0 obj\n&lt;&lt;\n/Type /Catalog&#x27;,  # PDF header
            &#x27;description&#x27;: &#x27;Valid PDF file&#x27;
        },
        {
            &#x27;filename&#x27;: &#x27;malicious.exe&#x27;,
            &#x27;content&#x27;: b&#x27;MZ\x90\x00&#x27;,  # PE executable header
            &#x27;description&#x27;: &#x27;Executable file (should be blocked)&#x27;
        },
        {
            &#x27;filename&#x27;: &#x27;script.txt&#x27;,
            &#x27;content&#x27;: b&#x27;&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;&#x27;,
            &#x27;description&#x27;: &#x27;Text file with suspicious content&#x27;
        },
        {
            &#x27;filename&#x27;: &#x27;../../../etc/passwd&#x27;,
            &#x27;content&#x27;: b&#x27;root:x:0:0:root:/root:/bin/bash&#x27;,
            &#x27;description&#x27;: &#x27;Path traversal attempt&#x27;
        }
    ]

    for test_file in test_files:
        print(f&quot;\nTesting: {test_file[&#x27;description&#x27;]}&quot;)
        print(f&quot;Filename: {test_file[&#x27;filename&#x27;]}&quot;)

        validation_result = upload_manager.validate_file_upload(
            test_file[&#x27;content&#x27;],
            test_file[&#x27;filename&#x27;],
            &#x27;test_user&#x27;
        )

        if validation_result[&#x27;is_valid&#x27;]:
            print(&quot;✅ File validation passed&quot;)

            save_result = upload_manager.save_file_securely(
                test_file[&#x27;content&#x27;],
                validation_result,
                &#x27;test_user&#x27;
            )

            if save_result[&#x27;success&#x27;]:
                print(f&quot;✅ File saved as: {save_result[&#x27;metadata&#x27;][&#x27;stored_filename&#x27;]}&quot;)
            else:
                print(f&quot;❌ Save failed: {save_result[&#x27;error&#x27;]}&quot;)
        else:
            print(&quot;❌ File validation failed:&quot;)
            for error in validation_result[&#x27;errors&#x27;]:
                print(f&quot;  - {error}&quot;)

# Example: Complete secure user registration system
def demonstrate_complete_secure_registration():
    &quot;&quot;&quot;Demonstrate complete secure user registration with all protections&quot;&quot;&quot;

    print(&quot;=== Complete Secure Registration System Demo ===&quot;)

    # Initialize all security components
    db_manager = SecureDatabaseManager()
    xss_manager = XSSProtectionManager()
    validator = WhitelistValidator()
    error_handler = SafeErrorHandler()

    # Simulate user registration form submission
    registration_data = {
        &#x27;username&#x27;: &#x27;newstudent123&#x27;,
        &#x27;email&#x27;: &#x27;newstudent@school.edu&#x27;,
        &#x27;password&#x27;: &#x27;SecureStudentPass123!&#x27;,
        &#x27;first_name&#x27;: &#x27;John&#x27;,
        &#x27;last_name&#x27;: &#x27;Smith&#x27;,
        &#x27;grade_level&#x27;: &#x27;11&#x27;,
        &#x27;bio&#x27;: &#x27;&lt;p&gt;I enjoy &lt;strong&gt;mathematics&lt;/strong&gt; and science.&lt;/p&gt;&#x27;
    }

    required_fields = [&#x27;username&#x27;, &#x27;email&#x27;, &#x27;password&#x27;, &#x27;first_name&#x27;, &#x27;last_name&#x27;]

    print(&quot;1. Input Validation...&quot;)

    # Step 1: Whitelist validation
    validation_result = validator.validate_form(registration_data, required_fields)

    if not validation_result[&#x27;is_valid&#x27;]:
        print(&quot;❌ Validation failed:&quot;)
        for error in validation_result[&#x27;errors&#x27;]:
            safe_error = error_handler.handle_validation_error(
                error[&#x27;field&#x27;], error[&#x27;error&#x27;], 
                registration_data.get(error[&#x27;field&#x27;], &#x27;&#x27;), 
                &#x27;192.168.1.100&#x27;
            )
            print(f&quot;  {safe_error}&quot;)
        return

    print(&quot;✅ Input validation passed&quot;)

    # Step 2: XSS protection
    print(&quot;2. XSS Protection...&quot;)
    xss_result = xss_manager.validate_and_sanitize_form_data(registration_data)

    if not xss_result[&#x27;is_valid&#x27;]:
        print(&quot;❌ XSS protection failed:&quot;)
        for error in xss_result[&#x27;errors&#x27;]:
            print(f&quot;  {error}&quot;)
        return

    print(&quot;✅ XSS protection passed&quot;)

    # Step 3: Database insertion with SQL injection protection
    print(&quot;3. Secure Database Operation...&quot;)

    sanitized_data = validation_result[&#x27;sanitized_data&#x27;]

    success, message = db_manager.create_user(
        sanitized_data[&#x27;username&#x27;],
        sanitized_data[&#x27;email&#x27;],
        sanitized_data[&#x27;password&#x27;]
    )

    if success:
        print(f&quot;✅ User registration successful: {message}&quot;)
    else:
        safe_error = error_handler.handle_database_error(
            &#x27;user_creation&#x27;, &#x27;192.168.1.100&#x27;, str(message)
        )
        print(f&quot;❌ Registration failed: {safe_error}&quot;)
</code></pre>
</div>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p><strong>Input validation and sanitization form the foundation of secure web applications:</strong></p>
<p><strong>SQL Injection Prevention:</strong></p>
<ul>
<li>
<p><strong>Always use parameterized queries</strong> - never concatenate user input directly into SQL</p>
</li>
<li>
<p><strong>Validate all input</strong> before database operations</p>
</li>
<li>
<p><strong>Apply principle of least privilege</strong> to database accounts</p>
</li>
<li>
<p><strong>Monitor and log</strong> authentication attempts and database errors</p>
</li>
</ul>
<p><strong>XSS Protection:</strong></p>
<ul>
<li>
<p><strong>Escape output by default</strong> - encode data when displaying to users</p>
</li>
<li>
<p><strong>Use whitelist validation</strong> for rich content</p>
</li>
<li>
<p><strong>Apply context-aware encoding</strong> (HTML, JavaScript, CSS contexts require different approaches)</p>
</li>
<li>
<p><strong>Implement Content Security Policy</strong> to restrict script execution</p>
</li>
</ul>
<p><strong>Input Validation Strategy:</strong></p>
<ul>
<li>
<p><strong>Prefer whitelist over blacklist</strong> approaches</p>
</li>
<li>
<p><strong>Validate both format and content</strong> of uploaded files</p>
</li>
<li>
<p><strong>Implement multiple layers</strong> of validation</p>
</li>
<li>
<p><strong>Fail securely</strong> when validation errors occur</p>
</li>
</ul>
<p><strong>Safe Error Handling:</strong></p>
<ul>
<li>
<p><strong>Log detailed errors</strong> for administrators</p>
</li>
<li>
<p><strong>Return generic messages</strong> to users</p>
</li>
<li>
<p><strong>Avoid information disclosure</strong> in error responses</p>
</li>
<li>
<p><strong>Monitor error patterns</strong> for attack detection</p>
</li>
</ul>
<p><strong>File Upload Security:</strong></p>
<ul>
<li>
<p><strong>Validate file types</strong> by content, not just extension</p>
</li>
<li>
<p><strong>Scan for malware</strong> before storage</p>
</li>
<li>
<p><strong>Use secure file naming</strong> to prevent conflicts and attacks</p>
</li>
<li>
<p><strong>Apply size limits</strong> to prevent resource exhaustion</p>
</li>
</ul>
<p><strong>Implementation best practices:</strong></p>
<ul>
<li>
<p><strong>Defense in depth</strong>: Multiple validation layers</p>
</li>
<li>
<p><strong>Fail securely</strong>: Default to rejecting suspicious input</p>
</li>
<li>
<p><strong>Log security events</strong>: Monitor for attack patterns</p>
</li>
<li>
<p><strong>Regular updates</strong>: Keep security libraries current</p>
</li>
</ul>
<p>Understanding and implementing comprehensive input validation protects applications from the majority of common web vulnerabilities and provides a solid foundation for secure system design.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 15, 2025 07:03:58 UTC">October 15, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 – <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>