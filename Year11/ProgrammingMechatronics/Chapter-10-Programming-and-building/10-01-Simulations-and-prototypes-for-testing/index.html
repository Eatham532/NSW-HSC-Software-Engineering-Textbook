
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-01-Simulations-and-prototypes-for-testing/">
      
      
        <link rel="prev" href="../../Chapter-09-Control-algorithms/09-04-Mechanical-constraints-and-subsystem-composition/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Content - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#101-simulations-and-prototypes-for-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> – content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year12/ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Year 11
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming Fundamentals
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ObjectOrientedParadigm/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Object-Oriented Paradigm
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming Mechatronics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Programming Mechatronics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-07-Mechatronics-foundations/07-01-Applications-of-mechatronic-systems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 07 — Mechatronics foundations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-08-Data-and-integration/08-01-Working-with-device-data-and-diagnostics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 08 — Data and integration
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-09-Control-algorithms/09-01-Open-vs-closed-loop-systems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 09 — Control algorithms
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 10 — Programming and building
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 10 — Programming and building
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_5_1" id="__nav_2_3_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    10.1 Simulations and prototypes for testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_5_1">
            <span class="md-nav__icon md-icon"></span>
            10.1 Simulations and prototypes for testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sensor-simulation-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      Sensor simulation fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actuator-simulation-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Actuator simulation patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-integration-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      System integration simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guided-example-robotic-arm-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Guided example: robotic arm simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try it">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-multi-sensor-environment-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Multi-sensor environment simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-actuator-coordination-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Actuator coordination simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-real-time-control-simulation-with-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Real-time control simulation with visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-02-Implementing-closed-loop-control/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.2 Implementing closed-loop control
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-03-Integrating-sensors-and-actuators/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.3 Integrating sensors and actuators
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-04-User-interfaces-for-control/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.4 User interfaces for control
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-05-Unit-tests-subsystems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.5 Unit tests subsystems
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year12/ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sensor-simulation-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      Sensor simulation fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actuator-simulation-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Actuator simulation patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-integration-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      System integration simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guided-example-robotic-arm-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Guided example: robotic arm simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try it">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-multi-sensor-environment-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Multi-sensor environment simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-actuator-coordination-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Actuator coordination simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-real-time-control-simulation-with-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Real-time control simulation with visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-01-Simulations-and-prototypes-for-testing/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-01-Simulations-and-prototypes-for-testing/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="101-simulations-and-prototypes-for-testing">10.1 Simulations and prototypes for testing<a class="headerlink" href="#101-simulations-and-prototypes-for-testing" title="Permanent link">&para;</a></h1>
<h2 id="why-it-matters">Why it matters<a class="headerlink" href="#why-it-matters" title="Permanent link">&para;</a></h2>
<p>Building and testing mechatronic systems with real hardware is expensive, time-consuming, and sometimes dangerous. A faulty control algorithm could damage expensive motors, or incorrect sensor handling might cause a robotic arm to move unpredictably. Simulation allows you to develop, test, and refine your control logic safely before connecting to real devices.</p>
<p>Python simulations are particularly valuable in mechatronics because they let you model sensor behaviour, test control algorithms, and validate system responses without physical hardware. You can simulate everything from simple temperature sensors to complex multi-axis robotic systems, allowing rapid prototyping and iterative development.</p>
<p>Professional mechatronic engineers routinely use simulation for system design, testing edge cases, and training operators. The simulation skills you develop here form the foundation for advanced tools like MATLAB/Simulink, ROS (Robot Operating System), and dedicated mechatronic simulation platforms.</p>
<h2 id="concepts">Concepts<a class="headerlink" href="#concepts" title="Permanent link">&para;</a></h2>
<h3 id="sensor-simulation-fundamentals">Sensor simulation fundamentals<a class="headerlink" href="#sensor-simulation-fundamentals" title="Permanent link">&para;</a></h3>
<p>Sensor simulation involves creating Python functions or classes that mimic the behaviour of real sensors. This includes not only the basic measurement function, but also realistic characteristics like noise, drift, response time, and measurement ranges.</p>
<p>Real sensors have limitations and quirks that affect system design:</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TemperatureSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_id</span><span class="p">,</span> <span class="n">base_temp</span><span class="o">=</span><span class="mf">20.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_id</span> <span class="o">=</span> <span class="n">sensor_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_temp</span> <span class="o">=</span> <span class="n">base_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># ±0.2°C noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_rate</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 0.01°C per reading drift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reading_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate realistic temperature sensor reading&quot;&quot;&quot;</span>
        <span class="c1"># Add random noise</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">)</span>

        <span class="c1"># Add cumulative drift</span>
        <span class="n">drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reading_count</span>

        <span class="c1"># Calculate reading</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_temp</span> <span class="o">+</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">drift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reading_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Simulate sensor response delay</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># 100ms response time</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">reading</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">known_temp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset drift by calibrating to known temperature&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_temp</span> <span class="o">=</span> <span class="n">known_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reading_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sensor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_id</span><span class="si">}</span><span class="s2"> calibrated to </span><span class="si">{</span><span class="n">known_temp</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>

<span class="c1"># Test the sensor simulation</span>
<span class="n">temp_sensor</span> <span class="o">=</span> <span class="n">TemperatureSensor</span><span class="p">(</span><span class="s2">&quot;TEMP_01&quot;</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temperature readings over time:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp_sensor</span><span class="o">.</span><span class="n">read_temperature</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>
</code></pre>
</div>
<p>Key aspects of realistic sensor simulation:</p>
<ul>
<li>
<p><strong>Noise</strong>: Random variations in readings due to electrical interference</p>
</li>
<li>
<p><strong>Drift</strong>: Gradual change in sensor calibration over time</p>
</li>
<li>
<p><strong>Response time</strong>: Delay between measurement request and result</p>
</li>
<li>
<p><strong>Range limits</strong>: Sensors have minimum and maximum measurable values</p>
</li>
<li>
<p><strong>Resolution</strong>: Sensors can only measure to a certain precision</p>
</li>
</ul>
<h3 id="actuator-simulation-patterns">Actuator simulation patterns<a class="headerlink" href="#actuator-simulation-patterns" title="Permanent link">&para;</a></h3>
<p>Actuator simulation models how motors, servos, and other output devices respond to control signals. Unlike sensors (which provide data), actuators change the physical world, so simulation must track position, velocity, and state changes over time.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ServoMotor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">servo_id</span><span class="p">,</span> <span class="n">initial_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servo_id</span> <span class="o">=</span> <span class="n">servo_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span> <span class="o">=</span> <span class="n">initial_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_angle</span> <span class="o">=</span> <span class="n">initial_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="mi">180</span>  <span class="c1"># degrees per second</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># 1 degree precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Command servo to move to target angle&quot;&quot;&quot;</span>
        <span class="c1"># Clamp to valid servo range (0-180 degrees)</span>
        <span class="n">target_angle</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">target_angle</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">target_angle</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_angle</span> <span class="o">=</span> <span class="n">target_angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Servo </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">servo_id</span><span class="si">}</span><span class="s2">: Moving to </span><span class="si">{</span><span class="n">target_angle</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Servo </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">servo_id</span><span class="si">}</span><span class="s2">: Already at target position&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update servo position based on elapsed time&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Calculate how far we can move in this time step</span>
        <span class="n">max_movement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="c1"># Calculate required movement</span>
        <span class="n">angle_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_angle</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angle_diff</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_movement</span><span class="p">:</span>
            <span class="c1"># We can reach the target this step</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Servo </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">servo_id</span><span class="si">}</span><span class="s2">: Reached target </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_angle</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Move as far as possible toward target</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">angle_diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span> <span class="o">+=</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">max_movement</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Servo </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">servo_id</span><span class="si">}</span><span class="s2">: Moving... now at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current servo angle&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_angle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_moving</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if servo is currently moving&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span>

<span class="c1"># Test servo simulation</span>
<span class="n">servo</span> <span class="o">=</span> <span class="n">ServoMotor</span><span class="p">(</span><span class="s2">&quot;SERVO_01&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">servo</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Simulate time passing</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">servo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># 100ms time steps</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">servo</span><span class="o">.</span><span class="n">is_moving</span><span class="p">():</span>
        <span class="k">break</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre>
</div>
<p>Essential features of actuator simulation:</p>
<ul>
<li>
<p><strong>State tracking</strong>: Current position, velocity, and target values</p>
</li>
<li>
<p><strong>Movement constraints</strong>: Speed limits, acceleration curves, range limits</p>
</li>
<li>
<p><strong>Time-based updates</strong>: Position changes over time, not instantly</p>
</li>
<li>
<p><strong>Feedback</strong>: Status information about movement completion</p>
</li>
<li>
<p><strong>Realistic delays</strong>: Motors take time to reach target positions</p>
</li>
</ul>
<h3 id="system-integration-simulation">System integration simulation<a class="headerlink" href="#system-integration-simulation" title="Permanent link">&para;</a></h3>
<p>Real mechatronic systems involve multiple sensors and actuators working together. System simulation combines individual component simulations into coordinated behaviour, often with feedback loops where sensor readings influence actuator commands.</p>
<div class="diagram-container" data-container-id="kroki-diagram-0"><button class="diagram-expand-btn" onclick="openDiagramModal('kroki-diagram-0')">🔍 View Larger</button><div id="kroki-diagram-0" class="diagram-content"><p><svg xmlns="http://www.w3.org/2000/svg" contentStyleType="text/css" data-diagram-type="CLASS" height="366px" preserveAspectRatio="xMaxYMax meet" style="width:912px;height:366px;background:#FFFFFF;" version="1.1" viewBox="0 0 912 366" width="912px" zoomAndPan="magnify" id="Kroki" data-diagram-id="kroki-svg-0"><defs /><g><g class="entity" data-entity="SystemSimulation" data-source-line="4" data-uid="ent0002" id="entity_SystemSimulation"><rect fill="#F1F1F1" height="162.0781" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="227.127" x="213.12" y="7" /><ellipse cx="259.0438" cy="23" fill="#C2C2C2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;" /><path d="M262.0126,28.6406 Q261.4345,28.9375 260.7938,29.0781 Q260.1532,29.2344 259.4501,29.2344 Q256.9501,29.2344 255.622,27.5938 Q254.3095,25.9375 254.3095,22.8125 Q254.3095,19.6875 255.622,18.0313 Q256.9501,16.375 259.4501,16.375 Q260.1532,16.375 260.7938,16.5313 Q261.4501,16.6875 262.0126,16.9844 L262.0126,19.7031 Q261.3876,19.125 260.7938,18.8594 Q260.2001,18.5781 259.5751,18.5781 Q258.2313,18.5781 257.5438,19.6563 Q256.8563,20.7188 256.8563,22.8125 Q256.8563,24.9063 257.5438,25.9844 Q258.2313,27.0469 259.5751,27.0469 Q260.2001,27.0469 260.7938,26.7813 Q261.3876,26.5 262.0126,25.9219 L262.0126,28.6406 Z " fill="#000000" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.7793" x="279.5438" y="27.8467">SystemSimulation</text><line style="stroke:#181818;stroke-width:0.5;" x1="214.12" x2="439.247" y1="39" y2="39" /><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="221.12" y="49.6484" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.8193" x="233.12" y="55.9951">sensors: dict</text><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="221.12" y="65.9453" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.4521" x="233.12" y="72.292">actuators: dict</text><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="221.12" y="82.2422" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.3711" x="233.12" y="88.5889">control_loop_active: bool</text><line style="stroke:#181818;stroke-width:0.5;" x1="214.12" x2="439.247" y1="95.8906" y2="95.8906" /><ellipse cx="224.12" cy="109.5391" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.8613" x="233.12" y="112.8857">add_sensor(sensor): void</text><ellipse cx="224.12" cy="125.8359" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201.127" x="233.12" y="129.1826">add_actuator(actuator): void</text><ellipse cx="224.12" cy="142.1328" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165.9629" x="233.12" y="145.4795">run_control_loop(): void</text><ellipse cx="224.12" cy="158.4297" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.3574" x="233.12" y="161.7764">step_simulation(dt): void</text></g><g class="entity" data-entity="SensorInterface" data-source-line="14" data-uid="ent0003" id="entity_SensorInterface"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182.4404" x="135.46" y="254.23" /><ellipse cx="168.358" cy="270.23" fill="#C2C2C2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;" /><path d="M171.3268,275.8706 Q170.7487,276.1675 170.108,276.3081 Q169.4674,276.4644 168.7643,276.4644 Q166.2643,276.4644 164.9362,274.8237 Q163.6237,273.1675 163.6237,270.0425 Q163.6237,266.9175 164.9362,265.2612 Q166.2643,263.605 168.7643,263.605 Q169.4674,263.605 170.108,263.7612 Q170.7643,263.9175 171.3268,264.2144 L171.3268,266.9331 Q170.7018,266.355 170.108,266.0894 Q169.5143,265.8081 168.8893,265.8081 Q167.5455,265.8081 166.858,266.8862 Q166.1705,267.9487 166.1705,270.0425 Q166.1705,272.1362 166.858,273.2144 Q167.5455,274.2769 168.8893,274.2769 Q169.5143,274.2769 170.108,274.0112 Q170.7018,273.73 171.3268,273.1519 L171.3268,275.8706 Z " fill="#000000" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.667" x="186.3354" y="275.0767">SensorInterface</text><line style="stroke:#181818;stroke-width:0.5;" x1="136.46" x2="316.9004" y1="286.23" y2="286.23" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.9014" x="141.46" y="303.2251">&#171;abstract&#187;</text><line style="stroke:#181818;stroke-width:0.5;" x1="136.46" x2="316.9004" y1="310.5269" y2="310.5269" /><ellipse cx="146.46" cy="324.1753" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.6182" x="155.46" y="327.522">read_value(): float</text><ellipse cx="146.46" cy="340.4722" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156.4404" x="155.46" y="343.8189">get_sensor_id(): string</text></g><g class="entity" data-entity="ActuatorInterface" data-source-line="20" data-uid="ent0004" id="entity_ActuatorInterface"><rect fill="#F1F1F1" height="113.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="212.2314" x="353.56" y="246.08" /><ellipse cx="394.4469" cy="262.08" fill="#C2C2C2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;" /><path d="M397.4156,267.7206 Q396.8375,268.0175 396.1969,268.1581 Q395.5562,268.3144 394.8531,268.3144 Q392.3531,268.3144 391.025,266.6738 Q389.7125,265.0175 389.7125,261.8925 Q389.7125,258.7675 391.025,257.1113 Q392.3531,255.455 394.8531,255.455 Q395.5562,255.455 396.1969,255.6112 Q396.8531,255.7675 397.4156,256.0644 L397.4156,258.7831 Q396.7906,258.205 396.1969,257.9394 Q395.6031,257.6581 394.9781,257.6581 Q393.6344,257.6581 392.9469,258.7363 Q392.2594,259.7988 392.2594,261.8925 Q392.2594,263.9863 392.9469,265.0644 Q393.6344,266.1269 394.9781,266.1269 Q395.6031,266.1269 396.1969,265.8613 Q396.7906,265.58 397.4156,265.0019 L397.4156,267.7206 Z " fill="#000000" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.7051" x="414.1995" y="266.9267">ActuatorInterface</text><line style="stroke:#181818;stroke-width:0.5;" x1="354.56" x2="564.7914" y1="278.08" y2="278.08" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.9014" x="359.56" y="295.0751">&#171;abstract&#187;</text><line style="stroke:#181818;stroke-width:0.5;" x1="354.56" x2="564.7914" y1="302.3769" y2="302.3769" /><ellipse cx="364.56" cy="316.0253" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186.2314" x="373.56" y="319.372">set_command(value): void</text><ellipse cx="364.56" cy="332.3222" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4219" x="373.56" y="335.6689">update(dt): void</text><ellipse cx="364.56" cy="348.6191" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.0615" x="373.56" y="351.9657">get_status(): dict</text></g><g class="entity" data-entity="TemperatureSensor" data-source-line="27" data-uid="ent0005" id="entity_TemperatureSensor"><rect fill="#F1F1F1" height="96.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.3574" x="7" y="39.6" /><ellipse cx="22" cy="55.6" fill="#C2C2C2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;" /><path d="M24.9688,61.2406 Q24.3906,61.5375 23.75,61.6781 Q23.1094,61.8344 22.4063,61.8344 Q19.9063,61.8344 18.5781,60.1937 Q17.2656,58.5375 17.2656,55.4125 Q17.2656,52.2875 18.5781,50.6312 Q19.9063,48.975 22.4063,48.975 Q23.1094,48.975 23.75,49.1312 Q24.4063,49.2875 24.9688,49.5844 L24.9688,52.3031 Q24.3438,51.725 23.75,51.4594 Q23.1563,51.1781 22.5313,51.1781 Q21.1875,51.1781 20.5,52.2562 Q19.8125,53.3187 19.8125,55.4125 Q19.8125,57.5062 20.5,58.5844 Q21.1875,59.6469 22.5313,59.6469 Q23.1563,59.6469 23.75,59.3812 Q24.3438,59.1 24.9688,58.5219 L24.9688,61.2406 Z " fill="#000000" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139.3574" x="36" y="60.4467">TemperatureSensor</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="177.3574" y1="71.6" y2="71.6" /><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="15" y="82.2484" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117.6191" x="27" y="88.5951">base_temp: float</text><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="15" y="98.5453" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.1455" x="27" y="104.892">noise_level: float</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="177.3574" y1="112.1937" y2="112.1937" /><ellipse cx="18" cy="125.8422" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.6182" x="27" y="129.1889">read_value(): float</text></g><g class="entity" data-entity="HeatingElement" data-source-line="33" data-uid="ent0006" id="entity_HeatingElement"><rect fill="#F1F1F1" height="129.4844" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="192.2637" x="713.55" y="23.3" /><ellipse cx="749.8995" cy="39.3" fill="#C2C2C2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;" /><path d="M752.8683,44.9406 Q752.2901,45.2375 751.6495,45.3781 Q751.0089,45.5344 750.3058,45.5344 Q747.8058,45.5344 746.4776,43.8937 Q745.1651,42.2375 745.1651,39.1125 Q745.1651,35.9875 746.4776,34.3312 Q747.8058,32.675 750.3058,32.675 Q751.0089,32.675 751.6495,32.8312 Q752.3058,32.9875 752.8683,33.2844 L752.8683,36.0031 Q752.2433,35.425 751.6495,35.1594 Q751.0558,34.8781 750.4308,34.8781 Q749.087,34.8781 748.3995,35.9562 Q747.712,37.0187 747.712,39.1125 Q747.712,41.2062 748.3995,42.2844 Q749.087,43.3469 750.4308,43.3469 Q751.0558,43.3469 751.6495,43.0812 Q752.2433,42.8 752.8683,42.2219 L752.8683,44.9406 Z " fill="#000000" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.8203" x="768.6438" y="44.1467">HeatingElement</text><line style="stroke:#181818;stroke-width:0.5;" x1="714.55" x2="904.8137" y1="55.3" y2="55.3" /><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="721.55" y="65.9484" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.1816" x="733.55" y="72.2951">power_level: float</text><rect fill="none" height="6" style="stroke:#595959;stroke-width:1;" width="6" x="721.55" y="82.2453" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.3926" x="733.55" y="88.592">max_power: float</text><line style="stroke:#181818;stroke-width:0.5;" x1="714.55" x2="904.8137" y1="95.8937" y2="95.8937" /><ellipse cx="724.55" cy="109.5422" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164.6572" x="733.55" y="112.8889">set_power(power): void</text><ellipse cx="724.55" cy="125.8391" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.4219" x="733.55" y="129.1857">update(dt): void</text><ellipse cx="724.55" cy="142.1359" fill="#A6A6A6" rx="3" ry="3" style="stroke:#545454;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166.2637" x="733.55" y="145.4826">get_heat_output(): float</text></g><g class="entity" data-entity="GMN11" data-source-line="46" data-uid="ent0012" id="entity_GMN11"><path d="M475.16,67.91 L475.16,84.04 L440.45,88.04 L475.16,92.04 L475.16,108.1756 A0,0 0 0 0 475.16,108.1756 L678.1981,108.1756 A0,0 0 0 0 678.1981,108.1756 L678.1981,77.91 L668.1981,67.91 L475.16,67.91 A0,0 0 0 0 475.16,67.91" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;" /><path d="M668.1981,67.91 L668.1981,77.91 L678.1981,77.91 L668.1981,67.91" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0381" x="481.16" y="84.9769">Coordinates all components</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3423" x="481.16" y="100.1097">and runs control loops</text></g><g class="link" data-entity-1="SystemSimulation" data-entity-2="SensorInterface" data-source-line="41" data-uid="lnk7" id="link_SystemSimulation_SensorInterface"><path codeLine="41" d="M288.87,169.43 C275.49,197.89 263.4125,223.56 251.7125,248.45" fill="none" id="SystemSimulation-to-SensorInterface" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="249.16,253.88,256.6087,247.4366,251.2871,249.355,249.3687,244.0334,249.16,253.88" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.8584" x="275.68" y="212.1469">manages</text></g><g class="link" data-entity-1="SystemSimulation" data-entity-2="ActuatorInterface" data-source-line="42" data-uid="lnk8" id="link_SystemSimulation_ActuatorInterface"><path codeLine="42" d="M376.96,169.43 C392.85,194.83 406.8667,217.2541 421.4567,240.5641" fill="none" id="SystemSimulation-to-ActuatorInterface" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="424.64,245.65,423.2556,235.8989,421.9872,241.4117,416.4744,240.1434,424.64,245.65" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.8584" x="406.68" y="212.1469">manages</text></g><g class="link" data-entity-1="TemperatureSensor" data-entity-2="SensorInterface" data-source-line="43" data-uid="lnk9" id="link_TemperatureSensor_SensorInterface"><path codeLine="43" d="M122.75,136.76 C144.74,171.66 164.8517,203.5726 186.8817,238.5226" fill="none" id="TemperatureSensor-to-SensorInterface" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /><polygon fill="none" points="196.48,253.75,191.9575,235.3232,181.8059,241.722,196.48,253.75" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="HeatingElement" data-entity-2="ActuatorInterface" data-source-line="44" data-uid="lnk10" id="link_HeatingElement_ActuatorInterface"><path codeLine="44" d="M720.01,153.24 C711.85,158.7 703.66,164.06 695.68,169.08 C653.62,195.57 621.7971,214.0986 580.4371,236.9386" fill="none" id="HeatingElement-to-ActuatorInterface" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /><polygon fill="none" points="564.68,245.64,583.3375,242.1909,577.5366,231.6862,564.68,245.64" style="stroke:#181818;stroke-width:1;" /></g></g></svg></p></div></div>
<p>Here&rsquo;s a practical example - a temperature control system:</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TemperatureControlSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_sensor</span> <span class="o">=</span> <span class="n">TemperatureSensor</span><span class="p">(</span><span class="s2">&quot;TEMP_01&quot;</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heating_element</span> <span class="o">=</span> <span class="n">HeatingElement</span><span class="p">(</span><span class="s2">&quot;HEAT_01&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">=</span> <span class="mf">25.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_log</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start_control_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the temperature control system&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">control_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_control_loop</span><span class="p">)</span>
        <span class="n">control_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">control_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temperature control system started&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop_control_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the temperature control system&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heating_element</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temperature control system stopped&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_target_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the desired temperature&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">=</span> <span class="n">target</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target temperature set to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">°C&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_control_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Main control loop - runs in separate thread&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_active</span><span class="p">:</span>
            <span class="c1"># Read current temperature</span>
            <span class="n">current_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_sensor</span><span class="o">.</span><span class="n">read_temperature</span><span class="p">()</span>

            <span class="c1"># Simple proportional control</span>
            <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">-</span> <span class="n">current_temp</span>

            <span class="c1"># Calculate heating power (0-100%)</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Need heating</span>
                <span class="n">power</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">error</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># 20% power per degree error</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Too hot or at target</span>
                <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Apply heating</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heating_element</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

            <span class="c1"># Log data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_log</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
                <span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="n">current_temp</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span><span class="p">,</span>
                <span class="s1">&#39;heating_power&#39;</span><span class="p">:</span> <span class="n">power</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span>
            <span class="p">})</span>

            <span class="c1"># Update heating element simulation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heating_element</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># 1 second update</span>

            <span class="c1"># Add heat to environment (affects sensor)</span>
            <span class="n">heat_added</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heating_element</span><span class="o">.</span><span class="n">get_heat_output</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_sensor</span><span class="o">.</span><span class="n">base_temp</span> <span class="o">+=</span> <span class="n">heat_added</span> <span class="o">*</span> <span class="mf">0.1</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temp: </span><span class="si">{</span><span class="n">current_temp</span><span class="si">}</span><span class="s2">°C, Target: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span><span class="si">}</span><span class="s2">°C, &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">+.1f</span><span class="si">}</span><span class="s2">°C, Power: </span><span class="si">{</span><span class="n">power</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Control loop period</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HeatingElement</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_id</span> <span class="o">=</span> <span class="n">element_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># 0-100%</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_heat_output</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># degrees per second at 100% power</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power_percent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set heating power as percentage (0-100)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">power_percent</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update heating element state&quot;&quot;&quot;</span>
        <span class="c1"># In real system, this might include heating lag, efficiency curves, etc.</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_heat_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate current heat output&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_heat_output</span>

<span class="c1"># Demonstration</span>
<span class="n">control_system</span> <span class="o">=</span> <span class="n">TemperatureControlSystem</span><span class="p">()</span>
<span class="n">control_system</span><span class="o">.</span><span class="n">start_control_loop</span><span class="p">()</span>

<span class="c1"># Let it run for a few control cycles</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Change target temperature</span>
<span class="n">control_system</span><span class="o">.</span><span class="n">set_target_temperature</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">control_system</span><span class="o">.</span><span class="n">stop_control_loop</span><span class="p">()</span>
</code></pre>
</div>
<h3 id="guided-example-robotic-arm-simulation">Guided example: robotic arm simulation<a class="headerlink" href="#guided-example-robotic-arm-simulation" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s build a comprehensive simulation of a simple 2-axis robotic arm. This example demonstrates how to combine multiple actuators with position feedback and coordinate system transformations.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RoboticArm</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Arm geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># mm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span> <span class="o">=</span> <span class="mi">80</span>   <span class="c1"># mm</span>

        <span class="c1"># Joint servos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint1</span> <span class="o">=</span> <span class="n">ServoMotor</span><span class="p">(</span><span class="s2">&quot;JOINT_1&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>  <span class="c1"># Base rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint2</span> <span class="o">=</span> <span class="n">ServoMotor</span><span class="p">(</span><span class="s2">&quot;JOINT_2&quot;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>  <span class="c1"># Elbow angle</span>

        <span class="c1"># End effector position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_y</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_position</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_to_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joint1_angle</span><span class="p">,</span> <span class="n">joint2_angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Command arm to move to specific joint angles&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving arm to angles: J1=</span><span class="si">{</span><span class="n">joint1_angle</span><span class="si">}</span><span class="s2">°, J2=</span><span class="si">{</span><span class="n">joint2_angle</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span><span class="n">joint1_angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span><span class="n">joint2_angle</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_to_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move end effector to target X,Y position using inverse kinematics&quot;&quot;&quot;</span>
        <span class="c1"># Calculate required joint angles</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inverse_kinematics</span><span class="p">(</span><span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">angles</span><span class="p">:</span>
            <span class="n">joint1_angle</span><span class="p">,</span> <span class="n">joint2_angle</span> <span class="o">=</span> <span class="n">angles</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving to position (</span><span class="si">{</span><span class="n">target_x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">target_y</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_to_angles</span><span class="p">(</span><span class="n">joint1_angle</span><span class="p">,</span> <span class="n">joint2_angle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Position (</span><span class="si">{</span><span class="n">target_x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">target_y</span><span class="si">}</span><span class="s2">) is unreachable&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update arm simulation&quot;&quot;&quot;</span>
        <span class="c1"># Update joint positions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Recalculate end effector position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_end_position</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_end_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate end effector position from joint angles (forward kinematics)&quot;&quot;&quot;</span>
        <span class="n">j1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>
        <span class="n">j2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>

        <span class="c1"># Position of elbow joint</span>
        <span class="n">elbow_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">j1_rad</span><span class="p">)</span>
        <span class="n">elbow_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">j1_rad</span><span class="p">)</span>

        <span class="c1"># Position of end effector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_x</span> <span class="o">=</span> <span class="n">elbow_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">j1_rad</span> <span class="o">+</span> <span class="n">j2_rad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_y</span> <span class="o">=</span> <span class="n">elbow_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">j1_rad</span> <span class="o">+</span> <span class="n">j2_rad</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_inverse_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate joint angles needed to reach target position&quot;&quot;&quot;</span>
        <span class="c1"># Distance from base to target</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">target_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Check if target is reachable</span>
        <span class="n">max_reach</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span>
        <span class="n">min_reach</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">distance</span> <span class="o">&gt;</span> <span class="n">max_reach</span> <span class="ow">or</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">min_reach</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Unreachable</span>

        <span class="c1"># Calculate joint angles using law of cosines</span>
        <span class="n">cos_j2</span> <span class="o">=</span> <span class="p">(</span><span class="n">distance</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span><span class="p">)</span>
        <span class="n">j2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">cos_j2</span><span class="p">)</span>

        <span class="c1"># Calculate j1 angle</span>
        <span class="n">angle_to_target</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">target_y</span><span class="p">,</span> <span class="n">target_x</span><span class="p">)</span>
        <span class="n">angle_correction</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">j2_rad</span><span class="p">),</span> 
                                     <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">j2_rad</span><span class="p">))</span>
        <span class="n">j1_rad</span> <span class="o">=</span> <span class="n">angle_to_target</span> <span class="o">-</span> <span class="n">angle_correction</span>

        <span class="c1"># Convert to degrees</span>
        <span class="n">j1_deg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">j1_rad</span><span class="p">)</span>
        <span class="n">j2_deg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">j2_rad</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">j1_deg</span><span class="p">,</span> <span class="n">j2_deg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current arm status&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;joint1_angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(),</span>
            <span class="s1">&#39;joint2_angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(),</span>
            <span class="s1">&#39;end_x&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;end_y&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;moving&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">is_moving</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">is_moving</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_arm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visualize current arm position&quot;&quot;&quot;</span>
        <span class="n">j1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>
        <span class="n">j2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>

        <span class="c1"># Calculate joint positions</span>
        <span class="n">base_x</span><span class="p">,</span> <span class="n">base_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">elbow_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">j1_rad</span><span class="p">)</span>
        <span class="n">elbow_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">j1_rad</span><span class="p">)</span>

        <span class="c1"># Plot arm segments</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">base_x</span><span class="p">,</span> <span class="n">elbow_x</span><span class="p">],</span> <span class="p">[</span><span class="n">base_y</span><span class="p">,</span> <span class="n">elbow_y</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Link 1&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">elbow_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_x</span><span class="p">],</span> <span class="p">[</span><span class="n">elbow_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_y</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Link 2&#39;</span><span class="p">)</span>

        <span class="c1"># Plot joints</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">base_x</span><span class="p">,</span> <span class="n">base_y</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Base&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elbow_x</span><span class="p">,</span> <span class="n">elbow_y</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Elbow&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;End Effector&#39;</span><span class="p">)</span>

        <span class="c1"># Plot workspace circle</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">link1_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">link2_length</span><span class="p">,</span> 
                           <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Robotic Arm Position</span><span class="se">\n</span><span class="s1">J1: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">joint1</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">°, J2: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">joint2</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">°&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X Position (mm)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y Position (mm)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Demonstration</span>
<span class="n">arm</span> <span class="o">=</span> <span class="n">RoboticArm</span><span class="p">()</span>

<span class="c1"># Test sequence: move to different positions</span>
<span class="n">test_positions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>   <span class="c1"># Reachable position</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># Reachable position</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>    <span class="c1"># Maximum reach</span>
    <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># Unreachable position</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span> <span class="ow">in</span> <span class="n">test_positions</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Moving to (</span><span class="si">{</span><span class="n">target_x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">target_y</span><span class="si">}</span><span class="s2">) ---&quot;</span><span class="p">)</span>
    <span class="n">arm</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">)</span>

    <span class="c1"># Simulate movement</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">arm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">arm</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;moving&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Movement complete. End effector at (</span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;end_x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;end_y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="c1"># Uncomment to show arm position plot</span>
    <span class="c1"># arm.plot_arm()</span>
</code></pre>
</div>
<h2 id="try-it">Try it<a class="headerlink" href="#try-it" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-multi-sensor-environment-simulation">Exercise 1: Multi-sensor environment simulation<a class="headerlink" href="#exercise-1-multi-sensor-environment-simulation" title="Permanent link">&para;</a></h3>
<p>Create a comprehensive environmental monitoring simulation that combines multiple sensor types with realistic behaviour patterns.</p>
<details class="question">
<summary>Task requirements</summary>
<p>Build a greenhouse environment simulator that includes:</p>
<ol>
<li>
<p>Temperature sensor with seasonal and daily temperature cycles</p>
</li>
<li>
<p>Humidity sensor that correlates with temperature changes</p>
</li>
<li>
<p>Light sensor that follows day/night cycles and weather patterns</p>
</li>
<li>
<p>Soil moisture sensors that decrease over time and increase with watering events</p>
</li>
<li>
<p>A weather system that affects all sensors (rain, clouds, sunny periods)</p>
</li>
</ol>
<details class="success">
<summary>Sample solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EnvironmentSimulator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>

        <span class="c1"># Environmental state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">=</span> <span class="s2">&quot;sunny&quot;</span>  <span class="c1"># sunny, cloudy, rainy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weather_change_timer</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Sensors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span> <span class="o">=</span> <span class="n">AdvancedTemperatureSensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span> <span class="o">=</span> <span class="n">HumiditySensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">light_sensor</span> <span class="o">=</span> <span class="n">LightSensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SoilMoistureSensor</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOIL_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">watering_system</span> <span class="o">=</span> <span class="n">WateringSystem</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt_minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Advance simulation by dt_minutes&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">+=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">dt_minutes</span><span class="p">)</span>

        <span class="c1"># Update weather system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_weather</span><span class="p">(</span><span class="n">dt_minutes</span><span class="p">)</span>

        <span class="c1"># Calculate environmental conditions</span>
        <span class="n">base_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_base_temperature</span><span class="p">()</span>
        <span class="n">light_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_light_level</span><span class="p">()</span>
        <span class="n">humidity_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_humidity</span><span class="p">(</span><span class="n">base_temp</span><span class="p">)</span>

        <span class="c1"># Update sensors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="o">.</span><span class="n">update_environment</span><span class="p">(</span><span class="n">base_temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span><span class="o">.</span><span class="n">update_environment</span><span class="p">(</span><span class="n">humidity_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">light_sensor</span><span class="o">.</span><span class="n">update_environment</span><span class="p">(</span><span class="n">light_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span><span class="p">)</span>

        <span class="c1"># Update soil moisture</span>
        <span class="k">for</span> <span class="n">soil_sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span><span class="p">:</span>
            <span class="c1"># Moisture decreases over time</span>
            <span class="n">soil_sensor</span><span class="o">.</span><span class="n">evaporate</span><span class="p">(</span><span class="n">dt_minutes</span><span class="p">)</span>

            <span class="c1"># Rain adds moisture</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;rainy&quot;</span><span class="p">:</span>
                <span class="n">soil_sensor</span><span class="o">.</span><span class="n">add_water</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_all_readings</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_weather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt_minutes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update weather state&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weather_change_timer</span> <span class="o">+=</span> <span class="n">dt_minutes</span>

        <span class="c1"># Weather changes every 30-120 minutes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_change_timer</span> <span class="o">&gt;</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">120</span><span class="p">):</span>
            <span class="n">weather_options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sunny&quot;</span><span class="p">,</span> <span class="s2">&quot;cloudy&quot;</span><span class="p">,</span> <span class="s2">&quot;rainy&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">weather_options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weather_change_timer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weather changed to: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_base_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate base temperature with daily and seasonal cycles&quot;&quot;&quot;</span>
        <span class="c1"># Time since start (in hours)</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span>

        <span class="c1"># Daily cycle (24 hour period)</span>
        <span class="n">daily_temp</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">elapsed</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Seasonal variation (approximate)</span>
        <span class="n">seasonal_temp</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">elapsed</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span><span class="p">))</span>

        <span class="n">base_temp</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">+</span> <span class="n">daily_temp</span> <span class="o">+</span> <span class="n">seasonal_temp</span>

        <span class="c1"># Weather modifications</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;cloudy&quot;</span><span class="p">:</span>
            <span class="n">base_temp</span> <span class="o">-=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;rainy&quot;</span><span class="p">:</span>
            <span class="n">base_temp</span> <span class="o">-=</span> <span class="mi">5</span>

        <span class="k">return</span> <span class="n">base_temp</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_light_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate light level based on time and weather&quot;&quot;&quot;</span>
        <span class="n">elapsed_hours</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span>
        <span class="n">hour_of_day</span> <span class="o">=</span> <span class="p">(</span><span class="n">elapsed_hours</span> <span class="o">%</span> <span class="mi">24</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">6</span> <span class="o">&lt;=</span> <span class="n">hour_of_day</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="p">:</span>  <span class="c1"># Daytime</span>
            <span class="c1"># Bell curve for daylight</span>
            <span class="n">daylight_factor</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">hour_of_day</span> <span class="o">-</span> <span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">base_light</span> <span class="o">=</span> <span class="mi">50000</span> <span class="o">*</span> <span class="n">daylight_factor</span>  <span class="c1"># Max 50,000 lux</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Nighttime</span>
            <span class="n">base_light</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Moonlight/artificial lighting</span>

        <span class="c1"># Weather effects</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;cloudy&quot;</span><span class="p">:</span>
            <span class="n">base_light</span> <span class="o">*=</span> <span class="mf">0.3</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;rainy&quot;</span><span class="p">:</span>
            <span class="n">base_light</span> <span class="o">*=</span> <span class="mf">0.1</span>

        <span class="k">return</span> <span class="n">base_light</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_humidity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate humidity based on temperature and weather&quot;&quot;&quot;</span>
        <span class="c1"># Higher temperatures generally mean lower relative humidity</span>
        <span class="n">base_humidity</span> <span class="o">=</span> <span class="mi">80</span> <span class="o">-</span> <span class="p">(</span><span class="n">temperature</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="c1"># Weather effects</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;rainy&quot;</span><span class="p">:</span>
            <span class="n">base_humidity</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span> <span class="n">base_humidity</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span> <span class="o">==</span> <span class="s2">&quot;sunny&quot;</span><span class="p">:</span>
            <span class="n">base_humidity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">base_humidity</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">base_humidity</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">water_plants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trigger watering system&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">zone</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Water all zones</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">soil_sensor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span><span class="p">):</span>
                <span class="n">water_amount</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
                <span class="n">soil_sensor</span><span class="o">.</span><span class="n">add_water</span><span class="p">(</span><span class="n">water_amount</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Watered zone </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: +</span><span class="si">{</span><span class="n">water_amount</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% moisture&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Water specific zone</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">zone</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span><span class="p">):</span>
                <span class="n">water_amount</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span><span class="p">[</span><span class="n">zone</span><span class="p">]</span><span class="o">.</span><span class="n">add_water</span><span class="p">(</span><span class="n">water_amount</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Watered zone </span><span class="si">{</span><span class="n">zone</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: +</span><span class="si">{</span><span class="n">water_amount</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% moisture&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_all_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get readings from all sensors&quot;&quot;&quot;</span>
        <span class="n">readings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">,</span>
            <span class="s1">&#39;weather&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">weather_state</span><span class="p">,</span>
            <span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="o">.</span><span class="n">read_temperature</span><span class="p">(),</span>
            <span class="s1">&#39;humidity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span><span class="o">.</span><span class="n">read_humidity</span><span class="p">(),</span>
            <span class="s1">&#39;light&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">light_sensor</span><span class="o">.</span><span class="n">read_light</span><span class="p">(),</span>
            <span class="s1">&#39;soil_moisture&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sensor</span><span class="o">.</span><span class="n">read_moisture</span><span class="p">()</span> <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">soil_sensors</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">readings</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AdvancedTemperatureSensor</span><span class="p">(</span><span class="n">TemperatureSensor</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_temp</span><span class="p">,</span> <span class="n">weather</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_temp</span> <span class="o">=</span> <span class="n">base_temp</span>

        <span class="c1"># Weather affects sensor readings</span>
        <span class="k">if</span> <span class="n">weather</span> <span class="o">==</span> <span class="s2">&quot;rainy&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># More noise in wet conditions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HumiditySensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_humidity</span> <span class="o">=</span> <span class="mf">60.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="mf">2.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_humidity</span><span class="p">,</span> <span class="n">weather</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_humidity</span> <span class="o">=</span> <span class="n">base_humidity</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_humidity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">)</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_humidity</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">reading</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LightSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_light</span> <span class="o">=</span> <span class="mf">1000.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="mf">50.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_light</span><span class="p">,</span> <span class="n">weather</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_light</span> <span class="o">=</span> <span class="n">base_light</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_light</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">)</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_light</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">reading</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SoilMoistureSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_id</span> <span class="o">=</span> <span class="n">sensor_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">=</span> <span class="mf">50.0</span>  <span class="c1"># Start at 50%</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaporation_rate</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># % per minute</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaporate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt_minutes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Moisture decreases over time&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaporation_rate</span> <span class="o">*</span> <span class="n">dt_minutes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_water</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add water to soil&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">+=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_moisture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">moisture_level</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">reading</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">WateringSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_watering</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_water</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil_readings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if watering is needed&quot;&quot;&quot;</span>
        <span class="n">avg_moisture</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">soil_readings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">soil_readings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">avg_moisture</span> <span class="o">&lt;</span> <span class="mi">30</span>  <span class="c1"># Water if average below 30%</span>

<span class="c1"># Run simulation</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">EnvironmentSimulator</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting greenhouse environment simulation...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>  <span class="c1"># Run for 48 hours</span>
    <span class="n">readings</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">step_simulation</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># 1 hour steps</span>

    <span class="c1"># Check if watering is needed</span>
    <span class="n">watering_system</span> <span class="o">=</span> <span class="n">WateringSystem</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">watering_system</span><span class="o">.</span><span class="n">should_water</span><span class="p">(</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;soil_moisture&#39;</span><span class="p">]):</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">water_plants</span><span class="p">()</span>

    <span class="c1"># Print hourly summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hour </span><span class="si">{</span><span class="n">hour</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;weather&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">6</span><span class="si">}</span><span class="s2"> | &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;Temp: </span><span class="si">{</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">5.1f</span><span class="si">}</span><span class="s2">°C | &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;Humidity: </span><span class="si">{</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;humidity&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">5.1f</span><span class="si">}</span><span class="s2">% | &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;Light: </span><span class="si">{</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;light&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">8.0f</span><span class="si">}</span><span class="s2"> lux | &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;Soil: </span><span class="si">{</span><span class="n">readings</span><span class="p">[</span><span class="s1">&#39;soil_moisture&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">5.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># Brief pause for readability</span>
</code></pre>
</div>
</details>
</details>
<h3 id="exercise-2-actuator-coordination-simulation">Exercise 2: Actuator coordination simulation<a class="headerlink" href="#exercise-2-actuator-coordination-simulation" title="Permanent link">&para;</a></h3>
<p>Build a simulation of a pick-and-place robot that coordinates multiple actuators to perform complex tasks.</p>
<details class="question">
<summary>Task requirements</summary>
<p>Create a pick-and-place robot simulation with:</p>
<ol>
<li>
<p>A 2-axis robotic arm (base rotation and reach extension)</p>
</li>
<li>
<p>A gripper actuator (open/close with pressure feedback)</p>
</li>
<li>
<p>A conveyor belt actuator (variable speed control)</p>
</li>
<li>
<p>Coordinate system transforms between robot base and conveyor</p>
</li>
<li>
<p>A complete pick-and-place sequence with error checking</p>
</li>
</ol>
<details class="success">
<summary>Sample solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PickAndPlaceRobot</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Robot components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_servo</span> <span class="o">=</span> <span class="n">ServoMotor</span><span class="p">(</span><span class="s2">&quot;BASE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>      <span class="c1"># 0-360° rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span> <span class="o">=</span> <span class="n">LinearActuator</span><span class="p">(</span><span class="s2">&quot;REACH&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>  <span class="c1"># 100-300mm reach</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span> <span class="o">=</span> <span class="n">GripperActuator</span><span class="p">(</span><span class="s2">&quot;GRIPPER&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span> <span class="o">=</span> <span class="n">ConveyorBelt</span><span class="p">(</span><span class="s2">&quot;CONVEYOR&quot;</span><span class="p">)</span>

        <span class="c1"># Robot geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># mm above conveyor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper_offset</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># mm from reach actuator center</span>

        <span class="c1"># Current robot state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">holding_object</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Task sequence state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_step</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_to_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move robot end effector to target position&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span>  <span class="c1"># Default height</span>

        <span class="c1"># Convert Cartesian to polar coordinates</span>
        <span class="n">distance_2d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

        <span class="c1"># Check if position is reachable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_reachable</span><span class="p">(</span><span class="n">distance_2d</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Position (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">) is not reachable&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Calculate required actuator positions</span>
        <span class="n">required_reach</span> <span class="o">=</span> <span class="n">distance_2d</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper_offset</span>
        <span class="n">required_angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">%</span> <span class="mi">360</span>

        <span class="c1"># Command actuators</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving to position (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_servo</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span><span class="n">required_angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">required_reach</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_reachable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance_2d</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if position is within robot workspace&quot;&quot;&quot;</span>
        <span class="n">min_reach</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">min_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper_offset</span>
        <span class="n">max_reach</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">max_position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper_offset</span>

        <span class="k">if</span> <span class="n">distance_2d</span> <span class="o">&lt;</span> <span class="n">min_reach</span> <span class="ow">or</span> <span class="n">distance_2d</span> <span class="o">&gt;</span> <span class="n">max_reach</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># Height limits</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pick_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute pick sequence at specified location&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting pick sequence at (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># Step 1: Move above target</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">50</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="c1"># Step 2: Open gripper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">open_gripper</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Step 3: Lower to pick height</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>  <span class="c1"># 10mm above conveyor</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="c1"># Step 4: Close gripper</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">close_gripper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holding_object</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object picked successfully&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to pick object&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Step 5: Lift object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">place_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute place sequence at specified location&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">holding_object</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No object to place&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting place sequence at (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># Step 1: Move above target</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">50</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="c1"># Step 2: Lower to place height</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>  <span class="c1"># 20mm above conveyor</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="c1"># Step 3: Open gripper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">open_gripper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">holding_object</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object placed successfully&quot;</span><span class="p">)</span>

        <span class="c1"># Step 4: Retract</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all actuators to reach target positions&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_servo</span><span class="o">.</span><span class="n">is_moving</span><span class="p">()</span> <span class="ow">or</span> 
               <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">is_moving</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_robot</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_robot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update all robot actuators&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_servo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Update current position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_current_position</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate current end effector position&quot;&quot;&quot;</span>
        <span class="n">angle_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_servo</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>
        <span class="n">total_reach</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reach_actuator</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper_offset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_x</span> <span class="o">=</span> <span class="n">total_reach</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle_rad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_y</span> <span class="o">=</span> <span class="n">total_reach</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_rad</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_pick_and_place_cycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pick_locations</span><span class="p">,</span> <span class="n">place_locations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run complete pick and place cycle&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting pick and place cycle&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pick_pos</span><span class="p">,</span> <span class="n">place_pos</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pick_locations</span><span class="p">,</span> <span class="n">place_locations</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Cycle </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>

            <span class="c1"># Move conveyor to position object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">run_forward</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># Run for 2 seconds</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

            <span class="c1"># Pick object</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick_object</span><span class="p">(</span><span class="n">pick_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pick_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="c1"># Place object</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">place_object</span><span class="p">(</span><span class="n">place_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">place_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Return to home position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_to_position</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_height</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_movement</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pick and place cycle complete&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LinearActuator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actuator_id</span><span class="p">,</span> <span class="n">initial_position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_id</span> <span class="o">=</span> <span class="n">actuator_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">=</span> <span class="n">initial_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="n">initial_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_position</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># mm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_position</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># mm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># mm/s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Command actuator to move to target position&quot;&quot;&quot;</span>
        <span class="n">target_position</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_position</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_position</span><span class="p">,</span> <span class="n">target_position</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">target_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># 1mm tolerance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="n">target_position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear actuator </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator_id</span><span class="si">}</span><span class="s2">: Moving to </span><span class="si">{</span><span class="n">target_position</span><span class="si">}</span><span class="s2">mm&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update actuator position&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">distance_to_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span>
        <span class="n">max_movement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">distance_to_target</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_movement</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear actuator </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator_id</span><span class="si">}</span><span class="s2">: Reached target </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_position</span><span class="si">}</span><span class="s2">mm&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">distance_to_target</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">+=</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">max_movement</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_position</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_moving</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GripperActuator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gripper_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper_id</span> <span class="o">=</span> <span class="n">gripper_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_open</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grip_pressure</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0-100%</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_object</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">open_gripper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open gripper&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_open</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grip_pressure</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_object</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gripper </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper_id</span><span class="si">}</span><span class="s2">: Opening&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close_gripper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close gripper and attempt to grip object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_open</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Simulate object detection</span>
        <span class="n">object_present</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.1</span>  <span class="c1"># 90% success rate</span>

        <span class="k">if</span> <span class="n">object_present</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grip_pressure</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_object</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gripper </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper_id</span><span class="si">}</span><span class="s2">: Closed, gripping object (pressure: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grip_pressure</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grip_pressure</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Full pressure, no object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_object</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gripper </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper_id</span><span class="si">}</span><span class="s2">: Closed, no object detected&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update gripper state&quot;&quot;&quot;</span>
        <span class="k">pass</span>  <span class="c1"># Gripper is instantaneous in this simulation</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConveyorBelt</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">belt_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt_id</span> <span class="o">=</span> <span class="n">belt_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># mm/s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 1 = forward, -1 = reverse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># mm/s</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start conveyor moving forward&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">speed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># 50% speed default</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conveyor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">belt_id</span><span class="si">}</span><span class="s2">: Running forward at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="si">}</span><span class="s2">mm/s&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start conveyor moving reverse&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">speed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">*</span> <span class="mf">0.5</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conveyor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">belt_id</span><span class="si">}</span><span class="s2">: Running reverse at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="si">}</span><span class="s2">mm/s&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop conveyor&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conveyor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">belt_id</span><span class="si">}</span><span class="s2">: Stopped&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update conveyor state&quot;&quot;&quot;</span>
        <span class="k">pass</span>  <span class="c1"># Position tracking would go here</span>

<span class="c1"># Demonstration</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">PickAndPlaceRobot</span><span class="p">()</span>

<span class="c1"># Define pick and place locations</span>
<span class="n">pick_positions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">120</span><span class="p">)]</span>
<span class="n">place_positions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">)]</span>

<span class="c1"># Run demonstration</span>
<span class="n">robot</span><span class="o">.</span><span class="n">run_pick_and_place_cycle</span><span class="p">(</span><span class="n">pick_positions</span><span class="p">,</span> <span class="n">place_positions</span><span class="p">)</span>
</code></pre>
</div>
</details>
</details>
<h3 id="exercise-3-real-time-control-simulation-with-visualization">Exercise 3: Real-time control simulation with visualization<a class="headerlink" href="#exercise-3-real-time-control-simulation-with-visualization" title="Permanent link">&para;</a></h3>
<p>Create a dynamic simulation that shows real-time sensor feedback and actuator response with simple graphical visualization.</p>
<details class="question">
<summary>Task requirements</summary>
<p>Build a real-time pendulum balance control system with:</p>
<ol>
<li>
<p>A pendulum with physics simulation (gravity, momentum, friction)</p>
</li>
<li>
<p>An angle sensor that measures pendulum position</p>
</li>
<li>
<p>A servo motor that applies corrective torque</p>
</li>
<li>
<p>A PID controller to maintain balance</p>
</li>
<li>
<p>Real-time plotting of angle, control signal, and system performance</p>
</li>
</ol>
<details class="success">
<summary>Sample solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PendulumSimulation</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Physical parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">1.0</span>        <span class="c1"># Pendulum length (m)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># Pendulum mass (kg)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span> <span class="o">=</span> <span class="mf">9.81</span>      <span class="c1"># Gravity (m/s²)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">friction</span> <span class="o">=</span> <span class="mf">0.05</span>     <span class="c1"># Damping coefficient</span>

        <span class="c1"># State variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># Initial angle (rad)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocity</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># Initial angular velocity (rad/s)</span>

        <span class="c1"># Control system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_sensor</span> <span class="o">=</span> <span class="n">AngleSensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_motor</span> <span class="o">=</span> <span class="n">ControlMotor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_controller</span> <span class="o">=</span> <span class="n">PIDController</span><span class="p">(</span><span class="n">kp</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ki</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kd</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="c1"># Data logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_data</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_data</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_data</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Simulation control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step_physics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update pendulum physics&quot;&quot;&quot;</span>
        <span class="c1"># Calculate torque from gravity</span>
        <span class="n">gravity_torque</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>

        <span class="c1"># Calculate control torque from motor</span>
        <span class="n">control_torque</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_motor</span><span class="o">.</span><span class="n">get_current_torque</span><span class="p">()</span>

        <span class="c1"># Calculate friction torque</span>
        <span class="n">friction_torque</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">friction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocity</span>

        <span class="c1"># Total torque</span>
        <span class="n">total_torque</span> <span class="o">=</span> <span class="n">gravity_torque</span> <span class="o">+</span> <span class="n">control_torque</span> <span class="o">+</span> <span class="n">friction_torque</span>

        <span class="c1"># Calculate angular acceleration (τ = I * α, where I = m * L²)</span>
        <span class="n">moment_of_inertia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">angular_acceleration</span> <span class="o">=</span> <span class="n">total_torque</span> <span class="o">/</span> <span class="n">moment_of_inertia</span>

        <span class="c1"># Update velocity and position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocity</span> <span class="o">+=</span> <span class="n">angular_acceleration</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocity</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="c1"># Keep angle in reasonable range for visualization</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">&gt;</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update control system&quot;&quot;&quot;</span>
        <span class="c1"># Read sensor</span>
        <span class="n">measured_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_sensor</span><span class="o">.</span><span class="n">read_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>

        <span class="c1"># Calculate control signal</span>
        <span class="n">target_angle</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Try to balance at vertical</span>
        <span class="n">control_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_controller</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">target_angle</span><span class="p">,</span> <span class="n">measured_angle</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Apply control to motor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_motor</span><span class="o">.</span><span class="n">set_torque</span><span class="p">(</span><span class="n">control_signal</span><span class="p">)</span>

        <span class="c1"># Log data</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">measured_angle</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">control_signal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">target_angle</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run simulation for specified duration&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 10ms time steps</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="c1"># Update physics</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step_physics</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

            <span class="c1"># Update control system</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step_control</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

            <span class="c1"># Real-time delay</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start_simulation_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start simulation in background thread&quot;&quot;&quot;</span>
        <span class="n">sim_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">)</span>
        <span class="n">sim_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sim_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sim_thread</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop simulation&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_current_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current pendulum state for visualization&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span>
            <span class="s1">&#39;angular_velocity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocity</span><span class="p">,</span>
            <span class="s1">&#39;control_torque&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_motor</span><span class="o">.</span><span class="n">get_current_torque</span><span class="p">(),</span>
            <span class="s1">&#39;pid_output&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_controller</span><span class="o">.</span><span class="n">last_output</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid_controller</span><span class="p">,</span> <span class="s1">&#39;last_output&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AngleSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># ±0.5° noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>   <span class="c1"># 0.1° resolution</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">true_angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read angle with realistic sensor characteristics&quot;&quot;&quot;</span>
        <span class="c1"># Add noise</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_level</span><span class="p">)</span>

        <span class="c1"># Apply resolution limit</span>
        <span class="n">measured</span> <span class="o">=</span> <span class="n">true_angle</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="n">quantized</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">measured</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span>

        <span class="k">return</span> <span class="n">quantized</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ControlMotor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_torque</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># Maximum torque (N⋅m)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_torque</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># 50ms response time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_torque</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_torque</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_torque</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set target torque (with limits)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_torque</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">max_torque</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_torque</span><span class="p">,</span> <span class="n">target_torque</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update motor response (first-order lag)&quot;&quot;&quot;</span>
        <span class="n">torque_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_torque</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_torque</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_torque</span> <span class="o">+=</span> <span class="n">torque_error</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_time</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_current_torque</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current motor torque&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_torque</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PIDController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">ki</span><span class="p">,</span> <span class="n">kd</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kp</span> <span class="o">=</span> <span class="n">kp</span>  <span class="c1"># Proportional gain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ki</span> <span class="o">=</span> <span class="n">ki</span>  <span class="c1"># Integral gain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="n">kd</span>  <span class="c1"># Derivative gain</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">integral</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_error</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_output</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setpoint</span><span class="p">,</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate PID control output&quot;&quot;&quot;</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">setpoint</span> <span class="o">-</span> <span class="n">measurement</span>

        <span class="c1"># Proportional term</span>
        <span class="n">proportional</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kp</span> <span class="o">*</span> <span class="n">error</span>

        <span class="c1"># Integral term</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integral</span> <span class="o">+=</span> <span class="n">error</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">integral_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ki</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span>

        <span class="c1"># Derivative term</span>
        <span class="n">derivative</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_error</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span> <span class="k">if</span> <span class="n">dt</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">derivative_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kd</span> <span class="o">*</span> <span class="n">derivative</span>

        <span class="c1"># Calculate output</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">proportional</span> <span class="o">+</span> <span class="n">integral_term</span> <span class="o">+</span> <span class="n">derivative_term</span>

        <span class="c1"># Update for next iteration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_error</span> <span class="o">=</span> <span class="n">error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_output</span> <span class="o">=</span> <span class="n">output</span>

        <span class="k">return</span> <span class="n">output</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PendulumVisualizer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulation</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span> <span class="o">=</span> <span class="n">simulation</span>

        <span class="c1"># Create figure with subplots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="c1"># Pendulum animation subplot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pendulum Position&#39;</span><span class="p">)</span>

        <span class="c1"># Initialize pendulum graphics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_line</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_bob</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pivot_point</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Data plotting subplot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Control System Response&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle (°) / Control Signal&#39;</span><span class="p">)</span>

        <span class="c1"># Initialize data plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_line</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Angle&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_line</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Control Signal&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_line</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Animation update function&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_bob</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_line</span>

        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">get_current_state</span><span class="p">()</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">]</span>

        <span class="c1"># Update pendulum visualization</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_bob</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">])</span>

        <span class="c1"># Update data plots</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">angle_data</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">control_data</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">target_data</span><span class="p">))</span>

            <span class="c1"># Update x-axis limits to follow data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">time_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pendulum_bob</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_line</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start real-time animation&quot;&quot;&quot;</span>
        <span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">animate</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ani</span>

<span class="c1"># Run the simulation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting pendulum balance control simulation...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The system will try to balance the pendulum at vertical position.&quot;</span><span class="p">)</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">PendulumSimulation</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">PendulumVisualizer</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

<span class="c1"># Start simulation in background</span>
<span class="n">sim_thread</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">start_simulation_thread</span><span class="p">()</span>

<span class="c1"># Start visualization (this blocks until window is closed)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ani</span> <span class="o">=</span> <span class="n">visualizer</span><span class="o">.</span><span class="n">start_animation</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation stopped by user&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">stop_simulation</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation complete!&quot;</span><span class="p">)</span>
</code></pre>
</div>
<p>Note: This example requires matplotlib for visualization. For the basic curriculum, you could create a simpler text-based version that prints periodic status updates instead of live plotting.</p>
</details>
</details>
<h2 id="recap">Recap<a class="headerlink" href="#recap" title="Permanent link">&para;</a></h2>
<p>Simulation and prototyping form the backbone of safe, efficient mechatronic system development. In this section, you learned how to:</p>
<ul>
<li>
<p><strong>Model sensor behaviour</strong> with realistic noise, drift, and response characteristics</p>
</li>
<li>
<p><strong>Simulate actuator dynamics</strong> including speed limits, position tracking, and movement coordination</p>
</li>
<li>
<p><strong>Build integrated systems</strong> that combine multiple sensors and actuators with feedback loops</p>
</li>
<li>
<p><strong>Create test harnesses</strong> for validating control algorithms before hardware deployment</p>
</li>
<li>
<p><strong>Implement physics simulations</strong> for dynamic systems like pendulums and robotic arms</p>
</li>
</ul>
<p>Key principles for mechatronic simulation:</p>
<ol>
<li>
<p><strong>Start simple, add complexity gradually</strong> - begin with basic sensor/actuator models, then add realistic behaviour</p>
</li>
<li>
<p><strong>Include realistic constraints</strong> - speed limits, noise, delays, and range restrictions make simulations valuable</p>
</li>
<li>
<p><strong>Test edge cases</strong> - simulation lets you safely explore failure modes and extreme conditions</p>
</li>
<li>
<p><strong>Validate against known results</strong> - verify your simulation matches expected behaviour for simple cases</p>
</li>
<li>
<p><strong>Design for testability</strong> - structure your code so individual components can be tested in isolation</p>
</li>
</ol>
<p>The examples demonstrated progression from simple sensor simulation to complex multi-actuator coordination. The exercises explored environmental systems, robotic coordination, and real-time control - all essential patterns for mechatronic engineering.</p>
<p>Simulation skills transfer directly to hardware programming, where the same abstraction patterns and control logic apply. Next, you&rsquo;ll learn about implementing closed-loop control systems, where simulation becomes crucial for tuning control parameters safely.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 15, 2025 07:03:58 UTC">October 15, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 – <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/ide-utils.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>